/* Copyright (c) 2008-2014, Hisilicon Tech. Co., Ltd. All rights reserved.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License version 2 and
* only version 2 as published by the Free Software Foundation.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the
* GNU General Public License for more details.
*
*/

#include "hisi_fb.h"
#if LINUX_VERSION_CODE >= KERNEL_VERSION(4,1,0)
#include <linux/hisi/hisi_adc.h>
#else
#include <linux/huawei/hisi_adc.h>
#endif
#include <huawei_platform/touthscreen/huawei_touchscreen.h>
#include <huawei_platform/log/log_jank.h>
#include <linux/hisi/hw_cmdline_parse.h>
#include <linux/i2c.h>
#include <linux/clk.h>
#include <linux/sysfs.h>
#include <linux/device.h>

#define DTS_COMP_TIANMA_R63319_8P4 "hisilicon,mipi_tianma_R63319_8p4"

static struct hisi_fb_panel_data g_panel_data;
static int g_debug_enable = 0;

struct i2c_client *g_sony_client = NULL;
#define BTV_DEV_NAME "lp8556,btv_i2c_adapter"
#define LP8556_STATUS_REG 0x02
#define LP8556_STATUS_VALUE 0x30

struct btv_register_data {
	u8 reg;
	u8 value;
};
static u8	lp8556_reg_value = 0;
static u8	lp8556_reg_addr = 0;
static int	g_support_mode = 0;

enum {
	CABC_OFF = 0,
	CABC_UI_MODE = 1,
	CABC_STILL_MODE = 2,
	CABC_MOVING_MODE = 3,
};
static int g_cabc_mode = CABC_UI_MODE;


enum {
    COLOR_EN_SRGB = 0,  /*when close color_enhance, need open gmp*/
    COLOR_EN_DEFAULT = 1, /*when open color_enhance, need close gmp*/
    COLOR_EN_CLOSED = 2,  /*when close all, close gmp*/
};
static int g_color_enhancement_mode = COLOR_EN_DEFAULT;

/*******************************************************************************
** Power ON Sequence(sleep mode to Normal mode)
*/
	//L_R
	static char reg_36[] = {
		0x36,
		0x00,
	};

	//24BIT
	static char reg_3A[] = {
		0x3A,
		0x70,
	};

	//Manufacturer Command Access Protect
	static char reg_B0[] = {
		0xB0,
		0x04,
	};

	static char reg_51[] = {
		0x51,
		0xFE,
	};

	static char reg_53[] = {
		0x53,
		0x24,
	};

	static char reg_55[] = {
		0x55,
		0x00,
	};

	static char reg_35[] = {
		0x35,
		0x00,
	};


	//GEN  interface setting
	static char reg_B3[] = {
		0xB3,
		0x14,0x00,0x00,0x00,0x00,0x00,
	};

	//gen interfase id setting
	static char reg_B4[] = {
		0xB4,
		0x0C,
	};

	static char reg_B4new[] = {
		0xB4,
		0x0C,0x00,
	};

	//G dsi control
	static char reg_B6[] = {
		0xB6,
		0x3A,0xD3,
	};

	//G tpc sync control
	static char reg_C3[] = {
		0xC3,
		0x00,0x00,0x00,
	};

	//G SOUT Slew rate adjustment
	static char reg_C0[] = {
		0xC0,
		0x00,0x00,0x00,0x00,0x00,0x00,
	};

	//G DISPLAY SETTING 1
	static char reg_C1[] = {
		0xC1,
		0xC8,0x60,0x00,0xA0,0xB1,0x07,0xCB,0x40,0xE6,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x31,0x48,0x10,0xF8,0x58,0x03,0x00,0x00,0x00,0x00,0x00,0x62,0x01,0x02,0x02,0x00,0x01,0x11,
	};

	//G DISPLAY SETTING 2
	static char reg_C2[] = {
		0xC2,
		0x31,0xF0,0x0A,0x00,0x08,0x08,0x00,0x00,
	};

	static char reg_C2new[] = {
		0xC2,
		0x31,0xF0,0x0A,0x00,0x1F,0x0E,0x00,0x00,
	};

	//G  SOURCE TIMMING SETTING
	static char reg_C4[] = {
		0xC4,
		0x70,0x00,0x00,0x00,0x00,0x22,0x20,0x00,0x22,0x44,0x24,0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x22,0x20,0x00,0x22,0x44,0x24,0x01,0x03,
	};

	//G ltps timing setting
	static char reg_C6[] = {
		0xC6,
		0x7B,0x01,0x09,0x0A,0x4F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x14,0x1D,0x06,
		0x7B,0x01,0x09,0x0A,0x4F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x14,0x1D,0x06,
	};

	static char reg_C6new[] = {
		0xC6,
		0x5B,0x01,0x14,0x0A,0x4C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x1F,0x06,
		0x5B,0x01,0x14,0x0A,0x4C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x1F,0x06,
	};

	//gen  GAMMA SETTING
	static char reg_C7[] = {
		0xC7,
		0X00,0X12,0X1A,0X24,0X32,0X41,0X4A,0X59,0X3D,0X45,0X51,0X5F,0X68,0X70,0X77,
		0X00,0X12,0X1A,0X24,0X32,0X41,0X4A,0X59,0X3D,0X45,0X51,0X5F,0X68,0X70,0X77,
	};

	//G panel ipin control
	static char reg_CB[] = {
		0xCB,
		0xFE,0x07,0xE0,0x7F,0x80,0x00,0x00,0x01,0xC0,0x00,
	};

	//G panel interface control
	static char reg_CC[] = {
		0xCC,
		0x0E,
	};

	//G SEQUENER TIMING control
	static char reg_D9[] = {
		0xD9,
		0x00,0x00,0x00,
	};

	//G POWER SETTING(CHARGE PUMP SETTING)
	static char reg_D0[] = {
		0xD0,
		0x11,0x81,0xBB,0x14,0x0F,0x4C,0x19,0x19,0x0C,0x00
	};

	//G POWER SETTING FOR INTERNAL POWER
	static char reg_D2[] = {
		0xD2,
		0x00,
	};

	//G POWER SETTING FOR INTERNAL POWER
	static char reg_D3[] = {
		0xD3,
		0x1B,0x33,0xBB,0xBB,0xB3,0x33,0x33,0x33,0x00,0x01,0x00,0xA0,0xD8,0xA0,0x0D,0x4C,0x4C,0x33,0x3B,0x37,0x70,0x07,0x3D,0xBF,0x33
	};

	//G POWER SETTING FOR INTERNAL POWER
	static char reg_D3_off[] = {
		0xD3,
		0x13,0x33,0xBB,0xB3,0xB3,0x33,0x33,0x33,0x00,0x01,0x00,0xA0,0xD8,0xA0,0x0D,0x74,0x74,0x33,0x3B,0x37,0x72,0x07,0x3D,0xBF,0x33
	};

	//G VCOM SETTING
	static char reg_D5[] = {
		0xD5,
		0x06,0x00,0x00,0x01,0x13,0x01,0x13,
	};

	//NVM load OFF after exit_sleep_mode
	static char reg_D6[] = {
		0xD6,
		0x01,
	};


	static char display_on[] = {
		0x29,
	};

	static char exit_sleep[] = {
		0x11,
	};

static	char bist_test_mode[] = {
		0xDE,
		0x01,0x30,0xF9,0x10,
};

static struct dsi_cmd_desc bist_test_mode_cmds[] = {
	{DTYPE_DCS_LWRITE, 0, 10, WAIT_TYPE_US,
		sizeof(bist_test_mode), bist_test_mode},
};

static char cabc_off[] = {
	0x55,
	0x00,
};

static char cabc_set_mode_UI[] = {
	0x55,
	0x01,
};

static char cabc_set_mode_STILL[] = {
	0x55,
	0x02,
};

static char cabc_set_mode_MOVING[] = {
	0x55,
	0x03,
};

static char cabc_set_min_value[] = {
	0x5E,
	0x30,
};

static char cabc_set_UI_para[] = {
	0xB8,
	0x07,
	0x85,
	0x1E,
	0x0,
	0x1E,
	0x32,
};

static char cabc_set_still_para[] = {
	0xB9,
	0x07,
	0x82,
	0x3C,
	0x30,
	0x3C,
	0x87,
};

static char cabc_set_Moving_para[] = {
	0xBA,
	0x07,
	0x85,
	0x28,
	0x00,
	0x30,
	0x80,
};

static struct dsi_cmd_desc tm_cabc_off_cmds[] = {
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_off), cabc_off},
};

static struct dsi_cmd_desc tm_cabc_ui_on_cmds[] = {
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_mode_UI), cabc_set_mode_UI},
};

static struct dsi_cmd_desc tm_cabc_still_on_cmds[] = {
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_mode_STILL), cabc_set_mode_STILL},
};

static struct dsi_cmd_desc tm_cabc_moving_on_cmds[] = {
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_mode_MOVING), cabc_set_mode_MOVING},
};

static struct dsi_cmd_desc tm_cabc_mode_paras[] = {
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_UI_para), cabc_set_UI_para},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_still_para), cabc_set_still_para},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_Moving_para), cabc_set_Moving_para},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US,
		sizeof(cabc_set_min_value), cabc_set_min_value},
};

/*******************************************************************************
** Power OFF Sequence(Normal to power off)
*/
static char display_off[] = {
	0x28,
};

static char enter_sleep[] = {
	0x10,
};

static struct dsi_cmd_desc lcd_init_display_on_cmds_otp[] = {
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_36), reg_36},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_3A), reg_3A},
	{DTYPE_GEN_WRITE2, 0, 10, WAIT_TYPE_US, sizeof(reg_B0), reg_B0},
	{DTYPE_GEN_WRITE2, 0, 10, WAIT_TYPE_US, sizeof(reg_D6), reg_D6},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_51), reg_51},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_53), reg_53},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(cabc_set_UI_para), cabc_set_UI_para},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(cabc_set_still_para), cabc_set_still_para},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(cabc_set_Moving_para), cabc_set_Moving_para},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(cabc_set_min_value), cabc_set_min_value},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(cabc_set_mode_UI), cabc_set_mode_UI},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_35), reg_35},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C2new), reg_C2new},
	{DTYPE_DCS_WRITE1, 0, 120, WAIT_TYPE_MS, sizeof(display_on), display_on},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_MS, sizeof(exit_sleep), exit_sleep},
};

static struct dsi_cmd_desc lcd_init_display_on_cmds[] = {
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_36), reg_36},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_3A), reg_3A},
	{DTYPE_GEN_WRITE2, 0, 10, WAIT_TYPE_US, sizeof(reg_B0), reg_B0},
	{DTYPE_GEN_WRITE2, 0, 10, WAIT_TYPE_US, sizeof(reg_D6), reg_D6},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_51), reg_51},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_53), reg_53},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_55), reg_55},
	{DTYPE_DCS_WRITE1, 0, 10, WAIT_TYPE_US, sizeof(reg_35), reg_35},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_B3), reg_B3},
	//{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_B4), reg_B4},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_B4new), reg_B4new},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_B6), reg_B6},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C3), reg_C3},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C0), reg_C0},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C1), reg_C1},
	//{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C2), reg_C2},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C2new), reg_C2new},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C4), reg_C4},
	//{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C6), reg_C6},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C6new), reg_C6new},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_C7), reg_C7},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_CB), reg_CB},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_CC), reg_CC},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_D9), reg_D9},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_D0), reg_D0},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_D2), reg_D2},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_D3), reg_D3},
	{DTYPE_GEN_LWRITE, 0, 10, WAIT_TYPE_US, sizeof(reg_D5), reg_D5},
	//{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US, sizeof(bist_test_mode), bist_test_mode},
	{DTYPE_DCS_WRITE, 0, 120, WAIT_TYPE_MS, sizeof(display_on), display_on},
	{DTYPE_DCS_WRITE, 0, 10, WAIT_TYPE_MS, sizeof(exit_sleep), exit_sleep},
};

static struct dsi_cmd_desc display_off_cmds[] = {
	{DTYPE_DCS_WRITE, 0, 21, WAIT_TYPE_MS, sizeof(display_off), display_off},
	{DTYPE_GEN_LWRITE, 0, 51, WAIT_TYPE_MS, sizeof(reg_D3_off), reg_D3_off},
	{DTYPE_DCS_WRITE, 0, 50, WAIT_TYPE_MS, sizeof(enter_sleep), enter_sleep},
};
/*******************************************************************************
** LCD VCC
*/
#define VCC_LCDIO_NAME	"lcdio-vcc"

static struct regulator *vcc_lcdio;

static struct vcc_desc lcd_vcc_init_cmds[] = {
	/* vcc get */
	{DTYPE_VCC_GET, VCC_LCDIO_NAME, &vcc_lcdio, 0, 0, WAIT_TYPE_MS, 0},
	/* io set voltage */
	{DTYPE_VCC_SET_VOLTAGE, VCC_LCDIO_NAME, &vcc_lcdio, 1800000, 1800000, WAIT_TYPE_MS, 0},
};
static struct vcc_desc lcd_vcc_enable_cmds[] = {
	/* vcc enable */
	{DTYPE_VCC_ENABLE, VCC_LCDIO_NAME, &vcc_lcdio, 0, 0, WAIT_TYPE_MS, 3},
};

/*******************************************************************************
** LCD IOMUX
*/
static struct pinctrl_data pctrl;

static struct pinctrl_cmd_desc lcd_pinctrl_init_cmds[] = {
	{DTYPE_PINCTRL_GET, &pctrl, 0},
	{DTYPE_PINCTRL_STATE_GET, &pctrl, DTYPE_PINCTRL_STATE_DEFAULT},
	{DTYPE_PINCTRL_STATE_GET, &pctrl, DTYPE_PINCTRL_STATE_IDLE},
};

static struct pinctrl_cmd_desc lcd_pinctrl_normal_cmds[] = {
	{DTYPE_PINCTRL_SET, &pctrl, DTYPE_PINCTRL_STATE_DEFAULT},
};

static struct pinctrl_cmd_desc lcd_pinctrl_lowpower_cmds[] = {
	{DTYPE_PINCTRL_SET, &pctrl, DTYPE_PINCTRL_STATE_IDLE},
};

static struct pinctrl_cmd_desc lcd_pinctrl_finit_cmds[] = {
	{DTYPE_PINCTRL_PUT, &pctrl, 0},
};


/*******************************************************************************
** LCD GPIO
*/
#define GPIO_LCD_G_BL_ENABLE_NAME "gpio_lcd_g_bl_enable"
#define GPIO_LCD_VCC1V8_ENABLE_NAME    "gpio_lcd_vcc1v8_enable"
#define GPIO_LCD_BL_ENABLE_NAME "gpio_lcd_bl_enable"
#define GPIO_LCD_RESET_NAME "gpio_lcd_reset"
#define GPIO_LCD_P5V5_ENABLE_NAME   "gpio_lcd_p5v5_enable"
#define GPIO_LCD_N5V5_ENABLE_NAME "gpio_lcd_n5v5_enable"

static uint32_t gpio_lcd_g_bl_enable;
static uint32_t gpio_lcd_vcc1v8_enable;
static uint32_t gpio_lcd_bl_enable;
static uint32_t gpio_lcd_reset;
static uint32_t gpio_lcd_p5v5_enable;
static uint32_t gpio_lcd_n5v5_enable;

static struct gpio_desc lcd_gpio_request_cmds[] = {
	/* g_bl_enable */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_G_BL_ENABLE_NAME, &gpio_lcd_g_bl_enable, 0},
	/* VDDIO_1.8V */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_VCC1V8_ENABLE_NAME, &gpio_lcd_vcc1v8_enable, 0},
	/* VSP_5.5V */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_P5V5_ENABLE_NAME, &gpio_lcd_p5v5_enable, 0},
	/* VSN_-5.8V */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_N5V5_ENABLE_NAME, &gpio_lcd_n5v5_enable, 0},
	/* reset */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	/* backlight enable */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_BL_ENABLE_NAME, &gpio_lcd_bl_enable, 0},
};

static struct gpio_desc lcd_gpio_normal_cmds[] = {
	/* g_bl_enable */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_G_BL_ENABLE_NAME, &gpio_lcd_g_bl_enable, 1},
	/* VCC_1.8V */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 2,
		GPIO_LCD_VCC1V8_ENABLE_NAME, &gpio_lcd_vcc1v8_enable, 1},
	/* AVDD_5.5V */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 2,
		GPIO_LCD_P5V5_ENABLE_NAME, &gpio_lcd_p5v5_enable, 1},
	/* AVEE_-5.5V */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 10,
		GPIO_LCD_N5V5_ENABLE_NAME, &gpio_lcd_n5v5_enable, 1},
	/* reset */
	//{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
	//	GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 1},
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 5,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 1},
	/* backlight enable */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_BL_ENABLE_NAME, &gpio_lcd_bl_enable, 1},
};

static struct gpio_desc lcd_gpio_free_cmds[] = {
	/* backlight enable */
	{DTYPE_GPIO_FREE, WAIT_TYPE_US, 0,
		GPIO_LCD_BL_ENABLE_NAME, &gpio_lcd_bl_enable, 0},
	/* AVEE_-5.5V */
	{DTYPE_GPIO_FREE, WAIT_TYPE_US, 0,
		GPIO_LCD_N5V5_ENABLE_NAME, &gpio_lcd_n5v5_enable, 0},
	/* AVDD_5.5V */
	{DTYPE_GPIO_FREE, WAIT_TYPE_US, 0,
		GPIO_LCD_P5V5_ENABLE_NAME, &gpio_lcd_p5v5_enable, 0},
	/* reset */
	{DTYPE_GPIO_FREE, WAIT_TYPE_US, 0,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	/* VCC_1.8V */
	{DTYPE_GPIO_FREE, WAIT_TYPE_US, 0,
		GPIO_LCD_VCC1V8_ENABLE_NAME, &gpio_lcd_vcc1v8_enable, 0},
	/* g_bl_enable */
	{DTYPE_GPIO_FREE, WAIT_TYPE_MS, 0,
		GPIO_LCD_G_BL_ENABLE_NAME, &gpio_lcd_g_bl_enable, 0},
};

static struct gpio_desc lcd_gpio_lowpower_cmds[] = {
	/* backlight enable */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 5,
		GPIO_LCD_BL_ENABLE_NAME, &gpio_lcd_bl_enable, 0},
	/* reset */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 10,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	/* AVEE_-5.5V */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 10,
		GPIO_LCD_N5V5_ENABLE_NAME, &gpio_lcd_n5v5_enable, 0},
	/* AVDD_5.5V*/
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 10,
		GPIO_LCD_P5V5_ENABLE_NAME, &gpio_lcd_p5v5_enable, 0},
	/* VCC_1.8V */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_VCC1V8_ENABLE_NAME, &gpio_lcd_vcc1v8_enable, 0},
	/* g_bl_enable */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_G_BL_ENABLE_NAME, &gpio_lcd_g_bl_enable, 0},

	/* backlight enable input */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_US, 0,
		GPIO_LCD_BL_ENABLE_NAME, &gpio_lcd_bl_enable, 0},
	/* AVEE_-5.8V input */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 0,
		GPIO_LCD_N5V5_ENABLE_NAME, &gpio_lcd_n5v5_enable, 0},
	/* AVDD_5.8V input */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 0,
		GPIO_LCD_P5V5_ENABLE_NAME, &gpio_lcd_p5v5_enable, 0},
	/* reset input */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_US, 0,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	/* VCC_1.8V */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 0,
		GPIO_LCD_VCC1V8_ENABLE_NAME, &gpio_lcd_vcc1v8_enable, 0},
	/* g_bl_enable */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 0,
		GPIO_LCD_G_BL_ENABLE_NAME, &gpio_lcd_g_bl_enable, 0},
};

/*******************************************************************************
**
*/

/*******************************************************************************
** ACM
*/
static u32 acm_lut_hue_table[] = {
	0x0000, 0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0006, 0x0007, 0x0007, 0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e,
	0x000f, 0x0010, 0x0011, 0x0012, 0x0012, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017, 0x0018, 0x0019, 0x001a, 0x001a, 0x001b, 0x001c,
	0x001d, 0x001e, 0x001e, 0x001f, 0x0020, 0x0021, 0x0022, 0x0022, 0x0023, 0x0024, 0x0024, 0x0025, 0x0026, 0x0027, 0x0028, 0x0028,
	0x0029, 0x002a, 0x002b, 0x002c, 0x002c, 0x002d, 0x002e, 0x002f, 0x0030, 0x0031, 0x0032, 0x0033, 0x0034, 0x0034, 0x0035, 0x0036,
	0x0037, 0x0038, 0x0039, 0x003a, 0x003a, 0x003b, 0x003c, 0x003d, 0x003e, 0x003f, 0x0040, 0x0041, 0x0042, 0x0042, 0x0043, 0x0044,
	0x0045, 0x0046, 0x0047, 0x0048, 0x0049, 0x004a, 0x004b, 0x004c, 0x004d, 0x004e, 0x004f, 0x0050, 0x0051, 0x0052, 0x0053, 0x0054,
	0x0055, 0x0056, 0x0057, 0x0058, 0x0059, 0x005a, 0x005b, 0x005c, 0x005d, 0x005e, 0x005f, 0x0060, 0x0061, 0x0062, 0x0063, 0x0064,
	0x0065, 0x0066, 0x0067, 0x0068, 0x0069, 0x006a, 0x006b, 0x006c, 0x006d, 0x006e, 0x006f, 0x0070, 0x0071, 0x0072, 0x0073, 0x0074,
	0x0075, 0x0076, 0x0077, 0x0078, 0x0079, 0x007a, 0x007b, 0x007c, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085,
	0x0086, 0x0087, 0x0088, 0x008a, 0x008b, 0x008c, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0094, 0x0095, 0x0096, 0x0098, 0x0099,
	0x009a, 0x009b, 0x009c, 0x009e, 0x009f, 0x00a0, 0x00a2, 0x00a3, 0x00a4, 0x00a5, 0x00a6, 0x00a8, 0x00a9, 0x00aa, 0x00ac, 0x00ad,
	0x00ae, 0x00af, 0x00b0, 0x00b1, 0x00b2, 0x00b4, 0x00b5, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00ba, 0x00bc, 0x00bd, 0x00be, 0x00bf,
	0x00c0, 0x00c1, 0x00c2, 0x00c3, 0x00c4, 0x00c5, 0x00c6, 0x00c7, 0x00c8, 0x00c9, 0x00ca, 0x00cb, 0x00cc, 0x00cd, 0x00ce, 0x00cf,
	0x00d0, 0x00d1, 0x00d2, 0x00d3, 0x00d4, 0x00d5, 0x00d6, 0x00d7, 0x00d8, 0x00d9, 0x00da, 0x00db, 0x00dc, 0x00dd, 0x00de, 0x00df,
	0x00e0, 0x00e1, 0x00e2, 0x00e3, 0x00e4, 0x00e5, 0x00e6, 0x00e7, 0x00e8, 0x00e9, 0x00ea, 0x00eb, 0x00ec, 0x00ed, 0x00ee, 0x00ef,
	0x00f0, 0x00f1, 0x00f2, 0x00f3, 0x00f4, 0x00f5, 0x00f6, 0x00f7, 0x00f8, 0x00f9, 0x00fa, 0x00fb, 0x00fc, 0x00fd, 0x00fe, 0x00ff,
	0x0100, 0x0101, 0x0102, 0x0103, 0x0104, 0x0105, 0x0106, 0x0107, 0x0108, 0x0109, 0x010a, 0x010b, 0x010c, 0x010d, 0x010e, 0x010f,
	0x0110, 0x0111, 0x0112, 0x0113, 0x0114, 0x0115, 0x0116, 0x0117, 0x0118, 0x0119, 0x011a, 0x011b, 0x011c, 0x011d, 0x011e, 0x011f,
	0x0120, 0x0121, 0x0122, 0x0123, 0x0124, 0x0125, 0x0126, 0x0127, 0x0128, 0x0129, 0x012a, 0x012b, 0x012c, 0x012d, 0x012e, 0x012f,
	0x0130, 0x0131, 0x0132, 0x0133, 0x0134, 0x0135, 0x0136, 0x0137, 0x0138, 0x0139, 0x013a, 0x013b, 0x013c, 0x013d, 0x013e, 0x013f,
	0x0140, 0x0141, 0x0142, 0x0143, 0x0144, 0x0145, 0x0146, 0x0147, 0x0148, 0x0149, 0x014a, 0x014b, 0x014c, 0x014d, 0x014e, 0x014f,
	0x0150, 0x0151, 0x0152, 0x0153, 0x0154, 0x0155, 0x0156, 0x0157, 0x0158, 0x0159, 0x015a, 0x015b, 0x015c, 0x015d, 0x015e, 0x015f,
	0x0160, 0x0161, 0x0162, 0x0163, 0x0164, 0x0165, 0x0166, 0x0167, 0x0168, 0x0169, 0x016a, 0x016b, 0x016c, 0x016d, 0x016e, 0x016f,
	0x0170, 0x0171, 0x0172, 0x0173, 0x0174, 0x0175, 0x0176, 0x0177, 0x0178, 0x0179, 0x017a, 0x017b, 0x017c, 0x017d, 0x017e, 0x017f,
	0x0180, 0x0181, 0x0182, 0x0183, 0x0184, 0x0185, 0x0186, 0x0187, 0x0188, 0x0189, 0x018a, 0x018b, 0x018c, 0x018d, 0x018e, 0x018f,
	0x0190, 0x0191, 0x0192, 0x0193, 0x0194, 0x0195, 0x0196, 0x0197, 0x0198, 0x0199, 0x019a, 0x019b, 0x019c, 0x019d, 0x019e, 0x019f,
	0x01a0, 0x01a1, 0x01a2, 0x01a2, 0x01a3, 0x01a4, 0x01a4, 0x01a5, 0x01a6, 0x01a7, 0x01a8, 0x01a8, 0x01a9, 0x01aa, 0x01aa, 0x01ab,
	0x01ac, 0x01ad, 0x01ae, 0x01af, 0x01b0, 0x01b1, 0x01b2, 0x01b3, 0x01b4, 0x01b4, 0x01b5, 0x01b6, 0x01b7, 0x01b8, 0x01b9, 0x01ba,
	0x01bb, 0x01bc, 0x01bd, 0x01be, 0x01bf, 0x01c0, 0x01c1, 0x01c2, 0x01c2, 0x01c3, 0x01c4, 0x01c5, 0x01c6, 0x01c7, 0x01c8, 0x01c9,
	0x01ca, 0x01cb, 0x01cc, 0x01cd, 0x01ce, 0x01d0, 0x01d1, 0x01d2, 0x01d3, 0x01d4, 0x01d5, 0x01d6, 0x01d8, 0x01d9, 0x01da, 0x01db,
	0x01dc, 0x01dd, 0x01de, 0x01e0, 0x01e1, 0x01e2, 0x01e4, 0x01e5, 0x01e6, 0x01e7, 0x01e8, 0x01ea, 0x01eb, 0x01ec, 0x01ee, 0x01ef,
	0x01f0, 0x01f1, 0x01f2, 0x01f3, 0x01f4, 0x01f5, 0x01f6, 0x01f7, 0x01f8, 0x01f9, 0x01fa, 0x01fb, 0x01fc, 0x01fd, 0x01fe, 0x01ff,
	0x0200, 0x0201, 0x0202, 0x0203, 0x0204, 0x0205, 0x0206, 0x0207, 0x0208, 0x0209, 0x020a, 0x020b, 0x020c, 0x020d, 0x020e, 0x020f,
	0x0210, 0x0211, 0x0212, 0x0213, 0x0214, 0x0215, 0x0216, 0x0217, 0x0218, 0x0219, 0x021a, 0x021b, 0x021c, 0x021d, 0x021e, 0x021f,
	0x0220, 0x0221, 0x0222, 0x0223, 0x0224, 0x0225, 0x0226, 0x0227, 0x0228, 0x0229, 0x022a, 0x022b, 0x022c, 0x022d, 0x022e, 0x022f,
	0x0230, 0x0231, 0x0232, 0x0233, 0x0234, 0x0235, 0x0236, 0x0237, 0x0238, 0x0239, 0x023a, 0x023b, 0x023c, 0x023d, 0x023e, 0x023f,
	0x0240, 0x0241, 0x0242, 0x0243, 0x0244, 0x0245, 0x0246, 0x0247, 0x0248, 0x0249, 0x024a, 0x024b, 0x024c, 0x024d, 0x024e, 0x024f,
	0x0250, 0x0251, 0x0252, 0x0253, 0x0254, 0x0255, 0x0256, 0x0257, 0x0258, 0x0259, 0x025a, 0x025b, 0x025c, 0x025d, 0x025e, 0x025f,
	0x0260, 0x0261, 0x0262, 0x0262, 0x0263, 0x0264, 0x0264, 0x0265, 0x0266, 0x0267, 0x0268, 0x0268, 0x0269, 0x026a, 0x026a, 0x026b,
	0x026c, 0x026d, 0x026e, 0x026f, 0x0270, 0x0270, 0x0271, 0x0272, 0x0273, 0x0274, 0x0275, 0x0276, 0x0276, 0x0277, 0x0278, 0x0279,
	0x027a, 0x027b, 0x027c, 0x027d, 0x027e, 0x027f, 0x0280, 0x0281, 0x0282, 0x0284, 0x0285, 0x0286, 0x0287, 0x0288, 0x0289, 0x028a,
	0x028b, 0x028c, 0x028e, 0x028f, 0x0290, 0x0292, 0x0293, 0x0294, 0x0296, 0x0297, 0x0298, 0x0299, 0x029b, 0x029c, 0x029d, 0x029f,
	0x02a0, 0x02a1, 0x02a2, 0x02a3, 0x02a4, 0x02a5, 0x02a6, 0x02a7, 0x02a8, 0x02a9, 0x02aa, 0x02ab, 0x02ac, 0x02ad, 0x02ae, 0x02af,
	0x02b0, 0x02b1, 0x02b1, 0x02b2, 0x02b3, 0x02b3, 0x02b4, 0x02b5, 0x02b6, 0x02b6, 0x02b7, 0x02b8, 0x02b8, 0x02b9, 0x02ba, 0x02ba,
	0x02bb, 0x02bc, 0x02bd, 0x02be, 0x02bf, 0x02c0, 0x02c1, 0x02c2, 0x02c2, 0x02c3, 0x02c4, 0x02c5, 0x02c6, 0x02c7, 0x02c8, 0x02c9,
	0x02ca, 0x02cb, 0x02cc, 0x02cd, 0x02ce, 0x02cf, 0x02d0, 0x02d1, 0x02d2, 0x02d4, 0x02d5, 0x02d6, 0x02d7, 0x02d8, 0x02d9, 0x02da,
	0x02db, 0x02dc, 0x02de, 0x02df, 0x02e0, 0x02e2, 0x02e3, 0x02e4, 0x02e6, 0x02e7, 0x02e8, 0x02e9, 0x02eb, 0x02ec, 0x02ed, 0x02ef,
	0x02f0, 0x02f1, 0x02f2, 0x02f3, 0x02f4, 0x02f5, 0x02f6, 0x02f7, 0x02f8, 0x02f9, 0x02fa, 0x02fb, 0x02fc, 0x02fd, 0x02fe, 0x02ff,
	0x0300, 0x0301, 0x0302, 0x0303, 0x0304, 0x0305, 0x0306, 0x0307, 0x0308, 0x0309, 0x030a, 0x030b, 0x030c, 0x030d, 0x030e, 0x030f,
	0x0310, 0x0311, 0x0312, 0x0313, 0x0314, 0x0315, 0x0316, 0x0317, 0x0318, 0x0319, 0x031a, 0x031b, 0x031c, 0x031d, 0x031e, 0x031f,
	0x0320, 0x0321, 0x0322, 0x0323, 0x0324, 0x0325, 0x0326, 0x0327, 0x0328, 0x0329, 0x032a, 0x032b, 0x032c, 0x032d, 0x032e, 0x032f,
	0x0330, 0x0331, 0x0332, 0x0333, 0x0334, 0x0335, 0x0336, 0x0337, 0x0338, 0x0339, 0x033a, 0x033b, 0x033c, 0x033d, 0x033e, 0x033f,
	0x0340, 0x0341, 0x0342, 0x0343, 0x0344, 0x0345, 0x0346, 0x0347, 0x0348, 0x0349, 0x034a, 0x034b, 0x034c, 0x034d, 0x034e, 0x034f,
	0x0350, 0x0351, 0x0352, 0x0353, 0x0354, 0x0355, 0x0356, 0x0357, 0x0358, 0x0359, 0x035a, 0x035b, 0x035c, 0x035d, 0x035e, 0x035f,
	0x0360, 0x0361, 0x0362, 0x0364, 0x0365, 0x0366, 0x0367, 0x0368, 0x036a, 0x036b, 0x036c, 0x036d, 0x036e, 0x036f, 0x0371, 0x0372,
	0x0373, 0x0374, 0x0375, 0x0377, 0x0378, 0x0379, 0x037a, 0x037b, 0x037c, 0x037e, 0x037f, 0x0380, 0x0381, 0x0382, 0x0384, 0x0385,
	0x0386, 0x0387, 0x0388, 0x0389, 0x038a, 0x038b, 0x038c, 0x038d, 0x038e, 0x0390, 0x0391, 0x0392, 0x0393, 0x0394, 0x0395, 0x0396,
	0x0397, 0x0398, 0x0399, 0x039a, 0x039b, 0x039c, 0x039d, 0x039e, 0x03a0, 0x03a1, 0x03a2, 0x03a3, 0x03a4, 0x03a5, 0x03a6, 0x03a7,
	0x03a8, 0x03a9, 0x03aa, 0x03ab, 0x03ac, 0x03ad, 0x03ae, 0x03af, 0x03b0, 0x03b1, 0x03b2, 0x03b3, 0x03b4, 0x03b5, 0x03b6, 0x03b7,
	0x03b8, 0x03b9, 0x03ba, 0x03bb, 0x03bc, 0x03bd, 0x03be, 0x03bf, 0x03c0, 0x03c0, 0x03c1, 0x03c2, 0x03c3, 0x03c4, 0x03c5, 0x03c6,
	0x03c7, 0x03c8, 0x03c9, 0x03ca, 0x03ca, 0x03cb, 0x03cc, 0x03cd, 0x03ce, 0x03cf, 0x03d0, 0x03d1, 0x03d2, 0x03d2, 0x03d3, 0x03d4,
	0x03d5, 0x03d6, 0x03d7, 0x03d8, 0x03d8, 0x03d9, 0x03da, 0x03db, 0x03dc, 0x03dd, 0x03de, 0x03df, 0x03e0, 0x03e0, 0x03e1, 0x03e2,
	0x03e3, 0x03e4, 0x03e5, 0x03e5, 0x03e6, 0x03e7, 0x03e8, 0x03e9, 0x03ea, 0x03ea, 0x03eb, 0x03ec, 0x03ed, 0x03ee, 0x03ee, 0x03ef,
	0x03f0, 0x03f1, 0x03f2, 0x03f3, 0x03f4, 0x03f5, 0x03f6, 0x03f7, 0x03f8, 0x03f9, 0x03fa, 0x03fb, 0x03fc, 0x03fd, 0x03fe, 0x03ff,
};

static u32 acm_lut_sata_table[] = {
	0x0033, 0x0030, 0x002c, 0x0028, 0x0025, 0x0027, 0x0029, 0x002b, 0x002d, 0x0033, 0x0038, 0x003e, 0x0044, 0x004a, 0x004f, 0x0054,
	0x005a, 0x005c, 0x005e, 0x0061, 0x0063, 0x0060, 0x005c, 0x0059, 0x0056, 0x0050, 0x004b, 0x0046, 0x0040, 0x003a, 0x0034, 0x002f,
	0x0029, 0x0024, 0x001e, 0x0018, 0x0013, 0x000f, 0x000a, 0x0006, 0x0002, 0x0007, 0x000c, 0x0012, 0x0017, 0x0028, 0x0038, 0x0049,
	0x005a, 0x0068, 0x0075, 0x0082, 0x0090, 0x0094, 0x0099, 0x009e, 0x00a2, 0x00a5, 0x00a8, 0x00aa, 0x00ad, 0x00af, 0x00b1, 0x00b3,
	0x00b5, 0x00b5, 0x00b5, 0x00b5, 0x00b5, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00b9, 0x00b9, 0x00b9, 0x00ba, 0x00ba, 0x00ba,
	0x00bb, 0x00ba, 0x00ba, 0x00ba, 0x00b9, 0x00ba, 0x00ba, 0x00ba, 0x00bb, 0x00bb, 0x00bb, 0x00bb, 0x00bb, 0x00ba, 0x00ba, 0x00ba,
	0x00b9, 0x00b9, 0x00b9, 0x00b9, 0x00b9, 0x00b8, 0x00b8, 0x00b8, 0x00b7, 0x00b7, 0x00b7, 0x00b7, 0x00b7, 0x00b7, 0x00b7, 0x00b7,
	0x00b7, 0x00b7, 0x00b7, 0x00b7, 0x00b7, 0x00b6, 0x00b6, 0x00b6, 0x00b5, 0x00b2, 0x00b0, 0x00ae, 0x00ab, 0x00a5, 0x009e, 0x0098,
	0x0092, 0x0088, 0x007e, 0x0073, 0x0069, 0x005f, 0x0054, 0x004a, 0x0040, 0x003a, 0x0034, 0x002f, 0x0029, 0x0026, 0x0024, 0x0022,
	0x001f, 0x001e, 0x001e, 0x001e, 0x001d, 0x001d, 0x001d, 0x001d, 0x001d, 0x0020, 0x0022, 0x0024, 0x0027, 0x002b, 0x0030, 0x0034,
	0x0038, 0x003d, 0x0042, 0x0047, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c, 0x004c,
	0x004c, 0x004e, 0x0051, 0x0054, 0x0056, 0x0058, 0x005a, 0x005b, 0x005d, 0x005e, 0x005f, 0x0060, 0x0061, 0x0062, 0x0064, 0x0066,
	0x0067, 0x0068, 0x0068, 0x0068, 0x0069, 0x006a, 0x006a, 0x006a, 0x006b, 0x006b, 0x006b, 0x006b, 0x006b, 0x006c, 0x006d, 0x006e,
	0x006f, 0x0070, 0x0070, 0x0070, 0x0071, 0x0072, 0x0074, 0x0076, 0x0077, 0x0078, 0x0078, 0x0078, 0x0079, 0x007b, 0x007c, 0x007e,
	0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x007f, 0x007e, 0x007e,
	0x007d, 0x007c, 0x007a, 0x0078, 0x0077, 0x0072, 0x006c, 0x0066, 0x0061, 0x0059, 0x0052, 0x004a, 0x0042, 0x003e, 0x003a, 0x0037,
};

static u32 acm_lut_satr_table[] = {
	0x0000, 0x0001, 0x0003, 0x0006, 0x0009, 0x000c, 0x000d, 0x000d, 0x000e, 0x000e, 0x000e, 0x000f, 0x000f, 0x000f, 0x0010, 0x0010,
	0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010,
	0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x000f, 0x000e,
	0x000d, 0x000b, 0x0009, 0x0006, 0x0004, 0x0001, 0x00ff, 0x00fc, 0x00fa, 0x00f8, 0x00f6, 0x00f4, 0x00f2, 0x00f0, 0x00ef, 0x00ef,
	0x0000, 0x0001, 0x0003, 0x0007, 0x000a, 0x000c, 0x000c, 0x000d, 0x000d, 0x000d, 0x000d, 0x000d, 0x000e, 0x000e, 0x000e, 0x000e,
	0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e,
	0x000e, 0x000f, 0x0011, 0x0013, 0x0015, 0x0018, 0x001b, 0x001e, 0x0020, 0x0022, 0x0024, 0x0025, 0x0025, 0x0025, 0x0025, 0x0024,
	0x0023, 0x0022, 0x0021, 0x001f, 0x001e, 0x001c, 0x001a, 0x0018, 0x0016, 0x0014, 0x0012, 0x000c, 0x0007, 0x0003, 0x0001, 0x0000,
	0x0000, 0x0000, 0x0002, 0x0003, 0x0006, 0x0008, 0x0009, 0x000a, 0x000a, 0x000b, 0x000b, 0x000c, 0x000d, 0x000d, 0x000d, 0x000e,
	0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e,
	0x000f, 0x0011, 0x0014, 0x0019, 0x001e, 0x0024, 0x002a, 0x0030, 0x0035, 0x003a, 0x003d, 0x003f, 0x0040, 0x0040, 0x003f, 0x003e,
	0x003d, 0x003c, 0x003a, 0x0038, 0x0035, 0x0033, 0x0030, 0x002d, 0x002a, 0x0026, 0x0023, 0x0019, 0x000f, 0x0007, 0x0002, 0x0000,
	0x0000, 0x0000, 0x0001, 0x0003, 0x0005, 0x0007, 0x0007, 0x0008, 0x0008, 0x0009, 0x0009, 0x000a, 0x000a, 0x000b, 0x000b, 0x000b,
	0x000c, 0x000c, 0x000c, 0x000c, 0x000d, 0x000d, 0x000d, 0x000d, 0x000d, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e, 0x000e,
	0x000f, 0x0011, 0x0014, 0x0019, 0x001e, 0x0024, 0x002a, 0x0030, 0x0035, 0x003a, 0x003d, 0x003f, 0x0040, 0x0040, 0x003f, 0x003e,
	0x003d, 0x003c, 0x003a, 0x0038, 0x0035, 0x0033, 0x0030, 0x002d, 0x002a, 0x0026, 0x0023, 0x0019, 0x000f, 0x0007, 0x0002, 0x0000,
	0x0000, 0x0001, 0x0004, 0x0008, 0x000b, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c,
	0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000d, 0x000d, 0x000d, 0x000e, 0x000e, 0x000e, 0x000f, 0x000f, 0x0010,
	0x0011, 0x0013, 0x0014, 0x0016, 0x0018, 0x001a, 0x001b, 0x001d, 0x001e, 0x001f, 0x0020, 0x0021, 0x0021, 0x0021, 0x0021, 0x0021,
	0x0020, 0x0020, 0x001f, 0x001e, 0x001e, 0x001d, 0x001c, 0x001b, 0x001a, 0x0018, 0x0017, 0x0011, 0x000b, 0x0005, 0x0001, 0x0000,
	0x0000, 0x0001, 0x0004, 0x0008, 0x000b, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c,
	0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000d, 0x000d, 0x000d, 0x000e, 0x000e, 0x000f, 0x0010, 0x0010, 0x0011, 0x0012,
	0x0013, 0x0015, 0x0016, 0x0018, 0x001a, 0x001b, 0x001c, 0x001e, 0x001f, 0x0020, 0x0020, 0x0021, 0x0021, 0x0021, 0x0021, 0x0021,
	0x0020, 0x0020, 0x001f, 0x001e, 0x001e, 0x001d, 0x001c, 0x001b, 0x001a, 0x0018, 0x0017, 0x0011, 0x000b, 0x0005, 0x0001, 0x0000,
	0x0000, 0x0001, 0x0004, 0x0008, 0x000b, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c,
	0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000c, 0x000d, 0x000d, 0x000d, 0x000e, 0x000e, 0x000e, 0x000f, 0x000f, 0x0010,
	0x0011, 0x0012, 0x0014, 0x0015, 0x0017, 0x0019, 0x001a, 0x001b, 0x001d, 0x001e, 0x001e, 0x001f, 0x001f, 0x001f, 0x001f, 0x001f,
	0x001e, 0x001e, 0x001d, 0x001d, 0x001c, 0x001c, 0x001b, 0x001a, 0x0019, 0x0018, 0x0017, 0x0012, 0x000b, 0x0006, 0x0001, 0x0000,
	0x0000, 0x0001, 0x0003, 0x0006, 0x0009, 0x000c, 0x000c, 0x000c, 0x000d, 0x000d, 0x000d, 0x000d, 0x000d, 0x000d, 0x000e, 0x000e,
	0x000e, 0x000e, 0x000e, 0x000e, 0x000f, 0x000f, 0x000f, 0x000f, 0x000f, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010, 0x0010,
	0x0010, 0x0011, 0x0012, 0x0013, 0x0014, 0x0016, 0x0017, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001d, 0x001d, 0x001d, 0x001d,
	0x001c, 0x001c, 0x001b, 0x001b, 0x001a, 0x0019, 0x0018, 0x0017, 0x0016, 0x0015, 0x0014, 0x000f, 0x0009, 0x0005, 0x0001, 0x0000,
};

/*******************************************************************************
** GAMMA
*/
static u32 gamma_lut_table_R[] = {
	0x0000, 0x000d, 0x0016, 0x001c, 0x0022, 0x0026, 0x002a, 0x002e, 0x0032, 0x0035, 0x0038, 0x003b, 0x003d, 0x0040, 0x0042, 0x0045,
	0x0047, 0x0049, 0x004b, 0x004d, 0x004f, 0x0051, 0x0053, 0x0055, 0x0056, 0x0058, 0x005a, 0x005c, 0x005d, 0x005f, 0x0060, 0x0062,
	0x0063, 0x0065, 0x0066, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x0070, 0x0071, 0x0072, 0x0073, 0x0075, 0x0076, 0x0077,
	0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086, 0x0087, 0x0088,
	0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0093, 0x0094, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x0099, 0x009a, 0x009b, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a3, 0x00a4,
	0x00a5, 0x00a6, 0x00a7, 0x00a7, 0x00a8, 0x00a9, 0x00aa, 0x00aa, 0x00ab, 0x00ac, 0x00ad, 0x00ad, 0x00ae, 0x00af, 0x00af, 0x00b0,
	0x00b1, 0x00b2, 0x00b2, 0x00b3, 0x00b4, 0x00b4, 0x00b5, 0x00b6, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00ba, 0x00bb, 0x00bb,
	0x00bc, 0x00bd, 0x00bd, 0x00be, 0x00be, 0x00bf, 0x00c0, 0x00c0, 0x00c1, 0x00c2, 0x00c2, 0x00c3, 0x00c4, 0x00c4, 0x00c5, 0x00c5,
	0x00c6, 0x00c7, 0x00c7, 0x00c8, 0x00c8, 0x00c9, 0x00ca, 0x00ca, 0x00cb, 0x00cb, 0x00cc, 0x00cd, 0x00cd, 0x00ce, 0x00ce, 0x00cf,
	0x00d0, 0x00d0, 0x00d1, 0x00d1, 0x00d2, 0x00d2, 0x00d3, 0x00d4, 0x00d4, 0x00d5, 0x00d5, 0x00d6, 0x00d6, 0x00d7, 0x00d7, 0x00d8,
	0x00d8, 0x00d9, 0x00da, 0x00da, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dd, 0x00dd, 0x00de, 0x00de, 0x00df, 0x00df, 0x00e0, 0x00e0,
	0x00e1, 0x00e2, 0x00e2, 0x00e3, 0x00e3, 0x00e4, 0x00e4, 0x00e5, 0x00e5, 0x00e6, 0x00e6, 0x00e7, 0x00e7, 0x00e8, 0x00e8, 0x00e9,
	0x00e9, 0x00ea, 0x00ea, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ed, 0x00ed, 0x00ee, 0x00ee, 0x00ee, 0x00ef, 0x00ef, 0x00f0, 0x00f0,
	0x00f1, 0x00f1, 0x00f2, 0x00f2, 0x00f3, 0x00f3, 0x00f4, 0x00f4, 0x00f5, 0x00f5, 0x00f6, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff,
};

static u32 gamma_lut_table_G[] = {
	0x0000, 0x000d, 0x0016, 0x001c, 0x0022, 0x0026, 0x002a, 0x002e, 0x0032, 0x0035, 0x0038, 0x003b, 0x003d, 0x0040, 0x0042, 0x0045,
	0x0047, 0x0049, 0x004b, 0x004d, 0x004f, 0x0051, 0x0053, 0x0055, 0x0056, 0x0058, 0x005a, 0x005c, 0x005d, 0x005f, 0x0060, 0x0062,
	0x0063, 0x0065, 0x0066, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x0070, 0x0071, 0x0072, 0x0073, 0x0075, 0x0076, 0x0077,
	0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086, 0x0087, 0x0088,
	0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0093, 0x0094, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x0099, 0x009a, 0x009b, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a3, 0x00a4,
	0x00a5, 0x00a6, 0x00a7, 0x00a7, 0x00a8, 0x00a9, 0x00aa, 0x00aa, 0x00ab, 0x00ac, 0x00ad, 0x00ad, 0x00ae, 0x00af, 0x00af, 0x00b0,
	0x00b1, 0x00b2, 0x00b2, 0x00b3, 0x00b4, 0x00b4, 0x00b5, 0x00b6, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00ba, 0x00bb, 0x00bb,
	0x00bc, 0x00bd, 0x00bd, 0x00be, 0x00be, 0x00bf, 0x00c0, 0x00c0, 0x00c1, 0x00c2, 0x00c2, 0x00c3, 0x00c4, 0x00c4, 0x00c5, 0x00c5,
	0x00c6, 0x00c7, 0x00c7, 0x00c8, 0x00c8, 0x00c9, 0x00ca, 0x00ca, 0x00cb, 0x00cb, 0x00cc, 0x00cd, 0x00cd, 0x00ce, 0x00ce, 0x00cf,
	0x00d0, 0x00d0, 0x00d1, 0x00d1, 0x00d2, 0x00d2, 0x00d3, 0x00d4, 0x00d4, 0x00d5, 0x00d5, 0x00d6, 0x00d6, 0x00d7, 0x00d7, 0x00d8,
	0x00d8, 0x00d9, 0x00da, 0x00da, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dd, 0x00dd, 0x00de, 0x00de, 0x00df, 0x00df, 0x00e0, 0x00e0,
	0x00e1, 0x00e2, 0x00e2, 0x00e3, 0x00e3, 0x00e4, 0x00e4, 0x00e5, 0x00e5, 0x00e6, 0x00e6, 0x00e7, 0x00e7, 0x00e8, 0x00e8, 0x00e9,
	0x00e9, 0x00ea, 0x00ea, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ed, 0x00ed, 0x00ee, 0x00ee, 0x00ee, 0x00ef, 0x00ef, 0x00f0, 0x00f0,
	0x00f1, 0x00f1, 0x00f2, 0x00f2, 0x00f3, 0x00f3, 0x00f4, 0x00f4, 0x00f5, 0x00f5, 0x00f6, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff,
};

static u32 gamma_lut_table_B[] = {
	0x0000, 0x000d, 0x0016, 0x001c, 0x0022, 0x0026, 0x002a, 0x002e, 0x0032, 0x0035, 0x0038, 0x003b, 0x003d, 0x0040, 0x0042, 0x0045,
	0x0047, 0x0049, 0x004b, 0x004d, 0x004f, 0x0051, 0x0053, 0x0055, 0x0056, 0x0058, 0x005a, 0x005c, 0x005d, 0x005f, 0x0060, 0x0062,
	0x0063, 0x0065, 0x0066, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x0070, 0x0071, 0x0072, 0x0073, 0x0075, 0x0076, 0x0077,
	0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086, 0x0087, 0x0088,
	0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0093, 0x0094, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x0099, 0x009a, 0x009b, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a3, 0x00a4,
	0x00a5, 0x00a6, 0x00a7, 0x00a7, 0x00a8, 0x00a9, 0x00aa, 0x00aa, 0x00ab, 0x00ac, 0x00ad, 0x00ad, 0x00ae, 0x00af, 0x00af, 0x00b0,
	0x00b1, 0x00b2, 0x00b2, 0x00b3, 0x00b4, 0x00b4, 0x00b5, 0x00b6, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00ba, 0x00bb, 0x00bb,
	0x00bc, 0x00bd, 0x00bd, 0x00be, 0x00be, 0x00bf, 0x00c0, 0x00c0, 0x00c1, 0x00c2, 0x00c2, 0x00c3, 0x00c4, 0x00c4, 0x00c5, 0x00c5,
	0x00c6, 0x00c7, 0x00c7, 0x00c8, 0x00c8, 0x00c9, 0x00ca, 0x00ca, 0x00cb, 0x00cb, 0x00cc, 0x00cd, 0x00cd, 0x00ce, 0x00ce, 0x00cf,
	0x00d0, 0x00d0, 0x00d1, 0x00d1, 0x00d2, 0x00d2, 0x00d3, 0x00d4, 0x00d4, 0x00d5, 0x00d5, 0x00d6, 0x00d6, 0x00d7, 0x00d7, 0x00d8,
	0x00d8, 0x00d9, 0x00da, 0x00da, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dd, 0x00dd, 0x00de, 0x00de, 0x00df, 0x00df, 0x00e0, 0x00e0,
	0x00e1, 0x00e2, 0x00e2, 0x00e3, 0x00e3, 0x00e4, 0x00e4, 0x00e5, 0x00e5, 0x00e6, 0x00e6, 0x00e7, 0x00e7, 0x00e8, 0x00e8, 0x00e9,
	0x00e9, 0x00ea, 0x00ea, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ed, 0x00ed, 0x00ee, 0x00ee, 0x00ee, 0x00ef, 0x00ef, 0x00f0, 0x00f0,
	0x00f1, 0x00f1, 0x00f2, 0x00f2, 0x00f3, 0x00f3, 0x00f4, 0x00f4, 0x00f5, 0x00f5, 0x00f6, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff,
};

/*******************************************************************************
** IGM
*/
static u32 igm_lut_table_R[] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009, 0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053, 0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c, 0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101, 0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185, 0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229, 0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1, 0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd, 0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef, 0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629, 0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c, 0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a, 0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5, 0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc, 0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3, 0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
};

static u32 igm_lut_table_G[] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009, 0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053, 0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c, 0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101, 0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185, 0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229, 0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1, 0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd, 0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef, 0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629, 0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c, 0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a, 0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5, 0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc, 0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3, 0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
};

static u32 igm_lut_table_B[] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009, 0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053, 0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c, 0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101, 0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185, 0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229, 0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1, 0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd, 0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef, 0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629, 0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c, 0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a, 0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5, 0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc, 0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3, 0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
};

/*******************************************************************************
** GMT
*/
static u32 gmp_lut_table_low32bit[9][9][9] = {
	{
		{0x00000000, 0x000181a0, 0x0002f340, 0x000474e0, 0x0005e680, 0x00076820, 0x0008d9c0, 0x000a5b60, 0x000bccf3, },
		{0x3c1e2014, 0x361f91b4, 0x30211354, 0x2a2284f4, 0x24240694, 0x1e257834, 0x1826f9d4, 0x12287b74, 0x0c29dd07, },
		{0x783c3029, 0x723db1c9, 0x6c3f2369, 0x6640a509, 0x604216a9, 0x5a439849, 0x544519e9, 0x4e468b89, 0x4847fd1c, },
		{0xb45a503d, 0xae5bc1dd, 0xa85d437d, 0xa25ec51d, 0x9c6036bd, 0x9661b85d, 0x906329fd, 0x8a64ab9d, 0x84661d30, },
		{0xf0787051, 0xea79e1f1, 0xe47b6391, 0xde7cd531, 0xd87e56d1, 0xd27fc871, 0xcc814a11, 0xc682bbb1, 0xc0842d44, },
		{0x2c968066, 0x26980206, 0x209973a6, 0x199af546, 0x139c66e6, 0x0d9de886, 0x079f6a26, 0x01a0dbc6, 0xfca24d59, },
		{0x67b4a07a, 0x61b6121a, 0x5bb793ba, 0x55b9055a, 0x4fba86fa, 0x49bc089a, 0x43bd7a3a, 0x3dbefbda, 0x38c06d6d, },
		{0xa3d2b08e, 0x9dd4322e, 0x97d5b3ce, 0x91d7256e, 0x8bd8a70e, 0x85da18ae, 0x7fdb9a4e, 0x79dd0bee, 0x73de7d81, },
		{0xddefe0a2, 0xd7f16242, 0xd1f2d3e2, 0xcbf45582, 0xc5f5c722, 0xbff748c2, 0xb9f8ba62, 0xb3fa3c02, 0xadfbad95, },
	},
	{
		{0xe8004006, 0xe201b1a6, 0xdc033346, 0xd604a4e6, 0xd0062686, 0xca079826, 0xc40919c6, 0xbe0a9b66, 0xb80bfcf9, },
		{0x241e501a, 0x1e1fd1ba, 0x1821435a, 0x1222c4fa, 0x0c24469a, 0x0625b83a, 0x002739da, 0xfa28ab7a, 0xf42a1d0d, },
		{0x603c702e, 0x5a3df1ce, 0x543f636e, 0x4e40e50e, 0x484256ae, 0x4243d84e, 0x3c4549ee, 0x3646cb8e, 0x30483d21, },
		{0x9c5a9043, 0x965c01e3, 0x905d8383, 0x8a5ef523, 0x846076c3, 0x7e61e863, 0x78636a03, 0x7264dba3, 0x6c664d36, },
		{0xd878a057, 0xd27a21f7, 0xcc7b9397, 0xc67d1537, 0xc07e86d7, 0xb9800877, 0xb3818a17, 0xad82fbb7, 0xa8846d4a, },
		{0x1396c06b, 0x0d98320b, 0x0799b3ab, 0x019b354b, 0xfb9ca6eb, 0xf59e288b, 0xef9f9a2b, 0xe9a11bcb, 0xe4a28d5e, },
		{0x4fb4e080, 0x49b65220, 0x43b7d3c0, 0x3db94560, 0x37bac700, 0x31bc38a0, 0x2bbdba40, 0x25bf2be0, 0x1fc09d73, },
		{0x8bd2f094, 0x85d47234, 0x7fd5e3d4, 0x79d76574, 0x73d8d714, 0x6dda58b4, 0x67dbca54, 0x61dd4bf4, 0x5bdebd87, },
		{0xc5f020a8, 0xbff19248, 0xb9f313e8, 0xb3f48588, 0xadf60728, 0xa7f788c8, 0xa1f8fa68, 0x9bfa7c08, 0x95fbdd9b, },
	},
	{
		{0xd000700b, 0xca01f1ab, 0xc403734b, 0xbe04e4eb, 0xb806668b, 0xb207d82b, 0xac0959cb, 0xa60acb6b, 0xa00c3cfe, },
		{0x0c1e901f, 0x062011bf, 0x0021835f, 0xfa2304ff, 0xf424769f, 0xee25f83f, 0xe82769df, 0xe228eb7f, 0xdc2a5d12, },
		{0x483cb034, 0x423e21d4, 0x3c3fa374, 0x36411514, 0x304296b4, 0x2a440854, 0x244589f4, 0x1e470b94, 0x18486d27, },
		{0x845ac048, 0x7e5c41e8, 0x785db388, 0x725f3528, 0x6c60b6c8, 0x66622868, 0x5f63aa08, 0x59651ba8, 0x54668d3b, },
		{0xc078e05c, 0xb97a61fc, 0xb37bd39c, 0xad7d553c, 0xa77ec6dc, 0xa180487c, 0x9b81ba1c, 0x95833bbc, 0x9084ad4f, },
		{0xfb970071, 0xf5987211, 0xef99f3b1, 0xe99b6551, 0xe39ce6f1, 0xdd9e5891, 0xd79fda31, 0xd1a14bd1, 0xcba2bd64, },
		{0x37b51085, 0x31b69225, 0x2bb803c5, 0x25b98565, 0x1fbaf705, 0x19bc78a5, 0x13bdfa45, 0x0dbf6be5, 0x07c0dd78, },
		{0x73d33099, 0x6dd4a239, 0x67d623d9, 0x61d7a579, 0x5bd91719, 0x55da98b9, 0x4fdc0a59, 0x49dd8bf9, 0x43defd8c, },
		{0xadf050ad, 0xa7f1d24d, 0xa1f353ed, 0x9bf4c58d, 0x95f6472d, 0x8ff7b8cd, 0x89f93a6d, 0x83faac0d, 0x7dfc1da0, },
	},
	{
		{0xb800b011, 0xb20231b1, 0xac03a351, 0xa60524f1, 0xa0069691, 0x9a081831, 0x940989d1, 0x8e0b0b71, 0x880c7d04, },
		{0xf41ed025, 0xee2041c5, 0xe821c365, 0xe2233505, 0xdc24b6a5, 0xd6263845, 0xd027a9e5, 0xca292b85, 0xc42a8d18, },
		{0x303ce039, 0x2a3e61d9, 0x243fe379, 0x1e415519, 0x1842d6b9, 0x12444859, 0x0c45c9f9, 0x05473b99, 0x0048ad2c, },
		{0x6c5b004e, 0x665c81ee, 0x5f5df38e, 0x595f752e, 0x5360e6ce, 0x4d62686e, 0x4763da0e, 0x41655bae, 0x3c66cd41, },
		{0xa7792062, 0xa17a9202, 0x9b7c13a2, 0x957d8542, 0x8f7f06e2, 0x89807882, 0x8381fa22, 0x7d837bc2, 0x7784dd55, },
		{0xe3973076, 0xdd98b216, 0xd79a23b6, 0xd19ba556, 0xcb9d26f6, 0xc59e9896, 0xbfa01a36, 0xb9a18bd6, 0xb3a2fd69, },
		{0x1fb5508b, 0x19b6d22b, 0x13b843cb, 0x0db9c56b, 0x07bb370b, 0x01bcb8ab, 0xfbbe2a4b, 0xf5bfabeb, 0xefc11d7e, },
		{0x5bd3709f, 0x55d4e23f, 0x4fd663df, 0x49d7d57f, 0x43d9571f, 0x3ddac8bf, 0x37dc4a5f, 0x31ddbbff, 0x2bdf2d92, },
		{0x95f090b3, 0x8ff21253, 0x89f383f3, 0x83f50593, 0x7df67733, 0x77f7f8d3, 0x71f97a73, 0x6bfaec13, 0x65fc5da6, },
	},
	{
		{0xa000f016, 0x9a0261b6, 0x9403e356, 0x8e0564f6, 0x8806d696, 0x82085836, 0x7c09c9d6, 0x760b4b76, 0x700cbd09, },
		{0xdc1f002a, 0xd62081ca, 0xd022036a, 0xca23750a, 0xc424f6aa, 0xbe26684a, 0xb827e9ea, 0xb2295b8a, 0xac2acd1d, },
		{0x183d203f, 0x123ea1df, 0x0c40137f, 0x0541951f, 0xff4306bf, 0xf944885f, 0xf345f9ff, 0xed477b9f, 0xe848ed32, },
		{0x535b4053, 0x4d5cb1f3, 0x475e3393, 0x415fa533, 0x3b6126d3, 0x3562a873, 0x2f641a13, 0x29659bb3, 0x2466fd46, },
		{0x8f795067, 0x897ad207, 0x837c53a7, 0x7d7dc547, 0x777f46e7, 0x7180b887, 0x6b823a27, 0x6583abc7, 0x5f851d5a, },
		{0xcb97707c, 0xc598f21c, 0xbf9a63bc, 0xb99be55c, 0xb39d56fc, 0xad9ed89c, 0xa7a04a3c, 0xa1a1cbdc, 0x9ba33d6f, },
		{0x07b59090, 0x01b70230, 0xfbb883d0, 0xf5b9f570, 0xefbb7710, 0xe9bce8b0, 0xe3be6a50, 0xddbfebf0, 0xd7c14d83, },
		{0x43d3a0a4, 0x3dd52244, 0x37d693e4, 0x31d81584, 0x2bd99724, 0x25db08c4, 0x1fdc8a64, 0x19ddfc04, 0x13df6d97, },
		{0x7df0d0b8, 0x77f24258, 0x71f3c3f8, 0x6bf54598, 0x65f6b738, 0x5ff838d8, 0x59f9aa78, 0x53fb2c18, 0x4dfc9dab, },
	},
	{
		{0x8801301c, 0x8202a1bc, 0x7c04235c, 0x760594fc, 0x7007169c, 0x6a08883c, 0x640a09dc, 0x5e0b7b7c, 0x580ced0f, },
		{0xc41f4030, 0xbe20c1d0, 0xb8223370, 0xb223b510, 0xac2526b0, 0xa526a850, 0x9f2829f0, 0x99299b90, 0x942b0d23, },
		{0xff3d6044, 0xf93ed1e4, 0xf3405384, 0xed41d524, 0xe74346c4, 0xe144c864, 0xdb463a04, 0xd547bba4, 0xd0492d37, },
		{0x3b5b7059, 0x355cf1f9, 0x2f5e7399, 0x295fe539, 0x236166d9, 0x1d62d879, 0x17645a19, 0x1165cbb9, 0x0b673d4c, },
		{0x7779906d, 0x717b120d, 0x6b7c83ad, 0x657e054d, 0x5f7f76ed, 0x5980f88d, 0x53826a2d, 0x4d83ebcd, 0x47855d60, },
		{0xb397b081, 0xad992221, 0xa79aa3c1, 0xa19c1561, 0x9b9d9701, 0x959f18a1, 0x8fa08a41, 0x89a20be1, 0x83a36d74, },
		{0xefb5c096, 0xe9b74236, 0xe3b8c3d6, 0xddba3576, 0xd7bbb716, 0xd1bd28b6, 0xcbbeaa56, 0xc5c01bf6, 0xbfc18d89, },
		{0x2bd3e0aa, 0x25d5624a, 0x1fd6d3ea, 0x19d8558a, 0x13d9c72a, 0x0ddb48ca, 0x07dcba6a, 0x01de3c0a, 0xfbdfad9d, },
		{0x65f110be, 0x5ff2825e, 0x59f403fe, 0x53f5759e, 0x4df6f73e, 0x47f868de, 0x41f9ea7e, 0x3bfb5c1e, 0x35fccdb1, },
	},
	{
		{0x70016021, 0x6a02e1c1, 0x64045361, 0x5e05d501, 0x580746a1, 0x5208c841, 0x4b0a49e1, 0x450bbb81, 0x400d2d14, },
		{0xac1f8036, 0xa520f1d6, 0x9f227376, 0x9923f516, 0x932566b6, 0x8d26e856, 0x872859f6, 0x8129db96, 0x7c2b4d29, },
		{0xe73da04a, 0xe13f11ea, 0xdb40938a, 0xd542052a, 0xcf4386ca, 0xc944f86a, 0xc3467a0a, 0xbd47ebaa, 0xb7495d3d, },
		{0x235bb05e, 0x1d5d31fe, 0x175ea39e, 0x1160253e, 0x0b6196de, 0x0563187e, 0xff649a1e, 0xf9660bbe, 0xf3677d51, },
		{0x5f79d073, 0x597b4213, 0x537cc3b3, 0x4d7e3553, 0x477fb6f3, 0x41813893, 0x3b82aa33, 0x35842bd3, 0x2f859d66, },
		{0x9b97e087, 0x95996227, 0x8f9ae3c7, 0x899c5567, 0x839dd707, 0x7d9f48a7, 0x77a0ca47, 0x71a23be7, 0x6ba3ad7a, },
		{0xd7b6009b, 0xd1b7823b, 0xcbb8f3db, 0xc5ba757b, 0xbfbbe71b, 0xb9bd68bb, 0xb3beda5b, 0xadc05bfb, 0xa7c1cd8e, },
		{0x13d420b0, 0x0dd59250, 0x07d713f0, 0x01d88590, 0xfbda0730, 0xf5db88d0, 0xefdcfa70, 0xe9de7c10, 0xe3dfdda3, },
		{0x4df140c3, 0x47f2c263, 0x41f43403, 0x3bf5b5a3, 0x35f73743, 0x2ff8a8e3, 0x29fa2a83, 0x23fb9c23, 0x1dfd0db6, },
	},
	{
		{0x5801a027, 0x520321c7, 0x4b049367, 0x45061507, 0x3f0786a7, 0x39090847, 0x330a79e7, 0x2d0bfb87, 0x280d6d1a, },
		{0x931fc03b, 0x8d2131db, 0x8722b37b, 0x8124251b, 0x7b25a6bb, 0x7527185b, 0x6f2899fb, 0x692a0b9b, 0x632b7d2e, },
		{0xcf3dd04f, 0xc93f51ef, 0xc340c38f, 0xbd42452f, 0xb743b6cf, 0xb145386f, 0xab46ba0f, 0xa5482baf, 0x9f499d42, },
		{0x0b5bf064, 0x055d6204, 0xff5ee3a4, 0xf9606544, 0xf361d6e4, 0xed635884, 0xe764ca24, 0xe1664bc4, 0xdb67bd57, },
		{0x477a1078, 0x417b8218, 0x3b7d03b8, 0x357e7558, 0x2f7ff6f8, 0x29816898, 0x2382ea38, 0x1d845bd8, 0x1785cd6b, },
		{0x8398208c, 0x7d99a22c, 0x779b13cc, 0x719c956c, 0x6b9e070c, 0x659f88ac, 0x5fa10a4c, 0x59a27bec, 0x53a3ed7f, },
		{0xbfb640a1, 0xb9b7b241, 0xb3b933e1, 0xadbaa581, 0xa7bc2721, 0xa1bda8c1, 0x9bbf1a61, 0x95c09c01, 0x8fc20d94, },
		{0xfbd450b5, 0xf5d5d255, 0xefd753f5, 0xe9d8c595, 0xe3da4735, 0xdddbb8d5, 0xd7dd3a75, 0xd1deac15, 0xcbe01da8, },
		{0x35f180c9, 0x2ff30269, 0x29f47409, 0x23f5f5a9, 0x1df76749, 0x17f8e8e9, 0x11fa5a89, 0x0bfbdc29, 0x05fd4dbc, },
	},
	{
		{0x3001e02c, 0x2a0351cc, 0x2404d36c, 0x1e06450c, 0x1807c6ac, 0x1209384c, 0x0c0ab9ec, 0x060c2b8c, 0x000d9d1f, },
		{0x6c1ff040, 0x662171e0, 0x6022e380, 0x5a246520, 0x5425d6c0, 0x4e275860, 0x4828da00, 0x422a4ba0, 0x3c2bbd33, },
		{0xa83e1055, 0xa23f81f5, 0x9c410395, 0x96428535, 0x9043f6d5, 0x8a457875, 0x8446ea15, 0x7e486bb5, 0x7849dd48, },
		{0xe45c3069, 0xde5da209, 0xd85f23a9, 0xd2609549, 0xcc6216e9, 0xc6638889, 0xc0650a29, 0xba667bc9, 0xb467ed5c, },
		{0xf07a407d, 0xf07bc21d, 0xf07d33bd, 0xf07eb55d, 0xf08026fd, 0xf081a89d, 0xf0831a3d, 0xf0849bdd, 0xf0860d70, },
		{0xf0986092, 0xf099d232, 0xf09b53d2, 0xf09cc572, 0xf09e4712, 0xf09fc8b2, 0xf0a13a52, 0xf0a2bbf2, 0xf0a41d85, },
		{0xf0b670a6, 0xf0b7f246, 0xf0b973e6, 0xf0bae586, 0xf0bc6726, 0xf0bdd8c6, 0xf0bf5a66, 0xf0c0cc06, 0xf0c23d99, },
		{0xf0d490ba, 0xf0d6125a, 0xf0d783fa, 0xf0d9059a, 0xf0da773a, 0xf0dbf8da, 0xf0dd6a7a, 0xf0deec1a, 0xf0e05dad, },
		{0xf0f1c0ce, 0xf0f3326e, 0xf0f4b40e, 0xf0f625ae, 0xf0f7a74e, 0xf0f918ee, 0xf0fa9a8e, 0xf0fc1c2e, 0xf0fd7dc1, },
	},
};

static u32 gmp_lut_table_high4bit[9][9][9] = {
	{
		{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
		{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
		{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
		{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
		{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
		{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, },
		{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
		{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
		{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
	},
	{
		{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
		{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x1, 0x1, },
		{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, },
		{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, },
		{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, },
		{0x3, 0x3, 0x3, 0x3, 0x2, 0x2, 0x2, 0x2, 0x2, },
		{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
		{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
		{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
	},
	{
		{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
		{0x4, 0x4, 0x4, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
		{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
		{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
		{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
		{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
		{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
		{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
		{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
	},
	{
		{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
		{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
		{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
		{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
		{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
		{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
		{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x6, 0x6, 0x6, },
		{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
		{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
	},
	{
		{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
		{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
		{0x8, 0x8, 0x8, 0x8, 0x7, 0x7, 0x7, 0x7, 0x7, },
		{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
		{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
		{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
		{0x9, 0x9, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
		{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
		{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
	},
	{
		{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
		{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
		{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
		{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
		{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
		{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
		{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
		{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xa, },
		{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
	},
	{
		{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
		{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
		{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
		{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xb, 0xb, 0xb, },
		{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
		{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
		{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
		{0xd, 0xd, 0xd, 0xd, 0xc, 0xc, 0xc, 0xc, 0xc, },
		{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
	},
	{
		{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
		{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
		{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
		{0xe, 0xe, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
		{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, },
		{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, },
		{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, },
		{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
	},
	{
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
	},
};

/*******************************************************************************
** XCC
*/
static u32 xcc_table[12] = {0x0, 0x8000, 0x0,0x0,0x0,0x0,0x8000,0x0,0x0,0x0,0x0,0x8000,};

/*******************************************************************************
**
*/

static int btv_i2c_write_u8(u8 addr,u8 val)
{
	int ret = 0;
	u8 write_buf[2];
	struct i2c_client *client = g_sony_client;
	struct i2c_msg msgs[] = {
		{
			.addr = client->addr,
			.flags = client->flags & I2C_M_TEN,
			.len = sizeof(write_buf),
			.buf = write_buf,
		},
	};
	write_buf[0] = addr;
	write_buf[1] = val;

	ret = i2c_transfer(client->adapter, msgs, 1);
	if(ret != 1){
		HISI_FB_ERR("write transfer error\n");
		ret = -EIO;
	} else {
		ret = 0;
	}
	return ret;
}

static int btv_i2c_read_u8(u8 addr,u8* val)
{
	int ret = 0;
	struct i2c_client *client = g_sony_client;
	u8 read_buf[2];
	struct i2c_msg  msgs[] = {
		{
			.addr = client->addr,
			.flags = client->flags & I2C_M_TEN,
			.len = 1,
			.buf = read_buf,
		},
		{
			.addr = client->addr,
			.flags = (client->flags & I2C_M_TEN) | I2C_M_RD,
			.len = 1,
			.buf = val,
		},
	};
	read_buf[0] = addr;
	ret = i2c_transfer(client->adapter, msgs, 2);
	if (ret != 2) {
		HISI_FB_ERR("read transfer error\n");
		ret = -EIO;
	} else {
		ret = 0;
	}
	return ret;
}



static ssize_t mipi_lp8556_read_show(struct device *dev, struct device_attribute *attr, char *buf)
{
	int ret  = -1;
	ret = snprintf(buf, PAGE_SIZE,"reg:0x%x = 0x%x\n",lp8556_reg_addr,lp8556_reg_value);
	return ret;
}

static ssize_t mipi_lp8556_write_store(struct device *dev, struct device_attribute *attr, const char *buf, size_t size)
{
	int ret  = -1;
	unsigned long flag = 0xFF;
	u8 value = 0;
	ret = sscanf(buf,"%1d", &flag);
	if(ret < 0) {
		HISI_FB_ERR("%s: input value is error, ret = %d.\n",ret);
		return -EINVAL;
	}

	if(0 == flag){//read
		ret = sscanf(buf,"%1d %2x", &flag,&lp8556_reg_addr);
		if (ret < 0) {
			HISI_FB_ERR("%s: input value is error, ret = %d.\n",ret);
			return -EINVAL;
		}
		btv_i2c_read_u8(lp8556_reg_addr,&lp8556_reg_value);
	}else if(1 == flag){ //write
		ret = sscanf(buf,"%1d %2x %2x", &flag,&lp8556_reg_addr,&value);
		if (ret < 0) {
			HISI_FB_ERR("%s: input value is error, ret = %d.\n",ret);
			return -EINVAL;
		}
		btv_i2c_write_u8(lp8556_reg_addr,value);
	}else{
		HISI_FB_ERR("%s: input value is error, flag = %ld.\n",flag);
	}
	return size;
}

static struct device_attribute attributes[] = {
	__ATTR(ipc_i2c_read_write, 0664, mipi_lp8556_read_show, mipi_lp8556_write_store),
};

static int add_sysfs_interfaces(struct device *dev)
{
	int i = 0;

	for (i = 0; i < ARRAY_SIZE(attributes); i++) {
		if (device_create_file(dev, attributes + i)) {
			HISI_FB_ERR("%s: %s create fail\n", __func__,attributes[i].attr.name);
			goto undo;
		}
	}

	return 0;
undo:
	for (i--; i >= 0; i--)
		device_remove_file(dev, attributes + i);
		HISI_FB_ERR("%s: failed to create sysfs interface\n", __func__);
	return -ENODEV;
}

static struct btv_register_data lp8556_btv_init_cmd[]={
	{0x01,0x81},
	{0xA0,0xFF},
	{0xA1,0xBF},
	{0xA2,0x28},
	{0xA3,0x02},
	{0xA4,0x72},
	{0xA5,0x20},
	{0xA6,0x80},
	{0xA7,0xF7},
	{0xA9,0x60},
	{0xAA,0x0F},
	{0xAE,0x0E},
	{0x9E,0x22},
	{0x16,0x0F},
};

static struct btv_register_data lp8556_slope_on={
	0xA3,
	0x42,
};

static int lp8556_btv_init(void)
{
	HISI_FB_INFO("[I2C]lp8556_btv_init");

	int ret=0;
	u8 value=0;
	int length,i;
	length = sizeof(lp8556_btv_init_cmd)/sizeof(struct btv_register_data);
	for(i = 0;i<length;i++){
		ret = btv_i2c_write_u8(lp8556_btv_init_cmd[i].reg,lp8556_btv_init_cmd[i].value);
		if(ret < 0){
			HISI_FB_ERR("[ERR] :register[%d] = 0x%x,value = 0x%x.\n",i,lp8556_btv_init_cmd[i].reg, lp8556_btv_init_cmd[i].value);
			break;
		}
	}

	udelay(200);

	ret = btv_i2c_read_u8(LP8556_STATUS_REG,&value);
	HISI_FB_INFO("reg = 0x%x ,ret = %d,value = 0x%x.\n",LP8556_STATUS_REG,ret,value);

	return ret;
}


static int mipi_tianma_R63319_8p4_panel_set_fastboot(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	// lcd pinctrl normal
	pinctrl_cmds_tx(pdev, lcd_pinctrl_normal_cmds, ARRAY_SIZE(lcd_pinctrl_normal_cmds));

	// lcd gpio request
	gpio_cmds_tx(lcd_gpio_request_cmds, ARRAY_SIZE(lcd_gpio_request_cmds));

	// backlight on
	hisi_lcd_backlight_on(pdev);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return 0;
}

static int mipi_tianma_R63319_8p4_panel_on(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;
	struct hisi_panel_info *pinfo = NULL;
	char __iomem *mipi_dsi0_base = NULL;
	char __iomem *mipi_dsi1_base = NULL;
	char __iomem *dpp_base = NULL;
	char __iomem *acm_base = NULL;


#if defined (CONFIG_HUAWEI_DSM)
	static struct lcd_reg_read_t lcd_status_reg[] = {
		{0x0A, 0x0C, 0xFF, "lcd power state"},
	};
#endif

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_INFO("fb%d, +!\n", hisifd->index);

	pinfo = &(hisifd->panel_info);
	mipi_dsi0_base = hisifd->mipi_dsi0_base;
	mipi_dsi1_base = hisifd->mipi_dsi1_base;
	dpp_base = hisifd->dss_base + DSS_DPP_OFFSET;
	acm_base = hisifd->dss_base + DSS_DPP_ACM_OFFSET;

	if (pinfo->lcd_init_step == LCD_INIT_POWER_ON) {
		HISI_FB_INFO("Init power on.\n");

		// lcd pinctrl normal
		pinctrl_cmds_tx(pdev, lcd_pinctrl_normal_cmds, ARRAY_SIZE(lcd_pinctrl_normal_cmds));

		// lcd gpio request
		gpio_cmds_tx(lcd_gpio_request_cmds, ARRAY_SIZE(lcd_gpio_request_cmds));

		// lcd gpio normal
		gpio_cmds_tx(lcd_gpio_normal_cmds, ARRAY_SIZE(lcd_gpio_normal_cmds));

		pinfo->lcd_init_step = LCD_INIT_MIPI_LP_SEND_SEQUENCE;
	} else if (pinfo->lcd_init_step == LCD_INIT_MIPI_LP_SEND_SEQUENCE) {
		HISI_FB_INFO("Init lcd_init_step is lp send mode.\n");
		lp8556_btv_init();
		mipi_dsi_cmds_tx(lcd_init_display_on_cmds_otp, ARRAY_SIZE(lcd_init_display_on_cmds_otp), mipi_dsi0_base);
		g_cabc_mode = CABC_UI_MODE;
#if defined (CONFIG_HUAWEI_DSM)
		panel_check_status_and_report_by_dsm(lcd_status_reg, ARRAY_SIZE(lcd_status_reg), mipi_dsi0_base);
#endif
		g_debug_enable = 1;
		pinfo->lcd_init_step = LCD_INIT_MIPI_HS_SEND_SEQUENCE;
	} else if (pinfo->lcd_init_step == LCD_INIT_MIPI_HS_SEND_SEQUENCE) {
		if(!runmode_is_factory()) {
			/*this project: 0 means using sRGB, 1 means using color_enhance*/
			if (g_color_enhancement_mode == COLOR_EN_DEFAULT) {
				/*open acm*/
				//set_reg(acm_base + ACM_EN, 0x1, 1, 0); //open acm
				outp32(acm_base + ACM_EN, 0x70 | 0x1);
				/*close gmp*/
				set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
			} else if (g_color_enhancement_mode == COLOR_EN_SRGB) {
				/*close acm*/
				set_reg(acm_base + ACM_EN, 0x0, 1, 0); //close acm
				/*open gmp*/
				set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x0, 1, 0);	//enable gmp
			} else if (g_color_enhancement_mode == COLOR_EN_CLOSED) {
				/*close acm*/
				set_reg(acm_base + ACM_EN, 0x0, 1, 0); //close acm
				/*close gmp*/
				set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
			} else {
				HISI_FB_DEBUG(" no this color_enhancement mode!\n");
			};
		}
		HISI_FB_INFO("Init hs send data mode.\n");
	} else {
		HISI_FB_ERR("failed to init lcd!\n");
	}

	// backlight on
	hisi_lcd_backlight_on(pdev);

	HISI_FB_INFO("fb%d, -!\n", hisifd->index);

	return 0;
}

static int mipi_tianma_R63319_8p4_panel_off(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;
	struct hisi_panel_info *pinfo = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_INFO("fb%d, +!\n", hisifd->index);

	pinfo = &(hisifd->panel_info);

	/* backlight off */
	hisi_lcd_backlight_off(pdev);
	g_debug_enable = 0;
	if (pinfo->lcd_uninit_step == LCD_UNINIT_MIPI_HS_SEND_SEQUENCE) {
		HISI_FB_INFO("display off(download display off sequence).\n");

		// lcd display off sequence
		mipi_dsi_cmds_tx(display_off_cmds, ARRAY_SIZE(display_off_cmds), hisifd->mipi_dsi0_base);

		pinfo->lcd_uninit_step = LCD_UNINIT_MIPI_LP_SEND_SEQUENCE;
	} else if (pinfo->lcd_uninit_step == LCD_UNINIT_MIPI_LP_SEND_SEQUENCE) {
		pinfo->lcd_uninit_step = LCD_UNINIT_POWER_OFF;
	} else if (pinfo->lcd_uninit_step == LCD_UNINIT_POWER_OFF) {
		HISI_FB_INFO("display off(regulator disabling).\n");

		// lcd gpio lowpower
		gpio_cmds_tx(lcd_gpio_lowpower_cmds, ARRAY_SIZE(lcd_gpio_lowpower_cmds));

		// lcd gpio free
		gpio_cmds_tx(lcd_gpio_free_cmds, ARRAY_SIZE(lcd_gpio_free_cmds));

		// lcd pinctrl lowpower
		pinctrl_cmds_tx(pdev, lcd_pinctrl_lowpower_cmds, ARRAY_SIZE(lcd_pinctrl_lowpower_cmds));

	} else {
		HISI_FB_ERR("failed to uninit lcd!\n");
	}
	HISI_FB_INFO("fb%d, -!\n", hisifd->index);

	return 0;
}

static int mipi_tianma_R63319_8p4_panel_remove(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	// lcd pinctrl finit
	pinctrl_cmds_tx(pdev, lcd_pinctrl_finit_cmds, ARRAY_SIZE(lcd_pinctrl_finit_cmds));

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return 0;
}

static int mipi_tianma_R63319_8p4_panel_set_backlight(struct platform_device *pdev, uint32_t bl_level)
{
	char __iomem *mipi_dsi0_base = NULL;
	struct hisi_fb_data_type *hisifd = NULL;
	int ret = 0;
	static char last_bl_level=0;
	char bl_level_adjust[2] = {
		0x51,
		0xFF,
	};

	struct dsi_cmd_desc lcd_bl_level_adjust[] = {
		{DTYPE_DCS_WRITE1, 0, 100, WAIT_TYPE_US, sizeof(bl_level_adjust), bl_level_adjust},
	};

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	if(2 == g_debug_enable){
		ret = btv_i2c_write_u8(lp8556_slope_on.reg,lp8556_slope_on.value);
		HISI_FB_INFO("lp8556_slope_on,g_debug_enable = %d,bl_level = %d!!!\n",g_debug_enable,bl_level);
		g_debug_enable = 3;
	}

	if (1 == g_debug_enable) {
		HISI_FB_INFO("Power on, First set brightness to %d\n", bl_level);
		g_debug_enable = 2;
	}

	HISI_FB_INFO("set brightness to %d\n", bl_level);

	if (!bl_level) {
		HISI_FB_INFO("Set backlight to 0 !!!\n");
	}

	if (hisifd->panel_info.bl_set_type & BL_SET_BY_PWM) {
		ret = hisi_pwm_set_backlight(hisifd, bl_level);
	} else if (hisifd->panel_info.bl_set_type & BL_SET_BY_BLPWM) {
		ret = hisi_blpwm_set_backlight(hisifd, bl_level);
	} else if (hisifd->panel_info.bl_set_type & BL_SET_BY_MIPI) {
		mipi_dsi0_base = hisifd->mipi_dsi0_base;

		bl_level_adjust[1] = bl_level * 255 / hisifd->panel_info.bl_max;
		if (last_bl_level != bl_level_adjust[1]){
			last_bl_level = bl_level_adjust[1];
			mipi_dsi_cmds_tx(lcd_bl_level_adjust, ARRAY_SIZE(lcd_bl_level_adjust), mipi_dsi0_base);
		}
	} else {
		HISI_FB_ERR("No such bl_set_type!\n");
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}


/******************************************************************************/
static ssize_t mipi_tianma_R63319_8p4_panel_model_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == buf) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}


	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	if(runmode_is_factory()) {
		ret = snprintf(buf, PAGE_SIZE, "tianma_R63319_8p4 8.4' VIDEO TFT\n");
	} else {
		ret = snprintf(buf, PAGE_SIZE, "8p4 8.4' VIDEO TFT\n");
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_tianma_R63319_8p4_panel_info_show(struct platform_device *pdev, char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == buf) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	if (NULL == pdev) {
		HISI_FB_ERR("pdev NULL pointer\n");
		return 0;
	};
	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("hisifd NULL pointer\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);
	if (buf) {
		ret = snprintf(buf, PAGE_SIZE, "blmax:%u,blmin:%u,lcdtype:%s\n",
				hisifd->panel_info.bl_max, hisifd->panel_info.bl_min, "LCD");
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_tianma_panel_support_mode_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return ret;
	}

	hisifd = platform_get_drvdata(pdev);
	if (!hisifd) {
		HISI_FB_ERR("hisifd is null\n");
		return ret;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_support_mode);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_tianma_panel_support_mode_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	unsigned long val = 0;
	int flag = -1;
	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return ret;
	}

	hisifd = platform_get_drvdata(pdev);
	if (!hisifd) {
		HISI_FB_ERR("hisifd is null\n");
		return ret;
	}

	ret = strict_strtoul(buf, 0, &val);
	if (ret)
               return ret;

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	flag = (int)val;

	g_support_mode = flag;

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return count;
}

static ssize_t mipi_tm_panel_lcd_cabc_mode_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == buf) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_cabc_mode);
	return ret;
}

static ssize_t mipi_tm_panel_lcd_cabc_mode_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	ssize_t ret_return = 0;
	unsigned long val = 0;
	int flag=-1;
	struct hisi_fb_data_type *hisifd = NULL;
	char __iomem *mipi_dsi0_base = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer\n");
		return -EINVAL;
	}
	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer\n");
		return -EINVAL;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	if (NULL == hisifd->mipi_dsi0_base) {
		HISI_FB_ERR("NULL Pointer\n");
		return -EINVAL;
	}
	mipi_dsi0_base =hisifd->mipi_dsi0_base;

	ret = strict_strtoul(buf, 0, &val);
	if (ret)
		return ret;

	flag=(int)val;
	if (flag==CABC_OFF ){
		g_cabc_mode=0;
		mipi_dsi_cmds_tx(tm_cabc_off_cmds, ARRAY_SIZE(tm_cabc_off_cmds),mipi_dsi0_base);
	}else  if (flag==CABC_UI_MODE) {
		g_cabc_mode=1;
		mipi_dsi_cmds_tx(tm_cabc_ui_on_cmds, ARRAY_SIZE(tm_cabc_ui_on_cmds),mipi_dsi0_base);
	} else if (flag==CABC_STILL_MODE ){
		g_cabc_mode=2;
		mipi_dsi_cmds_tx(tm_cabc_still_on_cmds, ARRAY_SIZE(tm_cabc_still_on_cmds),mipi_dsi0_base);
	}else if (flag==CABC_MOVING_MODE ){
		g_cabc_mode=3;
		mipi_dsi_cmds_tx(tm_cabc_moving_on_cmds, ARRAY_SIZE(tm_cabc_moving_on_cmds),mipi_dsi0_base);
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	ret_return = snprintf((char *)buf, PAGE_SIZE, "%d\n", g_cabc_mode);
	return ret_return;
}


/*because of  architecture limitation,  just use this sys node to control acm and gmp */
static ssize_t mipi_tianma_panel_lcd_ic_color_enhancement_mode_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	BUG_ON(pdev == NULL);
	hisifd = platform_get_drvdata(pdev);
	BUG_ON(hisifd == NULL);

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);



	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_color_enhancement_mode);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_tianma_panel_lcd_ic_color_enhancement_mode_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	unsigned long val = 0;
	int flag=-1;
	struct hisi_fb_data_type *hisifd = NULL;
	char __iomem *dpp_base = NULL;
	char __iomem *acm_base = NULL;


	BUG_ON(pdev == NULL);
	hisifd = platform_get_drvdata(pdev);
	BUG_ON(hisifd == NULL);
	dpp_base = hisifd->dss_base + DSS_DPP_OFFSET;
	acm_base = hisifd->dss_base + DSS_DPP_ACM_OFFSET;

	ret = strict_strtoul(buf, 0, &val);
	if (ret)
        return ret;

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	flag=(int)val;

	HISI_FB_INFO("fb%d, set val = %d", hisifd->index, flag);

	/*this project: 0 means using sRGB, 1 means using color_enhance*/
	if (flag == COLOR_EN_DEFAULT) {
		/*open acm*/
		set_reg(acm_base + ACM_EN, 0x1, 1, 0); //open acm
		/*close gmp*/
		g_color_enhancement_mode = COLOR_EN_DEFAULT;
		set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
	} else if (flag == COLOR_EN_SRGB) {
		/*close acm*/
		set_reg(acm_base + ACM_EN, 0x0, 1, 0); //close acm
		/*open gmp*/
		g_color_enhancement_mode = COLOR_EN_SRGB;
		set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x0, 1, 0);	//enable gmp
	} else if (flag == COLOR_EN_CLOSED) {
		/*close acm*/
		set_reg(acm_base + ACM_EN, 0x0, 1, 0); //close acm
		/*close gmp*/
		g_color_enhancement_mode = COLOR_EN_CLOSED;
		set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
	} else {
		HISI_FB_DEBUG(" no this color_enhancement mode!\n");
	};

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return snprintf((char *)buf, count, "%d\n", g_color_enhancement_mode);
}


static struct hisi_panel_info g_panel_info = {0};
static struct hisi_fb_panel_data g_panel_data = {
	.panel_info = &g_panel_info,
	.set_fastboot = mipi_tianma_R63319_8p4_panel_set_fastboot,
	.on = mipi_tianma_R63319_8p4_panel_on,
	.off = mipi_tianma_R63319_8p4_panel_off,
	.remove = mipi_tianma_R63319_8p4_panel_remove,
	.set_backlight = mipi_tianma_R63319_8p4_panel_set_backlight,
	.lcd_model_show = mipi_tianma_R63319_8p4_panel_model_show,
	.panel_info_show = mipi_tianma_R63319_8p4_panel_info_show,
	.lcd_support_mode_show = mipi_tianma_panel_support_mode_show,
	.lcd_support_mode_store = mipi_tianma_panel_support_mode_store,
	.lcd_cabc_mode_show = mipi_tm_panel_lcd_cabc_mode_show,
	.lcd_cabc_mode_store = mipi_tm_panel_lcd_cabc_mode_store,
	.lcd_ic_color_enhancement_mode_store = mipi_tianma_panel_lcd_ic_color_enhancement_mode_store,
	.lcd_ic_color_enhancement_mode_show = mipi_tianma_panel_lcd_ic_color_enhancement_mode_show,
};
/*******************************************************************************
**
*/
static int mipi_tianma_R63319_8p4_probe(struct platform_device *pdev)
{
	int ret = 0;
	struct hisi_panel_info *pinfo = NULL;
	struct device_node *np = NULL;
	uint32_t bl_type = 0;
	uint32_t lcd_display_type = 0;
	int support_mode = 0;
	struct device *dev = &pdev->dev;
	np = of_find_compatible_node(NULL, NULL, DTS_COMP_TIANMA_R63319_8P4);
	if (!np) {
		HISI_FB_ERR("NOT FOUND device node %s!\n", DTS_COMP_TIANMA_R63319_8P4);
		goto err_return;
	}

	ret = of_property_read_u32(np, LCD_DISPLAY_TYPE_NAME, &lcd_display_type);
	if (ret) {
		HISI_FB_ERR("get lcd_display_type failed!\n");
		lcd_display_type = PANEL_DUAL_MIPI_CMD;
	}

	lcd_display_type = PANEL_DUAL_MIPI_VIDEO;

	ret = of_property_read_u32(np, LCD_BL_TYPE_NAME, &bl_type);
	if (ret) {
		HISI_FB_ERR("get lcd_bl_type failed!\n");
		bl_type = BL_SET_BY_MIPI;
	}
	HISI_FB_INFO("bl_type=0x%x.", bl_type);

	if (hisi_fb_device_probe_defer(lcd_display_type, bl_type)) {
		goto err_probe_defer;
	}

	HISI_FB_INFO("%s\n", DTS_COMP_TIANMA_R63319_8P4);

	//gpio_lcd_1v8_enable, gpio_lcd_reset, gpio_lcd_vsp_enable, gpio_lcd_vsp_enable, gpio_lcd_bl_enable
	//gpios = <&gpio1 4 0>, <&gpio2 4 0>,  <&gpio3 7 0>, <&gpio4 0 0>, <&gpio6 4 0>;
	//gpio_1_4   12
	gpio_lcd_vcc1v8_enable = of_get_named_gpio(np, "gpios", 0);

	//gpio_2_4   20
	gpio_lcd_reset = of_get_named_gpio(np, "gpios", 1);

	//gpio_3_7   31
	gpio_lcd_p5v5_enable = of_get_named_gpio(np, "gpios", 2);

	//gpio_4_0   32
	gpio_lcd_n5v5_enable = of_get_named_gpio(np, "gpios", 3);

	//gpio_6_4   52
	gpio_lcd_bl_enable = of_get_named_gpio(np, "gpios", 4);
	//gpio_1_1   9
	gpio_lcd_g_bl_enable = of_get_named_gpio(np, "gpios", 5);

	HISI_FB_INFO("gpio_lcd_vcc1v8_enable = %d, gpio_lcd_reset = %d, gpio_lcd_p5v5_enable = %d, gpio_lcd_n5v5_enable = %d, gpio_lcd_bl_enable = %d, gpio_lcd_g_bl_enable = %d\n", \
			gpio_lcd_vcc1v8_enable, gpio_lcd_reset, gpio_lcd_p5v5_enable, gpio_lcd_n5v5_enable, gpio_lcd_bl_enable, gpio_lcd_g_bl_enable);

	pdev->id = 1;
	/* init panel info */
	pinfo = g_panel_data.panel_info;
	memset(pinfo, 0, sizeof(struct hisi_panel_info));
	pinfo->xres = 1600;
	pinfo->yres = 2560;
	pinfo->width = 113;
	pinfo->height = 181;
	pinfo->orientation = LCD_PORTRAIT;
	pinfo->bpp = LCD_RGB888;
	pinfo->bgr_fmt = LCD_RGB;
	pinfo->bl_set_type = bl_type; //BL_SET_BY_MIPI;
	if (pinfo->bl_set_type == BL_SET_BY_BLPWM)
		pinfo->blpwm_input_ena = 1;


#ifdef CONFIG_BACKLIGHT_10000
	pinfo->bl_min = 157;
	pinfo->bl_max = 9960;
	pinfo->bl_default = 4000;
	pinfo->blpwm_precision_type = BLPWM_PRECISION_10000_TYPE;
	pinfo->blpwm_out_div_value = 7;//(18K/(7+1) = 2.25K)
#else
	pinfo->bl_min = 4;
	pinfo->bl_max = 255;
	pinfo->bl_default = 102;
#endif

	pinfo->vsync_ctrl_type = 0;// (VSYNC_CTRL_ISR_OFF | VSYNC_CTRL_MIPI_ULPS);

	pinfo->type = lcd_display_type;
	pinfo->frc_enable = 0;
	pinfo->esd_enable = 0;
	pinfo->dirty_region_updt_support = 0;

	/* prefix ce & sharpness */
	pinfo->prefix_ce_support = 0;
	pinfo->prefix_sharpness1D_support = 0;
	pinfo->prefix_sharpness2D_support = 0;
	
	pinfo->color_temperature_support = 1;
	pinfo->comform_mode_support = 1;

	pinfo->lcd_uninit_step_support = 1;
	pinfo->mipi.max_tx_esc_clk = 10 * 1000000;

	//sbl
	pinfo->sbl_support = 1;
	pinfo->smart_bl.strength_limit = 128;
	pinfo->smart_bl.calibration_a = 60;
	pinfo->smart_bl.calibration_b = 95;
	pinfo->smart_bl.calibration_c = 5;
	pinfo->smart_bl.calibration_d = 1;
	pinfo->smart_bl.t_filter_control = 5;
	pinfo->smart_bl.backlight_min = 480;
	pinfo->smart_bl.backlight_max = 4096;
	pinfo->smart_bl.backlight_scale = 0xff;
	pinfo->smart_bl.ambient_light_min = 14;
	pinfo->smart_bl.filter_a = 1738;
	pinfo->smart_bl.filter_b = 6;
	pinfo->smart_bl.logo_left = 0;
	pinfo->smart_bl.logo_top = 0;
	pinfo->smart_bl.variance_intensity_space = 145;
	pinfo->smart_bl.slope_max = 54;
	pinfo->smart_bl.slope_min = 160;

	//ACM
	pinfo->acm_support = 1;
	if (pinfo->acm_support == 1) {
		pinfo->acm_lut_hue_table = acm_lut_hue_table;
		pinfo->acm_lut_hue_table_len = ARRAY_SIZE(acm_lut_hue_table);
		pinfo->acm_lut_sata_table = acm_lut_sata_table;
		pinfo->acm_lut_sata_table_len = ARRAY_SIZE(acm_lut_sata_table);
		pinfo->acm_lut_satr_table = acm_lut_satr_table;
		pinfo->acm_lut_satr_table_len = ARRAY_SIZE(acm_lut_satr_table);
		pinfo->acm_valid_num = 7;
		pinfo->r0_hh = 0x7f;
		pinfo->r0_lh = 0x0;
		pinfo->r1_hh = 0xff;
		pinfo->r1_lh = 0x80;
		pinfo->r2_hh = 0x17f;
		pinfo->r2_lh = 0x100;
		pinfo->r3_hh = 0x1ff;
		pinfo->r3_lh = 0x180;
		pinfo->r4_hh = 0x27f;
		pinfo->r4_lh = 0x200;
		pinfo->r5_hh = 0x2ff;
		pinfo->r5_lh = 0x280;
		pinfo->r6_hh = 0x37f;
		pinfo->r6_lh = 0x300;

		/*for cinema mode */
		pinfo->cinema_acm_valid_num = 7;
		pinfo->cinema_r0_hh = 0x7f;
		pinfo->cinema_r0_lh = 0x0;
		pinfo->cinema_r1_hh = 0xff;
		pinfo->cinema_r1_lh = 0x80;
		pinfo->cinema_r2_hh = 0x17f;
		pinfo->cinema_r2_lh = 0x100;
		pinfo->cinema_r3_hh = 0x1ff;
		pinfo->cinema_r3_lh = 0x180;
		pinfo->cinema_r4_hh = 0x27f;
		pinfo->cinema_r4_lh = 0x200;
		pinfo->cinema_r5_hh = 0x2ff;
		pinfo->cinema_r5_lh = 0x280;
		pinfo->cinema_r6_hh = 0x37f;
		pinfo->cinema_r6_lh = 0x300;

		//ACM_CE
		//pinfo->acm_ce_support = 1;
	}

	//Gama LCP
	pinfo->gamma_support = 1;
	if (pinfo->gamma_support == 1) {
		pinfo->gamma_lut_table_R = gamma_lut_table_R;
		pinfo->gamma_lut_table_G = gamma_lut_table_G;
		pinfo->gamma_lut_table_B = gamma_lut_table_B;
		pinfo->gamma_lut_table_len = ARRAY_SIZE(gamma_lut_table_R);
		pinfo->igm_lut_table_R = igm_lut_table_R;
		pinfo->igm_lut_table_G = igm_lut_table_G;
		pinfo->igm_lut_table_B = igm_lut_table_B;
		pinfo->igm_lut_table_len = ARRAY_SIZE(igm_lut_table_R);

		pinfo->gmp_support = 1;
		pinfo->gmp_lut_table_low32bit = &gmp_lut_table_low32bit[0][0][0];
		pinfo->gmp_lut_table_high4bit = &gmp_lut_table_high4bit[0][0][0];
		pinfo->gmp_lut_table_len = ARRAY_SIZE(gmp_lut_table_low32bit);

		pinfo->xcc_support = 1;
		pinfo->xcc_table = xcc_table;
		pinfo->xcc_table_len = ARRAY_SIZE(xcc_table);
	}

	pinfo->ifbc_type = IFBC_TYPE_NONE;

	pinfo->ldi.h_back_porch = 110;
	pinfo->ldi.h_front_porch = 300;
	pinfo->ldi.h_pulse_width = 48;
	pinfo->ldi.v_back_porch = 26;
	pinfo->ldi.v_front_porch =14;
	pinfo->ldi.v_pulse_width = 5;

	pinfo->mipi.lane_nums = DSI_4_LANES;
	pinfo->mipi.color_mode = DSI_24BITS_1;
	pinfo->mipi.vc = 0;
	pinfo->mipi.dsi_bit_clk = 475;
	pinfo->dsi_bit_clk_upt_support = 0;
	pinfo->mipi.dsi_bit_clk_upt = pinfo->mipi.dsi_bit_clk;
	pinfo->mipi.dsi_bit_clk_val1 = 471;
	pinfo->mipi.dsi_bit_clk_val2 = 475;
	pinfo->mipi.dsi_bit_clk_val3 = 480;
	pinfo->mipi.dsi_bit_clk_val4 = 493;
	pinfo->mipi.dsi_bit_clk_val5 = 500;

	pinfo->mipi.non_continue_en = 0;
	pinfo->pxl_clk_rate = 1568*2*100000UL;
	pinfo->pxl_clk_rate_adjust = 320 * 1000000UL;

	pinfo->mipi.burst_mode = DSI_BURST_SYNC_PULSES_1;

	//is dual_mipi or single_mipi
	if (is_dual_mipi_panel_ext(pinfo))  {
		pinfo->ifbc_type = IFBC_TYPE_NONE;
		pinfo->pxl_clk_rate_div = 2;
		HISI_FB_INFO("PANEL_DUAL_MIPI: 8 lane \n");
	} else {
		//pinfo->ifbc_type = IFBC_TYPE_NONE;
		pinfo->pxl_clk_rate_div = 1;
		HISI_FB_INFO("PANEL_SINGLE_MIPI: 4 lane \n");
	}

	if (pinfo->pxl_clk_rate_div > 1) {
		pinfo->ldi.h_back_porch /= pinfo->pxl_clk_rate_div;
		pinfo->ldi.h_front_porch /= pinfo->pxl_clk_rate_div;
		pinfo->ldi.h_pulse_width /= pinfo->pxl_clk_rate_div;
	}
	
	if(pinfo->comform_mode_support == 1){
		support_mode = (support_mode | 1);
	}
	/*use  lcd_ic_color_enhancement_mode node, not use lcd_acm_state node*/
	support_mode = (support_mode | 4);
	g_support_mode =   support_mode;

	// lcd vcc init
	ret = vcc_cmds_tx(pdev, lcd_vcc_init_cmds,
		ARRAY_SIZE(lcd_vcc_init_cmds));
	vcc_cmds_tx(pdev, lcd_vcc_enable_cmds,
		ARRAY_SIZE(lcd_vcc_enable_cmds));
	if(runmode_is_factory()) {
		HISI_FB_INFO("Factory mode, disable features: dirty update etc.\n");
		pinfo->dirty_region_updt_support = 0;
		pinfo->sbl_support = 0;
		pinfo->acm_support = 0;
		pinfo->acm_ce_support = 0;
		pinfo->esd_enable = 0;
		pinfo->blpwm_input_ena = 0;
		pinfo->blpwm_precision_type = BLPWM_PRECISION_DEFAULT_TYPE;
		pinfo->bl_min = 4;
		pinfo->bl_max = 255;
		pinfo->comform_mode_support = 0;
	}

	// lcd pinctrl init
	ret = pinctrl_cmds_tx(pdev, lcd_pinctrl_init_cmds,
		ARRAY_SIZE(lcd_pinctrl_init_cmds));
	if (ret != 0) {
		HISI_FB_ERR("Init pinctrl failed, defer\n");
		goto err_return;
	}

	// alloc panel device data
	ret = platform_device_add_data(pdev, &g_panel_data,
		sizeof(struct hisi_fb_panel_data));
	if (ret) {
		HISI_FB_ERR("platform_device_add_data failed!\n");
		goto err_device_put;
	}

	hisi_fb_add_device(pdev);
	add_sysfs_interfaces(dev);

	HISI_FB_DEBUG("-.\n");

	return 0;

err_device_put:
	platform_device_put(pdev);
err_return:
	return ret;
err_probe_defer:
	return -EPROBE_DEFER;

	return ret;
}

static int btv_i2c_probe(struct i2c_client *client,
	const struct i2c_device_id *i2c_id)
{
	HISI_FB_INFO("[I2C]btv_i2c_probe");
	struct device_node *np = NULL;
	int ret = 0;

	if (!i2c_check_functionality(client->adapter, I2C_FUNC_I2C)) {
		HISI_FB_ERR("%s: I2C functionality not Supported.\n", __func__);
		return -EIO;
	}

	np = of_find_compatible_node(NULL, NULL, BTV_DEV_NAME);
	if (!np) {
		HISI_FB_ERR("NOT FOUND device node %s!\n", BTV_DEV_NAME);
		ret = -1;
		goto err_return;
	}
	g_sony_client = client;

err_return:

	return ret;
}


static const struct of_device_id hisi_panel_match_table[] = {
	{
		.compatible = DTS_COMP_TIANMA_R63319_8P4,
		.data = NULL,
	},
	{},
};
MODULE_DEVICE_TABLE(of, hisi_panel_match_table);

static struct platform_driver this_driver = {
	.probe = mipi_tianma_R63319_8p4_probe,
	.remove = NULL,
	.suspend = NULL,
	.resume = NULL,
	.shutdown = NULL,
	.driver = {
		.name = "mipi_tianma_R63319_8p4",
		.owner = THIS_MODULE,
		.of_match_table = of_match_ptr(hisi_panel_match_table),
	},
};


#define BTV_I2C_NAME "btv_i2c_lp8556"
static const struct i2c_device_id btv_i2c_id[] = {
	{ BTV_I2C_NAME, 0, },
	{ }
};

static struct of_device_id btv_i2c_of_match[] = {
	{ .compatible = "lp8556,btv_i2c_adapter", },
	{ }
};
MODULE_DEVICE_TABLE(of, btv_i2c_of_match);

static struct i2c_driver btv_i2c_driver = {
	.driver = {
		.name = BTV_I2C_NAME,
		.owner = THIS_MODULE,
		.of_match_table = btv_i2c_of_match,
	},
	.probe = btv_i2c_probe,
	.id_table = btv_i2c_id,
};

static int __init mipi_tianma_R63319_8p4_panel_init(void)
{
	int ret = 0;

	ret = platform_driver_register(&this_driver);
	if (ret) {
		HISI_FB_ERR("platform_driver_register failed, error=%d!\n", ret);
		return ret;
	}

	ret = i2c_add_driver(&btv_i2c_driver);
	if (ret) {
		HISI_FB_ERR("btv I2C Driver add fail, rc = %d.\n",ret);
	}

	return ret;
}

module_init(mipi_tianma_R63319_8p4_panel_init);



