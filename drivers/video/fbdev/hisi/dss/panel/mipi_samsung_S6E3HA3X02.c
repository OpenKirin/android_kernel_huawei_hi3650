/* Copyright (c) 2008-2014, Hisilicon Tech. Co., Ltd. All rights reserved.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License version 2 and
* only version 2 as published by the Free Software Foundation.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the
* GNU General Public License for more details.
*
*/

#include "hisi_fb.h"
#if LINUX_VERSION_CODE >= KERNEL_VERSION(4,1,0)
#include <linux/hisi/hisi_adc.h>
#else
#include <linux/huawei/hisi_adc.h>
#endif
#include <huawei_platform/touthscreen/huawei_touchscreen.h>
#include <huawei_platform/log/log_jank.h>
#include <linux/hisi/hw_cmdline_parse.h>

#define DTS_COMP_SAMSUNG_S6E3HA3X02 "hisilicon,mipi_samsung_S6E3HA3X02"
#define LCD_VDDIO_TYPE_NAME	"lcd-vddio-type"
static struct hisi_fb_panel_data g_panel_data;
static bool g_debug_enable = false;
static int g_hbm_ctrl = 0;
static int g_acl_ctrl = 2;





#define AMOLED_CHECK_INT

#ifdef CONFIG_HUAWEI_TS
#define TP_RS_CALL 1
extern bool g_lcd_control_tp_power;
#endif

enum {
	HBM_DEBUG = 0,
	HBM_SETTING = 1,
};
enum {
	HBM_OFF = 0,
	HBM_ON = 1,
};

enum {
	ACL_DEBUG = 0,
	ACL_SETTING = 1,
};
enum {
	ACL_OFF = 0,
	ACL_OFFSET1_ON = 1,
	ACL_OFFSET2_ON = 2,
	ACL_OFFSET3_ON = 3,
};

enum {
    COLOR_EN_SRGB = 0,  /*edison when close color_enhance, need open gmp*/
    COLOR_EN_DEFAULT = 1, /*edison when open color_enhance, need close gmp*/
    COLOR_EN_CLOSED = 2,  /*when close all, close gmp*/
};

static int g_color_enhancement_mode = COLOR_EN_DEFAULT;


/*******************************************************************************
** Power ON Sequence(sleep mode to Normal mode)
*/
static char exit_sleep[] = {
	0x11,
};

static char test_key_enable[] = {
	0xF0,
	0x5A,0x5A,
};

static char dual_control_C4[] = {
	0xC4, 0x03,
};

static char esd_refresh_setting[] = {
	0xF6,
	0x44, 0x57, 0x37, 0x00, 0xAA, 0xCC, 0xD0, 0x00, 0x00,
};

static char esd_refresh_setting1[] = {
	0x12,
};

static char dual_control_F9[] = {
	0xF9, 0x03,
};

static char pentile_setting[] = {
	0xC2,
	0x00, 0x08, 0xD8, 0xD8, 0x00, 0x80, 0x2B, 0x05, 0x08, 0x0E, 0x07, 0x0B, 0x05, 0x0D, 0x0A, 0x15, 0x13, 0x20, 0x1E,
};

static char setting_pcd[] = {
	0xCC,
	0x5C, 0x51,
};

static char setting_errflag_mipi_err[] = {
	0xED,
	0x44,
};

static char test_key_disable[] = {
	0xF0,
	0xA5,0xA5,
};

static char tear_on[] = {
	0x35, 0x00,
};

/* 0x36 command means " RED color ¡ú Blue color, Blue color ¡ú RED color "*/
static char reg_36[] = {
	0x36, 0x00,
};

/* brightness contrl */
static char bl_enable[] = {
	0x53,
	0x20,
};

static char bl_level[] = {
	0x51,
	0x00,
};

/*
Power Saving Function Control Mode
0 = ACL off
1 = ACL on(ACL_OFF_MAX_1)
2 = ACL on(ACL_OFF_MAX_2)
3 = ACL on(ACL_OFF_MAX_3)
*/
static char acl_mode[] = {
	0x55, 0x02,
};

static char memory_access[] = {
	0x2C,
};

static char display_on[] = {
	0x29,
};

/*******************************************************************************
** Power OFF Sequence(Normal to power off)
*/
static char display_off[] = {
	0x28,
};

static char enter_sleep[] = {
	0x10,
};

static struct dsi_cmd_desc display_on_cmds[] = {
	{DTYPE_DCS_WRITE, 0, 6, WAIT_TYPE_MS,
		sizeof(exit_sleep), exit_sleep},

	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(test_key_enable), test_key_enable},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(dual_control_C4), dual_control_C4},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(dual_control_F9), dual_control_F9},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(esd_refresh_setting), esd_refresh_setting},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(pentile_setting), pentile_setting},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(reg_36), reg_36},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(setting_pcd), setting_pcd},
	{DTYPE_DCS_WRITE1, 0, 200, WAIT_TYPE_US,
		sizeof(setting_errflag_mipi_err), setting_errflag_mipi_err},
	{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
		sizeof(test_key_disable), test_key_disable},
	{DTYPE_GEN_LWRITE, 0, 125, WAIT_TYPE_MS,
		sizeof(esd_refresh_setting1), esd_refresh_setting1},

	{DTYPE_GEN_LWRITE, 0, 120, WAIT_TYPE_US,
		sizeof(tear_on), tear_on},
	{DTYPE_GEN_LWRITE, 0, 120, WAIT_TYPE_US,
		sizeof(bl_enable), bl_enable},
	{DTYPE_DCS_WRITE1, 0, 120, WAIT_TYPE_US,
		sizeof(bl_level), bl_level},
	{DTYPE_GEN_LWRITE, 0, 120, WAIT_TYPE_US,
		sizeof(acl_mode), acl_mode},
	{DTYPE_GEN_LWRITE, 0, 120, WAIT_TYPE_US,
		sizeof(memory_access), memory_access},

	{DTYPE_DCS_WRITE, 0, 10, WAIT_TYPE_MS,
		sizeof(display_on), display_on},
};

static struct dsi_cmd_desc display_off_cmds[] = {
	{DTYPE_DCS_WRITE, 0, 200, WAIT_TYPE_US,
		sizeof(display_off), display_off},
	{DTYPE_DCS_WRITE, 0, 150, WAIT_TYPE_MS,
		sizeof(enter_sleep), enter_sleep}
};

/*******************************************************************************
** LCD VCC
*/
#define VCC_LCDANALOG_NAME	"lcdanalog-vcc"

static struct regulator *vcc_lcdanalog;

static struct vcc_desc lcd_vcc_init_cmds[] = {
	/* vcc get */
	{DTYPE_VCC_GET, VCC_LCDANALOG_NAME, &vcc_lcdanalog, 0, 0, WAIT_TYPE_MS, 0},

	/* vcc set voltage */
	{DTYPE_VCC_SET_VOLTAGE, VCC_LCDANALOG_NAME, &vcc_lcdanalog, 3300000, 3300000, WAIT_TYPE_MS, 0},
};

static struct vcc_desc lcd_vcc_finit_cmds[] = {
	/* vcc put */
	{DTYPE_VCC_PUT, VCC_LCDANALOG_NAME, &vcc_lcdanalog, 0, 0, WAIT_TYPE_MS, 0},
};

static struct vcc_desc lcd_vcc_enable_cmds[] = {
	/* vcc enable */
	{DTYPE_VCC_ENABLE, VCC_LCDANALOG_NAME, &vcc_lcdanalog, 0, 0, WAIT_TYPE_MS, 1},
};

static struct vcc_desc lcd_vcc_disable_cmds[] = {
	/* vcc disable */
	{DTYPE_VCC_DISABLE, VCC_LCDANALOG_NAME, &vcc_lcdanalog, 0, 0, WAIT_TYPE_MS, 3},
};

/*******************************************************************************
** LCD IOMUX
*/
static struct pinctrl_data pctrl;

static struct pinctrl_cmd_desc lcd_pinctrl_init_cmds[] = {
	{DTYPE_PINCTRL_GET, &pctrl, 0},
	{DTYPE_PINCTRL_STATE_GET, &pctrl, DTYPE_PINCTRL_STATE_DEFAULT},
	{DTYPE_PINCTRL_STATE_GET, &pctrl, DTYPE_PINCTRL_STATE_IDLE},
};

static struct pinctrl_cmd_desc lcd_pinctrl_normal_cmds[] = {
	{DTYPE_PINCTRL_SET, &pctrl, DTYPE_PINCTRL_STATE_DEFAULT},
};

static struct pinctrl_cmd_desc lcd_pinctrl_lowpower_cmds[] = {
	{DTYPE_PINCTRL_SET, &pctrl, DTYPE_PINCTRL_STATE_IDLE},
};

static struct pinctrl_cmd_desc lcd_pinctrl_finit_cmds[] = {
	{DTYPE_PINCTRL_PUT, &pctrl, 0},
};

/*******************************************************************************
** LCD GPIO
*/
#define GPIO_LCD_1V8_EN_NAME   "gpio_lcd_1v8_en"
#define GPIO_LCD_RESET_NAME	"gpio_lcd_reset"
#define GPIO_LCD_ID0_NAME	       "gpio_lcd_id0"
#define GPIO_LCD_PCD_NAME	"gpio_lcd_pcd"
#define GPIO_LCD_ERR_FLAG_NAME "gpio_lcd_errflag"

static uint32_t gpio_lcd_1v8_en;
static uint32_t gpio_lcd_reset;
static uint32_t gpio_lcd_id0;
static uint32_t gpio_lcd_pcd;
static uint32_t gpio_lcd_err_flag;

static struct gpio_desc lcd_gpio_request_cmds[] = {
	/*pcd*/
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_PCD_NAME, &gpio_lcd_pcd, 0},
	/*err flag*/
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_ERR_FLAG_NAME, &gpio_lcd_err_flag, 0},
	/*vdd 1.8v*/
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_1V8_EN_NAME, &gpio_lcd_1v8_en, 0},
	/* reset */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	/* id0 */
	{DTYPE_GPIO_REQUEST, WAIT_TYPE_MS, 0,
		GPIO_LCD_ID0_NAME, &gpio_lcd_id0, 0},
};

static struct gpio_desc lcd_gpio_free_cmds[] = {
	/*vdd 1.8v*/
	{DTYPE_GPIO_FREE, WAIT_TYPE_MS, 0,
		GPIO_LCD_1V8_EN_NAME, &gpio_lcd_1v8_en, 0},
	/* reset */
	{DTYPE_GPIO_FREE, WAIT_TYPE_MS, 0,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	/* id */
	{DTYPE_GPIO_FREE, WAIT_TYPE_MS, 0,
		GPIO_LCD_ID0_NAME, &gpio_lcd_id0, 0},
	/*pcd*/
	{DTYPE_GPIO_FREE, WAIT_TYPE_MS, 0,
		GPIO_LCD_PCD_NAME, &gpio_lcd_pcd, 0},
	/*err flag*/
	{DTYPE_GPIO_FREE, WAIT_TYPE_MS, 0,
		GPIO_LCD_ERR_FLAG_NAME, &gpio_lcd_err_flag, 0},
};

static struct gpio_desc lcd_gpio_normal_cmds[] = {
	/*vdd 1.8v*/
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_1V8_EN_NAME, &gpio_lcd_1v8_en, 1},
	/* id */
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_ID0_NAME, &gpio_lcd_id0, 0},
	/*pcd*/
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_PCD_NAME, &gpio_lcd_pcd, 0},
	/*err flag*/
	{DTYPE_GPIO_INPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_ERR_FLAG_NAME, &gpio_lcd_err_flag, 0},
};

static struct gpio_desc lcd_gpio_reset_cmds[] = {
	/* reset */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 6,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 1},
};

static struct gpio_desc lcd_gpio_reset_high_cmds[] = {
	/* reset */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 1,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 1},
};

static struct gpio_desc lcd_gpio_lowpower_reset_cmds[] = {
	/* reset */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 3,
		GPIO_LCD_RESET_NAME, &gpio_lcd_reset, 0},
};

static struct gpio_desc lcd_gpio_lowpower_1V8_cmds[] = {
	/* 1.8V */
	{DTYPE_GPIO_OUTPUT, WAIT_TYPE_MS, 3,
		GPIO_LCD_RESET_NAME, &gpio_lcd_1v8_en, 0},
};

/*******************************************************************************
** ACM
*/
	static u32 srgb_acm_lut_hue_table[] = {
		0x0000, 0x0001, 0x0002, 0x0002, 0x0003, 0x0004, 0x0005, 0x0005, 0x0006, 0x0007, 0x0008, 0x0008, 0x0009, 0x000a, 0x000b, 0x000b,
		0x000c, 0x000d, 0x000e, 0x000e, 0x000f, 0x0010, 0x0011, 0x0012, 0x0013, 0x0013, 0x0014, 0x0015, 0x0016, 0x0017, 0x0018, 0x0019,
		0x001a, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f, 0x0020, 0x0020, 0x0021, 0x0022, 0x0023, 0x0024, 0x0025, 0x0026, 0x0026,
		0x0027, 0x0028, 0x0029, 0x002a, 0x002b, 0x002c, 0x002c, 0x002d, 0x002e, 0x002f, 0x0030, 0x0031, 0x0032, 0x0032, 0x0033, 0x0034,
		0x0035, 0x0036, 0x0037, 0x0038, 0x0039, 0x003a, 0x003b, 0x003c, 0x003d, 0x003e, 0x003f, 0x0040, 0x0041, 0x0042, 0x0043, 0x0044,
		0x0045, 0x0046, 0x0047, 0x0048, 0x0049, 0x004a, 0x004b, 0x004c, 0x004d, 0x004e, 0x004f, 0x0050, 0x0051, 0x0052, 0x0053, 0x0054,
		0x0055, 0x0056, 0x0057, 0x0058, 0x0059, 0x005a, 0x005b, 0x005c, 0x005d, 0x005e, 0x005f, 0x0060, 0x0061, 0x0062, 0x0063, 0x0064,
		0x0065, 0x0066, 0x0067, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x006f, 0x0070, 0x0071, 0x0072, 0x0073, 0x0074, 0x0075,
		0x0076, 0x0077, 0x0078, 0x0079, 0x007a, 0x007b, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086,
		0x0087, 0x0088, 0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0093, 0x0094, 0x0095, 0x0096, 0x0097,
		0x0098, 0x0099, 0x009a, 0x009b, 0x009c, 0x009d, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a4, 0x00a5, 0x00a7, 0x00a8, 0x00a9,
		0x00ab, 0x00ac, 0x00ad, 0x00af, 0x00b0, 0x00b1, 0x00b3, 0x00b4, 0x00b5, 0x00b7, 0x00b8, 0x00b9, 0x00bb, 0x00bc, 0x00bd, 0x00bf,
		0x00c0, 0x00c1, 0x00c2, 0x00c3, 0x00c4, 0x00c5, 0x00c6, 0x00c7, 0x00c8, 0x00c9, 0x00ca, 0x00cb, 0x00cc, 0x00cd, 0x00ce, 0x00cf,
		0x00d0, 0x00d1, 0x00d2, 0x00d3, 0x00d4, 0x00d5, 0x00d6, 0x00d7, 0x00d8, 0x00d9, 0x00da, 0x00db, 0x00dc, 0x00dd, 0x00de, 0x00df,
		0x00e0, 0x00e1, 0x00e2, 0x00e3, 0x00e4, 0x00e5, 0x00e6, 0x00e7, 0x00e8, 0x00e9, 0x00ea, 0x00eb, 0x00ec, 0x00ed, 0x00ee, 0x00ef,
		0x00f0, 0x00f1, 0x00f2, 0x00f3, 0x00f4, 0x00f5, 0x00f6, 0x00f7, 0x00f8, 0x00f9, 0x00fa, 0x00fb, 0x00fc, 0x00fd, 0x00fe, 0x00ff,
		0x0100, 0x0101, 0x0102, 0x0103, 0x0104, 0x0105, 0x0106, 0x0107, 0x0108, 0x0109, 0x010a, 0x010b, 0x010c, 0x010d, 0x010e, 0x010f,
		0x0110, 0x0111, 0x0112, 0x0113, 0x0114, 0x0115, 0x0116, 0x0117, 0x0118, 0x0119, 0x011a, 0x011b, 0x011c, 0x011d, 0x011e, 0x011f,
		0x0120, 0x0121, 0x0122, 0x0123, 0x0124, 0x0125, 0x0126, 0x0127, 0x0128, 0x0129, 0x012a, 0x012b, 0x012c, 0x012d, 0x012e, 0x012f,
		0x0130, 0x0131, 0x0132, 0x0133, 0x0134, 0x0135, 0x0136, 0x0137, 0x0138, 0x0139, 0x013a, 0x013b, 0x013c, 0x013d, 0x013e, 0x013f,
		0x0140, 0x0141, 0x0142, 0x0143, 0x0144, 0x0145, 0x0146, 0x0147, 0x0148, 0x0149, 0x014a, 0x014b, 0x014c, 0x014d, 0x014e, 0x014f,
		0x0150, 0x0151, 0x0152, 0x0153, 0x0154, 0x0155, 0x0156, 0x0157, 0x0158, 0x0159, 0x015a, 0x015b, 0x015c, 0x015d, 0x015e, 0x015f,
		0x0160, 0x0161, 0x0162, 0x0163, 0x0164, 0x0165, 0x0166, 0x0167, 0x0168, 0x0169, 0x016a, 0x016b, 0x016c, 0x016d, 0x016e, 0x016f,
		0x0170, 0x0171, 0x0172, 0x0173, 0x0174, 0x0175, 0x0176, 0x0177, 0x0178, 0x0179, 0x017a, 0x017b, 0x017c, 0x017d, 0x017e, 0x017f,
		0x0180, 0x0181, 0x0182, 0x0183, 0x0185, 0x0186, 0x0187, 0x0188, 0x0189, 0x018a, 0x018b, 0x018d, 0x018e, 0x018f, 0x0190, 0x0191,
		0x0192, 0x0193, 0x0195, 0x0196, 0x0197, 0x0198, 0x0199, 0x019a, 0x019b, 0x019d, 0x019e, 0x019f, 0x01a0, 0x01a1, 0x01a2, 0x01a3,
		0x01a4, 0x01a6, 0x01a7, 0x01a8, 0x01a9, 0x01aa, 0x01ab, 0x01ac, 0x01ae, 0x01af, 0x01b0, 0x01b1, 0x01b2, 0x01b3, 0x01b4, 0x01b6,
		0x01b7, 0x01b8, 0x01b9, 0x01ba, 0x01bb, 0x01bc, 0x01be, 0x01bf, 0x01c0, 0x01c1, 0x01c2, 0x01c3, 0x01c4, 0x01c6, 0x01c7, 0x01c8,
		0x01c9, 0x01ca, 0x01cb, 0x01cc, 0x01cd, 0x01ce, 0x01cf, 0x01cf, 0x01d0, 0x01d1, 0x01d2, 0x01d3, 0x01d4, 0x01d5, 0x01d6, 0x01d7,
		0x01d8, 0x01d9, 0x01da, 0x01db, 0x01db, 0x01dc, 0x01dd, 0x01de, 0x01df, 0x01e0, 0x01e1, 0x01e2, 0x01e3, 0x01e4, 0x01e5, 0x01e6,
		0x01e6, 0x01e7, 0x01e8, 0x01e9, 0x01ea, 0x01eb, 0x01ec, 0x01ed, 0x01ee, 0x01ef, 0x01f0, 0x01f1, 0x01f2, 0x01f2, 0x01f3, 0x01f4,
		0x01f5, 0x01f6, 0x01f7, 0x01f8, 0x01f9, 0x01fa, 0x01fb, 0x01fc, 0x01fd, 0x01fe, 0x01fe, 0x01ff, 0x0200, 0x0201, 0x0202, 0x0203,
		0x0204, 0x0205, 0x0206, 0x0207, 0x0208, 0x0209, 0x020a, 0x020b, 0x020c, 0x020c, 0x020d, 0x020e, 0x020f, 0x0210, 0x0211, 0x0212,
		0x0213, 0x0214, 0x0215, 0x0216, 0x0217, 0x0218, 0x0219, 0x021a, 0x021a, 0x021b, 0x021c, 0x021d, 0x021e, 0x021f, 0x0220, 0x0221,
		0x0222, 0x0223, 0x0224, 0x0225, 0x0226, 0x0227, 0x0228, 0x0229, 0x022a, 0x022a, 0x022b, 0x022c, 0x022d, 0x022e, 0x022f, 0x0230,
		0x0231, 0x0232, 0x0233, 0x0234, 0x0235, 0x0236, 0x0237, 0x0238, 0x0238, 0x0239, 0x023a, 0x023b, 0x023c, 0x023d, 0x023e, 0x023f,
		0x0240, 0x0241, 0x0242, 0x0243, 0x0244, 0x0245, 0x0246, 0x0247, 0x0248, 0x0249, 0x024a, 0x024b, 0x024c, 0x024d, 0x024e, 0x024f,
		0x0250, 0x0251, 0x0252, 0x0253, 0x0254, 0x0255, 0x0256, 0x0257, 0x0258, 0x0259, 0x025a, 0x025b, 0x025c, 0x025d, 0x025e, 0x025f,
		0x0260, 0x0261, 0x0262, 0x0263, 0x0264, 0x0265, 0x0266, 0x0267, 0x0268, 0x0269, 0x026a, 0x026b, 0x026c, 0x026d, 0x026e, 0x026f,
		0x0270, 0x0271, 0x0272, 0x0273, 0x0274, 0x0275, 0x0276, 0x0277, 0x0278, 0x0279, 0x027a, 0x027b, 0x027c, 0x027d, 0x027e, 0x027f,
		0x0280, 0x0281, 0x0282, 0x0283, 0x0284, 0x0285, 0x0286, 0x0287, 0x0288, 0x028a, 0x028b, 0x028c, 0x028d, 0x028e, 0x028f, 0x0290,
		0x0291, 0x0292, 0x0293, 0x0294, 0x0295, 0x0296, 0x0297, 0x0298, 0x029a, 0x029b, 0x029c, 0x029d, 0x029e, 0x029f, 0x02a0, 0x02a1,
		0x02a2, 0x02a3, 0x02a4, 0x02a5, 0x02a6, 0x02a7, 0x02a8, 0x02a9, 0x02aa, 0x02ac, 0x02ad, 0x02ae, 0x02af, 0x02b0, 0x02b1, 0x02b2,
		0x02b3, 0x02b4, 0x02b5, 0x02b6, 0x02b7, 0x02b8, 0x02b9, 0x02ba, 0x02bc, 0x02bd, 0x02be, 0x02bf, 0x02c0, 0x02c1, 0x02c2, 0x02c3,
		0x02c4, 0x02c5, 0x02c6, 0x02c7, 0x02c8, 0x02c9, 0x02ca, 0x02cb, 0x02cc, 0x02cd, 0x02ce, 0x02cf, 0x02d0, 0x02d1, 0x02d2, 0x02d3,
		0x02d4, 0x02d5, 0x02d6, 0x02d7, 0x02d8, 0x02d9, 0x02da, 0x02db, 0x02dc, 0x02dd, 0x02de, 0x02df, 0x02e0, 0x02e1, 0x02e2, 0x02e3,
		0x02e4, 0x02e5, 0x02e6, 0x02e7, 0x02e8, 0x02e9, 0x02ea, 0x02eb, 0x02ec, 0x02ed, 0x02ee, 0x02ef, 0x02f0, 0x02f1, 0x02f2, 0x02f3,
		0x02f4, 0x02f5, 0x02f6, 0x02f7, 0x02f8, 0x02f9, 0x02fa, 0x02fb, 0x02fc, 0x02fd, 0x02fe, 0x02ff, 0x0300, 0x0301, 0x0302, 0x0303,
		0x0304, 0x0305, 0x0306, 0x0307, 0x0308, 0x0309, 0x030a, 0x030b, 0x030c, 0x030d, 0x030e, 0x030f, 0x0310, 0x0311, 0x0312, 0x0313,
		0x0314, 0x0315, 0x0316, 0x0317, 0x0318, 0x0319, 0x031a, 0x031b, 0x031c, 0x031d, 0x031e, 0x031f, 0x0320, 0x0321, 0x0322, 0x0323,
		0x0324, 0x0325, 0x0326, 0x0327, 0x0328, 0x0329, 0x032a, 0x032b, 0x032c, 0x032d, 0x032e, 0x032f, 0x0330, 0x0331, 0x0332, 0x0333,
		0x0334, 0x0335, 0x0336, 0x0337, 0x0338, 0x0339, 0x033a, 0x033b, 0x033c, 0x033d, 0x033e, 0x033f, 0x0340, 0x0341, 0x0342, 0x0343,
		0x0344, 0x0345, 0x0346, 0x0347, 0x0348, 0x0349, 0x034a, 0x034b, 0x034c, 0x034c, 0x034d, 0x034e, 0x034f, 0x0350, 0x0351, 0x0352,
		0x0353, 0x0354, 0x0355, 0x0356, 0x0357, 0x0358, 0x0359, 0x035a, 0x035a, 0x035b, 0x035c, 0x035d, 0x035e, 0x035f, 0x0360, 0x0361,
		0x0362, 0x0363, 0x0364, 0x0365, 0x0366, 0x0367, 0x0368, 0x0369, 0x036a, 0x036a, 0x036b, 0x036c, 0x036d, 0x036e, 0x036f, 0x0370,
		0x0371, 0x0372, 0x0373, 0x0374, 0x0375, 0x0376, 0x0377, 0x0378, 0x0378, 0x0379, 0x037a, 0x037b, 0x037c, 0x037d, 0x037e, 0x037f,
		0x0380, 0x0381, 0x0382, 0x0383, 0x0384, 0x0385, 0x0386, 0x0387, 0x0388, 0x0389, 0x038a, 0x038b, 0x038c, 0x038d, 0x038e, 0x038f,
		0x0390, 0x0391, 0x0392, 0x0393, 0x0394, 0x0395, 0x0396, 0x0397, 0x0398, 0x0399, 0x039a, 0x039b, 0x039c, 0x039d, 0x039e, 0x039f,
		0x03a0, 0x03a1, 0x03a2, 0x03a3, 0x03a4, 0x03a5, 0x03a6, 0x03a7, 0x03a8, 0x03a9, 0x03aa, 0x03ab, 0x03ac, 0x03ad, 0x03ae, 0x03af,
		0x03b0, 0x03b1, 0x03b2, 0x03b3, 0x03b4, 0x03b5, 0x03b6, 0x03b7, 0x03b8, 0x03b9, 0x03ba, 0x03bb, 0x03bc, 0x03bd, 0x03be, 0x03bf,
		0x03c0, 0x03c1, 0x03c2, 0x03c3, 0x03c4, 0x03c5, 0x03c6, 0x03c7, 0x03c8, 0x03c9, 0x03ca, 0x03cb, 0x03cc, 0x03cd, 0x03ce, 0x03cf,
		0x03d0, 0x03d1, 0x03d2, 0x03d3, 0x03d4, 0x03d5, 0x03d6, 0x03d7, 0x03d8, 0x03d9, 0x03da, 0x03db, 0x03dc, 0x03dd, 0x03de, 0x03df,
		0x03e0, 0x03e1, 0x03e2, 0x03e3, 0x03e4, 0x03e5, 0x03e6, 0x03e7, 0x03e8, 0x03e9, 0x03ea, 0x03eb, 0x03ec, 0x03ed, 0x03ee, 0x03ef,
		0x03f0, 0x03f1, 0x03f2, 0x03f3, 0x03f4, 0x03f5, 0x03f6, 0x03f7, 0x03f8, 0x03f9, 0x03fa, 0x03fb, 0x03fc, 0x03fd, 0x03fe, 0x03ff,
	};




static u32 srgb_acm_lut_sata_table[] = {
	0x005d, 0x0060, 0x0064, 0x0068, 0x006b, 0x006e, 0x0072, 0x0076, 0x0079, 0x007d, 0x0081, 0x0085, 0x0088, 0x008c, 0x0090, 0x0094,
	0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0093, 0x008e, 0x0088, 0x0083, 0x007e, 0x0078, 0x0073,
	0x006e, 0x0068, 0x0062, 0x005b, 0x0055, 0x004f, 0x0048, 0x0042, 0x003c, 0x0037, 0x0031, 0x002c, 0x0026, 0x0021, 0x001c, 0x0016,
	0x0011, 0x000f, 0x000d, 0x000b, 0x0008, 0x0006, 0x0004, 0x0002, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0001, 0x0002, 0x0002, 0x0002, 0x0002, 0x0002, 0x0001, 0x0001, 0x0001, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0007, 0x000e, 0x0015, 0x001c, 0x0022, 0x0029, 0x0030, 0x0037, 0x003c, 0x0040, 0x0045, 0x004a, 0x004f, 0x0054, 0x0058,
};



static u32 srgb_acm_lut_satr_table[] = {
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0001, 0x0001, 0x0001, 0x0000, 0x0000, 0x00ff, 0x00ff, 0x00fe,
	0x00fe, 0x00fd, 0x00fd, 0x00fc, 0x00fc, 0x00fb, 0x00fb, 0x00fa, 0x00fa, 0x00f9, 0x00f9, 0x00f8, 0x00f8, 0x00f7, 0x00f7, 0x00f6,
	0x00f6, 0x00f6, 0x00f6, 0x00f5, 0x00f5, 0x00f5, 0x00f5, 0x00f5, 0x00f5, 0x00f5, 0x00f4, 0x00f4, 0x00f4, 0x00f4, 0x00f4, 0x00f4,
	0x00f4, 0x00f4, 0x00f3, 0x00f3, 0x00f3, 0x00f3, 0x00f4, 0x00f6, 0x00f7, 0x00f8, 0x00fa, 0x00fb, 0x00fc, 0x00fd, 0x00ff, 0x0000,
	0x0000, 0x0000, 0x00ff, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd,
	0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd,
	0x00fd, 0x00fc, 0x00fc, 0x00fc, 0x00fc, 0x00fb, 0x00fb, 0x00fb, 0x00fb, 0x00fa, 0x00fa, 0x00fa, 0x00f9, 0x00f9, 0x00f9, 0x00f9,
	0x00f8, 0x00f8, 0x00f8, 0x00f8, 0x00f7, 0x00f7, 0x00f8, 0x00f9, 0x00fa, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fe, 0x00ff, 0x0000,
	0x0000, 0x00ff, 0x00fe, 0x00fd, 0x00fc, 0x00fb, 0x00fa, 0x00f9, 0x00f8, 0x00f7, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe,
	0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe,
	0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x00ff, 0x00ff,
	0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fd, 0x00fd, 0x00fd, 0x00fd,
	0x00fd, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff,
	0x00ff, 0x00ff, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe,
	0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fc, 0x00fc, 0x00fc, 0x00fc, 0x00fc, 0x00fc,
	0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x0000, 0x0000, 0x0001, 0x0001, 0x0001, 0x0002, 0x0002, 0x0003, 0x0003,
	0x0004, 0x0004, 0x0005, 0x0005, 0x0006, 0x0006, 0x0005, 0x0005, 0x0004, 0x0004, 0x0003, 0x0002, 0x0002, 0x0001, 0x0001, 0x0000,
	0x0000, 0x0000, 0x0000, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe,
	0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0001, 0x0001, 0x0001, 0x0001, 0x0000, 0x0000, 0x00ff, 0x00ff,
	0x00fe, 0x00fe, 0x00fe, 0x00fd, 0x00fd, 0x00fc, 0x00fc, 0x00fb, 0x00fb, 0x00fb, 0x00fa, 0x00fa, 0x00f9, 0x00f9, 0x00f8, 0x00f8,
	0x00f8, 0x00f8, 0x00f8, 0x00f8, 0x00f8, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9, 0x00f9,
	0x00fa, 0x00fa, 0x00fa, 0x00fa, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x0000,
};


static u32 ce_acm_lut_hue_table[] = {
	0x03f6, 0x03f7, 0x03f8, 0x03f9, 0x03fa, 0x03fb, 0x03fc, 0x03fd, 0x03fe, 0x03ff, 0x0000, 0x0000, 0x0001, 0x0002, 0x0003, 0x0004,
	0x0005, 0x0006, 0x0007, 0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f, 0x0010, 0x0011, 0x0012, 0x0013, 0x0014,
	0x0014, 0x0015, 0x0016, 0x0017, 0x0018, 0x0019, 0x001a, 0x001b, 0x001c, 0x001d, 0x001e, 0x001f, 0x0020, 0x0021, 0x0022, 0x0023,
	0x0024, 0x0025, 0x0026, 0x0027, 0x0028, 0x0029, 0x0029, 0x002a, 0x002b, 0x002c, 0x002d, 0x002e, 0x002f, 0x0030, 0x0031, 0x0032,
	0x0033, 0x0034, 0x0035, 0x0036, 0x0037, 0x0038, 0x0039, 0x003a, 0x003b, 0x003c, 0x003d, 0x003e, 0x003f, 0x0040, 0x0041, 0x0042,
	0x0043, 0x0044, 0x0045, 0x0046, 0x0047, 0x0048, 0x0049, 0x004a, 0x004b, 0x004c, 0x004d, 0x004e, 0x004f, 0x0050, 0x0051, 0x0052,
	0x0054, 0x0055, 0x0056, 0x0057, 0x0058, 0x0059, 0x005a, 0x005b, 0x005c, 0x005d, 0x005e, 0x005f, 0x0060, 0x0061, 0x0062, 0x0063,
	0x0064, 0x0065, 0x0066, 0x0067, 0x0068, 0x0069, 0x006b, 0x006c, 0x006d, 0x006e, 0x006f, 0x0070, 0x0071, 0x0072, 0x0073, 0x0074,
	0x0075, 0x0076, 0x0077, 0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085,
	0x0087, 0x0088, 0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0091, 0x0092, 0x0093, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x009a, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x00a0, 0x00a2, 0x00a3, 0x00a4, 0x00a5, 0x00a6, 0x00a8, 0x00a9, 0x00aa,
	0x00ab, 0x00ad, 0x00ae, 0x00af, 0x00b1, 0x00b2, 0x00b3, 0x00b4, 0x00b6, 0x00b7, 0x00b8, 0x00ba, 0x00bb, 0x00bc, 0x00bd, 0x00bf,
	0x00c0, 0x00c1, 0x00c2, 0x00c3, 0x00c4, 0x00c5, 0x00c6, 0x00c7, 0x00c8, 0x00c9, 0x00ca, 0x00cb, 0x00cc, 0x00cd, 0x00ce, 0x00cf,
	0x00d0, 0x00d1, 0x00d2, 0x00d3, 0x00d4, 0x00d5, 0x00d6, 0x00d7, 0x00d8, 0x00d9, 0x00da, 0x00db, 0x00dc, 0x00dd, 0x00de, 0x00df,
	0x00e0, 0x00e1, 0x00e2, 0x00e3, 0x00e4, 0x00e5, 0x00e6, 0x00e7, 0x00e8, 0x00e9, 0x00ea, 0x00eb, 0x00ec, 0x00ed, 0x00ee, 0x00ef,
	0x00f0, 0x00f1, 0x00f2, 0x00f3, 0x00f4, 0x00f5, 0x00f6, 0x00f7, 0x00f8, 0x00f9, 0x00fa, 0x00fb, 0x00fc, 0x00fd, 0x00fe, 0x00ff,
	0x0100, 0x0101, 0x0102, 0x0103, 0x0104, 0x0105, 0x0106, 0x0107, 0x0108, 0x0109, 0x010a, 0x010b, 0x010c, 0x010d, 0x010e, 0x010f,
	0x0110, 0x0111, 0x0112, 0x0113, 0x0114, 0x0115, 0x0116, 0x0117, 0x0118, 0x0119, 0x011a, 0x011b, 0x011c, 0x011d, 0x011e, 0x011f,
	0x0120, 0x0121, 0x0122, 0x0123, 0x0124, 0x0125, 0x0126, 0x0127, 0x0128, 0x0129, 0x012a, 0x012b, 0x012c, 0x012d, 0x012e, 0x012f,
	0x0130, 0x0131, 0x0132, 0x0133, 0x0134, 0x0135, 0x0136, 0x0137, 0x0138, 0x0139, 0x013a, 0x013b, 0x013c, 0x013d, 0x013e, 0x013f,
	0x0140, 0x0141, 0x0142, 0x0143, 0x0144, 0x0145, 0x0146, 0x0147, 0x0148, 0x0149, 0x014a, 0x014b, 0x014c, 0x014d, 0x014e, 0x014f,
	0x0150, 0x0151, 0x0152, 0x0153, 0x0154, 0x0155, 0x0156, 0x0157, 0x0158, 0x0159, 0x015a, 0x015b, 0x015c, 0x015d, 0x015e, 0x015f,
	0x0160, 0x0161, 0x0162, 0x0163, 0x0164, 0x0165, 0x0166, 0x0167, 0x0168, 0x0169, 0x016a, 0x016b, 0x016c, 0x016d, 0x016e, 0x016f,
	0x0170, 0x0171, 0x0172, 0x0173, 0x0174, 0x0175, 0x0176, 0x0177, 0x0178, 0x0179, 0x017a, 0x017b, 0x017c, 0x017d, 0x017e, 0x017f,
	0x0180, 0x0181, 0x0182, 0x0182, 0x0183, 0x0184, 0x0185, 0x0186, 0x0186, 0x0187, 0x0188, 0x0189, 0x018a, 0x018a, 0x018b, 0x018c,
	0x018d, 0x018e, 0x018e, 0x018f, 0x0190, 0x0191, 0x0192, 0x0192, 0x0193, 0x0194, 0x0195, 0x0196, 0x0196, 0x0197, 0x0198, 0x0199,
	0x019a, 0x019a, 0x019b, 0x019c, 0x019d, 0x019d, 0x019e, 0x019f, 0x01a0, 0x01a1, 0x01a1, 0x01a2, 0x01a3, 0x01a4, 0x01a5, 0x01a5,
	0x01a6, 0x01a7, 0x01a8, 0x01a9, 0x01a9, 0x01aa, 0x01ab, 0x01ac, 0x01ad, 0x01ad, 0x01ae, 0x01af, 0x01b0, 0x01b1, 0x01b1, 0x01b2,
	0x01b3, 0x01b4, 0x01b5, 0x01b7, 0x01b8, 0x01b9, 0x01ba, 0x01bb, 0x01bd, 0x01be, 0x01bf, 0x01c0, 0x01c1, 0x01c3, 0x01c4, 0x01c5,
	0x01c6, 0x01c7, 0x01c9, 0x01ca, 0x01cb, 0x01cc, 0x01cd, 0x01cf, 0x01d0, 0x01d1, 0x01d2, 0x01d3, 0x01d5, 0x01d6, 0x01d7, 0x01d8,
	0x01da, 0x01db, 0x01dc, 0x01dd, 0x01de, 0x01e0, 0x01e1, 0x01e2, 0x01e3, 0x01e4, 0x01e6, 0x01e7, 0x01e8, 0x01e9, 0x01ea, 0x01ec,
	0x01ed, 0x01ee, 0x01ef, 0x01f0, 0x01f2, 0x01f3, 0x01f4, 0x01f5, 0x01f6, 0x01f8, 0x01f9, 0x01fa, 0x01fb, 0x01fc, 0x01fe, 0x01ff,
	0x0200, 0x0201, 0x0202, 0x0203, 0x0204, 0x0205, 0x0206, 0x0207, 0x0208, 0x0209, 0x020a, 0x020b, 0x020c, 0x020d, 0x020e, 0x020f,
	0x0210, 0x0211, 0x0212, 0x0213, 0x0214, 0x0215, 0x0216, 0x0217, 0x0218, 0x0219, 0x021a, 0x021b, 0x021c, 0x021d, 0x021e, 0x021f,
	0x0220, 0x0221, 0x0222, 0x0223, 0x0224, 0x0225, 0x0226, 0x0227, 0x0228, 0x0229, 0x022a, 0x022b, 0x022c, 0x022d, 0x022e, 0x022f,
	0x0230, 0x0231, 0x0232, 0x0233, 0x0234, 0x0235, 0x0236, 0x0237, 0x0238, 0x0239, 0x023a, 0x023b, 0x023c, 0x023d, 0x023e, 0x023f,
	0x0240, 0x0241, 0x0242, 0x0243, 0x0244, 0x0245, 0x0246, 0x0247, 0x0248, 0x0249, 0x024a, 0x024b, 0x024c, 0x024d, 0x024e, 0x024f,
	0x0250, 0x0251, 0x0252, 0x0253, 0x0254, 0x0255, 0x0256, 0x0257, 0x0258, 0x0259, 0x025a, 0x025b, 0x025c, 0x025d, 0x025e, 0x025f,
	0x0260, 0x0261, 0x0262, 0x0263, 0x0264, 0x0265, 0x0266, 0x0267, 0x0268, 0x0269, 0x026a, 0x026b, 0x026c, 0x026d, 0x026e, 0x026f,
	0x0270, 0x0271, 0x0272, 0x0273, 0x0274, 0x0275, 0x0276, 0x0277, 0x0278, 0x0279, 0x027a, 0x027b, 0x027c, 0x027d, 0x027e, 0x027f,
	0x0280, 0x0281, 0x0282, 0x0283, 0x0284, 0x0285, 0x0286, 0x0287, 0x0288, 0x0289, 0x028a, 0x028b, 0x028c, 0x028d, 0x028e, 0x028f,
	0x0290, 0x0291, 0x0292, 0x0293, 0x0294, 0x0295, 0x0296, 0x0297, 0x0298, 0x0299, 0x029a, 0x029b, 0x029c, 0x029d, 0x029e, 0x029f,
	0x02a0, 0x02a1, 0x02a2, 0x02a3, 0x02a4, 0x02a5, 0x02a6, 0x02a7, 0x02a8, 0x02a9, 0x02aa, 0x02ab, 0x02ac, 0x02ad, 0x02ae, 0x02af,
	0x02b0, 0x02b1, 0x02b2, 0x02b3, 0x02b4, 0x02b5, 0x02b6, 0x02b7, 0x02b8, 0x02b9, 0x02ba, 0x02bb, 0x02bc, 0x02bd, 0x02be, 0x02bf,
	0x02c0, 0x02c1, 0x02c2, 0x02c3, 0x02c4, 0x02c5, 0x02c6, 0x02c7, 0x02c8, 0x02c9, 0x02ca, 0x02cb, 0x02cc, 0x02cd, 0x02ce, 0x02cf,
	0x02d0, 0x02d1, 0x02d2, 0x02d3, 0x02d4, 0x02d5, 0x02d6, 0x02d7, 0x02d8, 0x02d9, 0x02da, 0x02db, 0x02dc, 0x02dd, 0x02de, 0x02df,
	0x02e0, 0x02e1, 0x02e2, 0x02e3, 0x02e4, 0x02e5, 0x02e6, 0x02e7, 0x02e8, 0x02e9, 0x02ea, 0x02eb, 0x02ec, 0x02ed, 0x02ee, 0x02ef,
	0x02f0, 0x02f1, 0x02f2, 0x02f3, 0x02f4, 0x02f5, 0x02f6, 0x02f7, 0x02f8, 0x02f9, 0x02fa, 0x02fb, 0x02fc, 0x02fd, 0x02fe, 0x02ff,
	0x0300, 0x0301, 0x0302, 0x0303, 0x0304, 0x0305, 0x0306, 0x0307, 0x0308, 0x0309, 0x030a, 0x030b, 0x030c, 0x030d, 0x030e, 0x030f,
	0x0310, 0x0311, 0x0312, 0x0313, 0x0314, 0x0315, 0x0316, 0x0317, 0x0318, 0x0319, 0x031a, 0x031b, 0x031c, 0x031d, 0x031e, 0x031f,
	0x0320, 0x0321, 0x0322, 0x0323, 0x0324, 0x0325, 0x0326, 0x0327, 0x0328, 0x0329, 0x032a, 0x032b, 0x032c, 0x032d, 0x032e, 0x032f,
	0x0330, 0x0331, 0x0332, 0x0333, 0x0334, 0x0335, 0x0336, 0x0337, 0x0338, 0x0339, 0x033a, 0x033b, 0x033c, 0x033d, 0x033e, 0x033f,
	0x0340, 0x0341, 0x0342, 0x0343, 0x0344, 0x0345, 0x0346, 0x0347, 0x0348, 0x0349, 0x034a, 0x034b, 0x034c, 0x034d, 0x034e, 0x034f,
	0x0350, 0x0351, 0x0352, 0x0353, 0x0354, 0x0355, 0x0356, 0x0357, 0x0358, 0x0359, 0x035a, 0x035b, 0x035c, 0x035d, 0x035e, 0x035f,
	0x0360, 0x0361, 0x0362, 0x0363, 0x0364, 0x0365, 0x0366, 0x0367, 0x0368, 0x0369, 0x036a, 0x036b, 0x036c, 0x036d, 0x036e, 0x036f,
	0x0370, 0x0371, 0x0372, 0x0373, 0x0374, 0x0375, 0x0376, 0x0377, 0x0378, 0x0379, 0x037a, 0x037b, 0x037c, 0x037d, 0x037e, 0x037f,
	0x0380, 0x0381, 0x0382, 0x0383, 0x0384, 0x0385, 0x0386, 0x0386, 0x0387, 0x0388, 0x0389, 0x038a, 0x038b, 0x038c, 0x038d, 0x038e,
	0x038f, 0x0390, 0x0391, 0x0392, 0x0392, 0x0393, 0x0394, 0x0395, 0x0396, 0x0397, 0x0398, 0x0399, 0x039a, 0x039b, 0x039c, 0x039d,
	0x039e, 0x039e, 0x039f, 0x03a0, 0x03a1, 0x03a2, 0x03a3, 0x03a4, 0x03a5, 0x03a6, 0x03a7, 0x03a8, 0x03a9, 0x03a9, 0x03aa, 0x03ab,
	0x03ac, 0x03ad, 0x03ae, 0x03af, 0x03b0, 0x03b1, 0x03b2, 0x03b3, 0x03b4, 0x03b5, 0x03b5, 0x03b6, 0x03b7, 0x03b8, 0x03b9, 0x03ba,
	0x03bb, 0x03bc, 0x03bd, 0x03be, 0x03bf, 0x03c0, 0x03c0, 0x03c1, 0x03c2, 0x03c3, 0x03c4, 0x03c5, 0x03c6, 0x03c7, 0x03c8, 0x03c9,
	0x03c9, 0x03ca, 0x03cb, 0x03cc, 0x03cd, 0x03ce, 0x03cf, 0x03d0, 0x03d1, 0x03d2, 0x03d3, 0x03d3, 0x03d4, 0x03d5, 0x03d6, 0x03d7,
	0x03d8, 0x03d9, 0x03da, 0x03db, 0x03dc, 0x03dd, 0x03dd, 0x03de, 0x03df, 0x03e0, 0x03e1, 0x03e2, 0x03e3, 0x03e4, 0x03e5, 0x03e6,
	0x03e7, 0x03e8, 0x03e9, 0x03ea, 0x03eb, 0x03ec, 0x03ec, 0x03ed, 0x03ee, 0x03ef, 0x03f0, 0x03f1, 0x03f2, 0x03f3, 0x03f4, 0x03f5,
};

static u32 ce_acm_lut_sata_table[] = {
	0x005d, 0x0060, 0x0064, 0x0068, 0x006b, 0x006e, 0x0072, 0x0076, 0x0079, 0x007d, 0x0081, 0x0085, 0x0088, 0x008c, 0x0090, 0x0094,
	0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0098, 0x0093, 0x008e, 0x0088, 0x0083, 0x007e, 0x0078, 0x0073,
	0x006e, 0x0068, 0x0062, 0x005b, 0x0055, 0x004f, 0x0048, 0x0042, 0x003c, 0x0037, 0x0031, 0x002c, 0x0026, 0x0021, 0x001c, 0x0016,
	0x0011, 0x000f, 0x000d, 0x000b, 0x0008, 0x0006, 0x0004, 0x0002, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0001, 0x0002, 0x0002, 0x0003, 0x0004, 0x0004, 0x0005, 0x0006, 0x0009, 0x000c, 0x000e, 0x0011, 0x0014, 0x0016, 0x0019,
	0x001c, 0x001d, 0x001e, 0x001f, 0x0020, 0x0021, 0x0022, 0x0023, 0x0024, 0x0024, 0x0024, 0x0025, 0x0025, 0x0025, 0x0026, 0x0026,
	0x0026, 0x0026, 0x0026, 0x0027, 0x0027, 0x0027, 0x0028, 0x0028, 0x0028, 0x0028, 0x0028, 0x0027, 0x0027, 0x0027, 0x0026, 0x0026,
	0x0026, 0x0026, 0x0025, 0x0024, 0x0024, 0x0024, 0x0023, 0x0022, 0x0022, 0x0020, 0x001f, 0x001e, 0x001c, 0x001a, 0x0019, 0x0018,
	0x0016, 0x0014, 0x0012, 0x0010, 0x000e, 0x000c, 0x000a, 0x0008, 0x0006, 0x0005, 0x0004, 0x0004, 0x0003, 0x0002, 0x0002, 0x0001,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0007, 0x000e, 0x0015, 0x001c, 0x0022, 0x0029, 0x0030, 0x0037, 0x003c, 0x0040, 0x0045, 0x004a, 0x004f, 0x0054, 0x0058,
};


static u32 ce_acm_lut_satr_table[] = {
	0x0000, 0x00fe, 0x00fc, 0x00fa, 0x00f8, 0x00f6, 0x00f5, 0x00f3, 0x00f1, 0x00ef, 0x00ed, 0x00ec, 0x00eb, 0x00ea, 0x00e9, 0x00e8,
	0x00e8, 0x00e7, 0x00e6, 0x00e5, 0x00e4, 0x00e3, 0x00e2, 0x00e1, 0x00e0, 0x00df, 0x00df, 0x00de, 0x00dd, 0x00dc, 0x00db, 0x00da,
	0x00da, 0x00da, 0x00d9, 0x00d9, 0x00d9, 0x00d9, 0x00d9, 0x00d9, 0x00d8, 0x00d8, 0x00d8, 0x00d8, 0x00d8, 0x00d7, 0x00d7, 0x00d7,
	0x00d7, 0x00d7, 0x00d7, 0x00d6, 0x00d6, 0x00d6, 0x00da, 0x00de, 0x00e3, 0x00e7, 0x00eb, 0x00ef, 0x00f3, 0x00f8, 0x00fc, 0x0000,
	0x0000, 0x00fe, 0x00fd, 0x00fc, 0x00fa, 0x00f8, 0x00f7, 0x00f6, 0x00f4, 0x00f2, 0x00f1, 0x00f0, 0x00ef, 0x00ee, 0x00ed, 0x00ec,
	0x00eb, 0x00ea, 0x00e9, 0x00e8, 0x00e7, 0x00e5, 0x00e4, 0x00e3, 0x00e2, 0x00e1, 0x00e0, 0x00df, 0x00de, 0x00dd, 0x00dc, 0x00db,
	0x00db, 0x00db, 0x00db, 0x00db, 0x00db, 0x00db, 0x00db, 0x00db, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dc, 0x00dc, 0x00dc, 0x00dc,
	0x00dc, 0x00dc, 0x00dc, 0x00dc, 0x00dc, 0x00dc, 0x00e0, 0x00e3, 0x00e7, 0x00ea, 0x00ee, 0x00f2, 0x00f5, 0x00f9, 0x00fc, 0x0000,
	0x0000, 0x00ff, 0x00fe, 0x00fd, 0x00fc, 0x00fb, 0x00fa, 0x00f9, 0x00f8, 0x00f7, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe,
	0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0002, 0x0003, 0x0004,
	0x0005, 0x0006, 0x0006, 0x0007, 0x0008, 0x0009, 0x000a, 0x000b, 0x000b, 0x000c, 0x000d, 0x000e, 0x000f, 0x000f, 0x0010, 0x0011,
	0x0010, 0x000f, 0x000f, 0x000e, 0x000d, 0x000c, 0x000c, 0x000b, 0x000a, 0x0009, 0x0008, 0x0008, 0x0007, 0x0006, 0x0005, 0x0005,
	0x0004, 0x0003, 0x0002, 0x0002, 0x0001, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0002, 0x0003, 0x0004,
	0x0005, 0x0005, 0x0006, 0x0007, 0x0008, 0x0008, 0x0009, 0x000a, 0x000b, 0x000b, 0x000c, 0x000d, 0x000e, 0x000e, 0x000f, 0x0010,
	0x000f, 0x000f, 0x000e, 0x000d, 0x000c, 0x000c, 0x000b, 0x000a, 0x0009, 0x0009, 0x0008, 0x0007, 0x0007, 0x0006, 0x0005, 0x0004,
	0x0004, 0x0003, 0x0002, 0x0001, 0x0001, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x0000, 0x0000, 0x0001,
	0x0001, 0x0002, 0x0002, 0x0003, 0x0003, 0x0004, 0x0004, 0x0005, 0x0005, 0x0006, 0x0006, 0x0007, 0x0007, 0x0008, 0x0008, 0x0009,
	0x0009, 0x0009, 0x0009, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0007, 0x0007, 0x0007, 0x0007, 0x0007,
	0x0007, 0x0007, 0x0006, 0x0006, 0x0006, 0x0006, 0x0005, 0x0005, 0x0004, 0x0004, 0x0003, 0x0002, 0x0002, 0x0001, 0x0001, 0x0000,
	0x0000, 0x00ff, 0x00ff, 0x00fe, 0x00fe, 0x00fd, 0x00fc, 0x00fc, 0x00fb, 0x00fb, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fb,
	0x00fc, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00fe, 0x00ff, 0x00ff, 0x00ff, 0x00ff, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x00ff, 0x00fd, 0x00fc, 0x00fa, 0x00f9, 0x00f8, 0x00f6, 0x00f5, 0x00f3, 0x00f2, 0x00f2, 0x00f1, 0x00f1, 0x00f1, 0x00f0,
	0x00f0, 0x00f0, 0x00ef, 0x00ef, 0x00ef, 0x00ee, 0x00ee, 0x00ee, 0x00ed, 0x00ed, 0x00ed, 0x00ec, 0x00ec, 0x00ec, 0x00eb, 0x00eb,
	0x00eb, 0x00eb, 0x00eb, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec, 0x00ec,
	0x00ed, 0x00ed, 0x00ed, 0x00ed, 0x00ed, 0x00ed, 0x00ef, 0x00f1, 0x00f3, 0x00f5, 0x00f6, 0x00f8, 0x00fa, 0x00fc, 0x00fe, 0x0000,
};


/*******************************************************************************
** GAMMA
*/
static u32 gamma_lut_table_R[] = {
	0x0000, 0x000d, 0x0016, 0x001c, 0x0022, 0x0026, 0x002a, 0x002e, 0x0032, 0x0035, 0x0038, 0x003b, 0x003d, 0x0040, 0x0042, 0x0045,
	0x0047, 0x0049, 0x004b, 0x004d, 0x004f, 0x0051, 0x0053, 0x0055, 0x0056, 0x0058, 0x005a, 0x005c, 0x005d, 0x005f, 0x0060, 0x0062,
	0x0063, 0x0065, 0x0066, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x0070, 0x0071, 0x0072, 0x0073, 0x0075, 0x0076, 0x0077,
	0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086, 0x0087, 0x0088,
	0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0093, 0x0094, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x0099, 0x009a, 0x009b, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a3, 0x00a4,
	0x00a5, 0x00a6, 0x00a7, 0x00a7, 0x00a8, 0x00a9, 0x00aa, 0x00aa, 0x00ab, 0x00ac, 0x00ad, 0x00ad, 0x00ae, 0x00af, 0x00af, 0x00b0,
	0x00b1, 0x00b2, 0x00b2, 0x00b3, 0x00b4, 0x00b4, 0x00b5, 0x00b6, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00ba, 0x00bb, 0x00bb,
	0x00bc, 0x00bd, 0x00bd, 0x00be, 0x00be, 0x00bf, 0x00c0, 0x00c0, 0x00c1, 0x00c2, 0x00c2, 0x00c3, 0x00c4, 0x00c4, 0x00c5, 0x00c5,
	0x00c6, 0x00c7, 0x00c7, 0x00c8, 0x00c8, 0x00c9, 0x00ca, 0x00ca, 0x00cb, 0x00cb, 0x00cc, 0x00cd, 0x00cd, 0x00ce, 0x00ce, 0x00cf,
	0x00d0, 0x00d0, 0x00d1, 0x00d1, 0x00d2, 0x00d2, 0x00d3, 0x00d4, 0x00d4, 0x00d5, 0x00d5, 0x00d6, 0x00d6, 0x00d7, 0x00d7, 0x00d8,
	0x00d8, 0x00d9, 0x00da, 0x00da, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dd, 0x00dd, 0x00de, 0x00de, 0x00df, 0x00df, 0x00e0, 0x00e0,
	0x00e1, 0x00e2, 0x00e2, 0x00e3, 0x00e3, 0x00e4, 0x00e4, 0x00e5, 0x00e5, 0x00e6, 0x00e6, 0x00e7, 0x00e7, 0x00e8, 0x00e8, 0x00e9,
	0x00e9, 0x00ea, 0x00ea, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ed, 0x00ed, 0x00ee, 0x00ee, 0x00ee, 0x00ef, 0x00ef, 0x00f0, 0x00f0,
	0x00f1, 0x00f1, 0x00f2, 0x00f2, 0x00f3, 0x00f3, 0x00f4, 0x00f4, 0x00f5, 0x00f5, 0x00f6, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff,
};

static u32 gamma_lut_table_G[] = {
	0x0000, 0x000d, 0x0016, 0x001c, 0x0022, 0x0026, 0x002a, 0x002e, 0x0032, 0x0035, 0x0038, 0x003b, 0x003d, 0x0040, 0x0042, 0x0045,
	0x0047, 0x0049, 0x004b, 0x004d, 0x004f, 0x0051, 0x0053, 0x0055, 0x0056, 0x0058, 0x005a, 0x005c, 0x005d, 0x005f, 0x0060, 0x0062,
	0x0063, 0x0065, 0x0066, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x0070, 0x0071, 0x0072, 0x0073, 0x0075, 0x0076, 0x0077,
	0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086, 0x0087, 0x0088,
	0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0093, 0x0094, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x0099, 0x009a, 0x009b, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a3, 0x00a4,
	0x00a5, 0x00a6, 0x00a7, 0x00a7, 0x00a8, 0x00a9, 0x00aa, 0x00aa, 0x00ab, 0x00ac, 0x00ad, 0x00ad, 0x00ae, 0x00af, 0x00af, 0x00b0,
	0x00b1, 0x00b2, 0x00b2, 0x00b3, 0x00b4, 0x00b4, 0x00b5, 0x00b6, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00ba, 0x00bb, 0x00bb,
	0x00bc, 0x00bd, 0x00bd, 0x00be, 0x00be, 0x00bf, 0x00c0, 0x00c0, 0x00c1, 0x00c2, 0x00c2, 0x00c3, 0x00c4, 0x00c4, 0x00c5, 0x00c5,
	0x00c6, 0x00c7, 0x00c7, 0x00c8, 0x00c8, 0x00c9, 0x00ca, 0x00ca, 0x00cb, 0x00cb, 0x00cc, 0x00cd, 0x00cd, 0x00ce, 0x00ce, 0x00cf,
	0x00d0, 0x00d0, 0x00d1, 0x00d1, 0x00d2, 0x00d2, 0x00d3, 0x00d4, 0x00d4, 0x00d5, 0x00d5, 0x00d6, 0x00d6, 0x00d7, 0x00d7, 0x00d8,
	0x00d8, 0x00d9, 0x00da, 0x00da, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dd, 0x00dd, 0x00de, 0x00de, 0x00df, 0x00df, 0x00e0, 0x00e0,
	0x00e1, 0x00e2, 0x00e2, 0x00e3, 0x00e3, 0x00e4, 0x00e4, 0x00e5, 0x00e5, 0x00e6, 0x00e6, 0x00e7, 0x00e7, 0x00e8, 0x00e8, 0x00e9,
	0x00e9, 0x00ea, 0x00ea, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ed, 0x00ed, 0x00ee, 0x00ee, 0x00ee, 0x00ef, 0x00ef, 0x00f0, 0x00f0,
	0x00f1, 0x00f1, 0x00f2, 0x00f2, 0x00f3, 0x00f3, 0x00f4, 0x00f4, 0x00f5, 0x00f5, 0x00f6, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff,
};

static u32 gamma_lut_table_B[] = {
	0x0000, 0x000d, 0x0016, 0x001c, 0x0022, 0x0026, 0x002a, 0x002e, 0x0032, 0x0035, 0x0038, 0x003b, 0x003d, 0x0040, 0x0042, 0x0045,
	0x0047, 0x0049, 0x004b, 0x004d, 0x004f, 0x0051, 0x0053, 0x0055, 0x0056, 0x0058, 0x005a, 0x005c, 0x005d, 0x005f, 0x0060, 0x0062,
	0x0063, 0x0065, 0x0066, 0x0068, 0x0069, 0x006a, 0x006c, 0x006d, 0x006e, 0x0070, 0x0071, 0x0072, 0x0073, 0x0075, 0x0076, 0x0077,
	0x0078, 0x0079, 0x007a, 0x007c, 0x007d, 0x007e, 0x007f, 0x0080, 0x0081, 0x0082, 0x0083, 0x0084, 0x0085, 0x0086, 0x0087, 0x0088,
	0x0089, 0x008a, 0x008b, 0x008c, 0x008d, 0x008e, 0x008f, 0x0090, 0x0091, 0x0092, 0x0093, 0x0094, 0x0094, 0x0095, 0x0096, 0x0097,
	0x0098, 0x0099, 0x009a, 0x009b, 0x009b, 0x009c, 0x009d, 0x009e, 0x009f, 0x009f, 0x00a0, 0x00a1, 0x00a2, 0x00a3, 0x00a3, 0x00a4,
	0x00a5, 0x00a6, 0x00a7, 0x00a7, 0x00a8, 0x00a9, 0x00aa, 0x00aa, 0x00ab, 0x00ac, 0x00ad, 0x00ad, 0x00ae, 0x00af, 0x00af, 0x00b0,
	0x00b1, 0x00b2, 0x00b2, 0x00b3, 0x00b4, 0x00b4, 0x00b5, 0x00b6, 0x00b6, 0x00b7, 0x00b8, 0x00b9, 0x00b9, 0x00ba, 0x00bb, 0x00bb,
	0x00bc, 0x00bd, 0x00bd, 0x00be, 0x00be, 0x00bf, 0x00c0, 0x00c0, 0x00c1, 0x00c2, 0x00c2, 0x00c3, 0x00c4, 0x00c4, 0x00c5, 0x00c5,
	0x00c6, 0x00c7, 0x00c7, 0x00c8, 0x00c8, 0x00c9, 0x00ca, 0x00ca, 0x00cb, 0x00cb, 0x00cc, 0x00cd, 0x00cd, 0x00ce, 0x00ce, 0x00cf,
	0x00d0, 0x00d0, 0x00d1, 0x00d1, 0x00d2, 0x00d2, 0x00d3, 0x00d4, 0x00d4, 0x00d5, 0x00d5, 0x00d6, 0x00d6, 0x00d7, 0x00d7, 0x00d8,
	0x00d8, 0x00d9, 0x00da, 0x00da, 0x00db, 0x00db, 0x00dc, 0x00dc, 0x00dd, 0x00dd, 0x00de, 0x00de, 0x00df, 0x00df, 0x00e0, 0x00e0,
	0x00e1, 0x00e2, 0x00e2, 0x00e3, 0x00e3, 0x00e4, 0x00e4, 0x00e5, 0x00e5, 0x00e6, 0x00e6, 0x00e7, 0x00e7, 0x00e8, 0x00e8, 0x00e9,
	0x00e9, 0x00ea, 0x00ea, 0x00eb, 0x00eb, 0x00ec, 0x00ec, 0x00ed, 0x00ed, 0x00ee, 0x00ee, 0x00ee, 0x00ef, 0x00ef, 0x00f0, 0x00f0,
	0x00f1, 0x00f1, 0x00f2, 0x00f2, 0x00f3, 0x00f3, 0x00f4, 0x00f4, 0x00f5, 0x00f5, 0x00f6, 0x00f6, 0x00f6, 0x00f7, 0x00f7, 0x00f8,
	0x00f8, 0x00f9, 0x00f9, 0x00fa, 0x00fa, 0x00fb, 0x00fb, 0x00fb, 0x00fc, 0x00fc, 0x00fd, 0x00fd, 0x00fe, 0x00fe, 0x00ff, 0x00ff,
};

/*******************************************************************************
** IGM
*/
static u32 igm_lut_table_R[] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009, 0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053, 0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c, 0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101, 0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185, 0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229, 0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1, 0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd, 0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef, 0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629, 0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c, 0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a, 0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5, 0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc, 0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3, 0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
};

static u32 igm_lut_table_G[] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009, 0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053, 0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c, 0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101, 0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185, 0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229, 0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1, 0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd, 0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef, 0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629, 0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c, 0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a, 0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5, 0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc, 0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3, 0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
};

static u32 igm_lut_table_B[] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009, 0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053, 0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c, 0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101, 0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185, 0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229, 0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1, 0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd, 0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef, 0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629, 0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c, 0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a, 0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5, 0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc, 0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3, 0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
};

/*******************************************************************************
** GMT
*/
	static u32 lcp_gmp_lut_table_low32bit[9][9][9] = {
		{
			{0x00000000, 0x000201c2, 0x00040384, 0x00060546, 0x00080708, 0x000a08ca, 0x000c0a8c, 0x000e0c4e, 0x000ffe02, },
			{0xa71ea02e, 0xa620a1f0, 0xa522a3b2, 0xa424a574, 0xa226a736, 0xa128a8f8, 0xa02aaaba, 0x9f2cac7c, 0x9e2e9e30, },
			{0x4f3d405c, 0x4e3f421e, 0x4c4143e0, 0x4b4345a2, 0x4a454764, 0x49474926, 0x47494ae8, 0x464b4caa, 0x454d3e5e, },
			{0xf65be08a, 0xf55df24c, 0xf45ff40e, 0xf261f5d0, 0xf163f792, 0xf065f954, 0xef67fb16, 0xee69fcd8, 0xec6bee8c, },
			{0x9e7a90b8, 0x9c7c927a, 0x9b7e943c, 0x9a8095fe, 0x998297c0, 0x97849982, 0x96869b44, 0x95889d06, 0x948a8eba, },
			{0x459930e6, 0x449b32a8, 0x439d346b, 0x419f362d, 0x40a137ef, 0x3fa339b1, 0x3ea53b73, 0x3ca73d35, 0x3ba92ee9, },
			{0xecb7d115, 0xebb9d2d7, 0xeabbd499, 0xe9bdd65b, 0xe7bfd81d, 0xe6c1d9df, 0xe5c3dba1, 0xe4c5dd63, 0xe3c7cf17, },
			{0x94d67143, 0x93d87305, 0x91da74c7, 0x90dc7689, 0x8fde784b, 0x8ee07a0d, 0x8ce27bcf, 0x8be47d91, 0x8ae66f45, },
			{0x36f4216f, 0x35f62331, 0x33f824f3, 0x32fa26b5, 0x31fc2877, 0x30fe2a39, 0x2fff0bfb, 0x2dff0dbd, 0x2cff0f71, },
		},
		{
			{0x5a000010, 0x590161d2, 0x57036394, 0x56056556, 0x55076718, 0x540968da, 0x520b6a9c, 0x510d6c5e, 0x500f5e12, },
			{0x011e003e, 0x00200200, 0xff2203c2, 0xfe240584, 0xfc260746, 0xfb280908, 0xfa2a0aca, 0xf92c0c8c, 0xf72dfe40, },
			{0xa93ca06c, 0xa73ea22e, 0xa640a3f0, 0xa542a5b2, 0xa444a774, 0xa246a936, 0xa148aaf8, 0xa04aacba, 0x9f4c9e6e, },
			{0x505b409a, 0x4f5d425c, 0x4e5f441e, 0x4c6145e0, 0x4b6347a2, 0x4a654964, 0x49674b26, 0x47694ce8, 0x466b3e9c, },
			{0xf779e0c8, 0xf67be28a, 0xf57df44c, 0xf47ff60e, 0xf281f7d0, 0xf183f992, 0xf085fb54, 0xef87fd16, 0xee89eeca, },
			{0x9f9890f6, 0x9e9a92b8, 0x9c9c947a, 0x9b9e963c, 0x9aa097fe, 0x99a299c0, 0x97a49b82, 0x96a69d44, 0x95a88ef8, },
			{0x46b73124, 0x45b932e6, 0x44bb34a8, 0x43bd366b, 0x41bf382d, 0x40c139ef, 0x3fc33bb1, 0x3ec53d73, 0x3cc72f27, },
			{0xeed5d153, 0xecd7d315, 0xebd9d4d7, 0xeadbd699, 0xe9ddd85b, 0xe7dfda1d, 0xe6e1dbdf, 0xe5e3dda1, 0xe4e5cf55, },
			{0x90f3817f, 0x8ff58341, 0x8df78503, 0x8cf986c5, 0x8bfb8887, 0x8afd8a49, 0x88ff0c0b, 0x87ff0dcd, 0x86ff0f81, },
		},
		{
			{0xb4000020, 0xb200c1e2, 0xb102c3a4, 0xb004c566, 0xaf06c728, 0xae08c8ea, 0xac0acaac, 0xab0ccc6e, 0xaa0ebe22, },
			{0x5b1d604e, 0x5a1f6210, 0x592163d2, 0x57236594, 0x56256756, 0x55276918, 0x54296ada, 0x522b6c9c, 0x512d5e50, },
			{0x023c007c, 0x013e023e, 0x00400400, 0xff4205c2, 0xfe440784, 0xfc460946, 0xfb480b08, 0xfa4a0cca, 0xf94bfe7e, },
			{0xaa5aa0aa, 0xa95ca26c, 0xa75ea42e, 0xa660a5f0, 0xa562a7b2, 0xa464a974, 0xa266ab36, 0xa168acf8, 0xa06a9eac, },
			{0x517940d8, 0x507b429a, 0x4f7d445c, 0x4e7f461e, 0x4c8147e0, 0x4b8349a2, 0x4a854b64, 0x49874d26, 0x47893eda, },
			{0xf997e106, 0xf799e2c8, 0xf69be48a, 0xf59df64c, 0xf49ff80e, 0xf2a1f9d0, 0xf1a3fb92, 0xf0a5fd54, 0xefa7ef08, },
			{0xa0b69134, 0x9fb892f6, 0x9eba94b8, 0x9cbc967a, 0x9bbe983c, 0x9ac099fe, 0x99c29bc0, 0x97c49d82, 0x96c68f36, },
			{0x47d53162, 0x46d73324, 0x45d934e6, 0x44db36a8, 0x43dd386b, 0x41df3a2d, 0x40e13bef, 0x3fe33db1, 0x3ee52f64, },
			{0xeaf2e18f, 0xe8f4e351, 0xe7f6e513, 0xe6f8e6d5, 0xe5fae897, 0xe3fcea59, 0xe2feec1b, 0xe1ff0ddd, 0xe0ff0f91, },
		},
		{
			{0x0e000030, 0x0c0011f2, 0x0b0213b4, 0x0a042576, 0x09062738, 0x070828fa, 0x060a2abc, 0x050c2c7e, 0x040e1e32, },
			{0xb51cc05e, 0xb41ec220, 0xb220c3e2, 0xb122c5a4, 0xb024c766, 0xaf26c928, 0xae28caea, 0xac2accac, 0xab2cbe60, },
			{0x5c3b608c, 0x5b3d624e, 0x5a3f6410, 0x594165d2, 0x57436794, 0x56456956, 0x55476b18, 0x54496cda, 0x524b5e8e, },
			{0x045a00ba, 0x025c027c, 0x015e043e, 0x00600600, 0xff6207c2, 0xfe640984, 0xfc660b46, 0xfb680d08, 0xfa69febc, },
			{0xab78a0e8, 0xaa7aa2aa, 0xa97ca46c, 0xa77ea62e, 0xa680a7f0, 0xa582a9b2, 0xa484ab74, 0xa286ad36, 0xa1889eea, },
			{0x52974116, 0x519942d8, 0x509b449a, 0x4f9d465c, 0x4e9f481e, 0x4ca149e0, 0x4ba34ba2, 0x4aa54d64, 0x49a73f18, },
			{0xfab5e144, 0xf9b7e306, 0xf7b9e4c8, 0xf6bbe68a, 0xf5bdf84c, 0xf4bffa0e, 0xf2c1fbd0, 0xf1c3fd92, 0xf0c5ef46, },
			{0xa1d49172, 0xa0d69334, 0x9fd894f6, 0x9eda96b8, 0x9cdc987a, 0x9bde9a3c, 0x9ae09bfe, 0x99e29dc0, 0x97e48f74, },
			{0x43f2319f, 0x42f43361, 0x41f63523, 0x40f846e5, 0x3ffa48a7, 0x3dfc4a69, 0x3cfe4c2b, 0x3bff0ded, 0x3aff0fa1, },
		},
		{
			{0x67000040, 0x66000202, 0x650173c4, 0x64037586, 0x62057748, 0x6107790a, 0x60097acc, 0x5f0b7c8e, 0x5e0d6e42, },
			{0x0f1c106e, 0x0e1e1230, 0x0c2013f2, 0x0b2215b4, 0x0a242776, 0x09262938, 0x07282afa, 0x062a2cbc, 0x052c1e70, },
			{0xb63ac09c, 0xb53cc25e, 0xb43ec420, 0xb240c5e2, 0xb142c7a4, 0xb044c966, 0xaf46cb28, 0xae48ccea, 0xac4abe9e, },
			{0x5e5960ca, 0x5c5b628c, 0x5b5d644e, 0x5a5f6610, 0x596167d2, 0x57636994, 0x56656b56, 0x55676d18, 0x54695ecc, },
			{0x057800f8, 0x047a02ba, 0x027c047c, 0x017e063e, 0x00800800, 0xff8209c2, 0xfe840b84, 0xfc860d46, 0xfb87fefa, },
			{0xac96a126, 0xab98a2e8, 0xaa9aa4aa, 0xa99ca66c, 0xa79ea82e, 0xa6a0a9f0, 0xa5a2abb2, 0xa4a4ad74, 0xa3a69f28, },
			{0x54b54154, 0x52b74316, 0x51b944d8, 0x50bb469a, 0x4fbd485c, 0x4ebf4a1e, 0x4cc14be0, 0x4bc34da2, 0x4ac53f56, },
			{0xfbd3e182, 0xfad5e344, 0xf9d7e506, 0xf7d9e6c8, 0xf6dbe88a, 0xf5ddfa4c, 0xf4dffc0e, 0xf2e1fdd0, 0xf1e3ef84, },
			{0x9df191af, 0x9cf39371, 0x9bf59533, 0x9af796f5, 0x98f998b7, 0x97fb9a79, 0x96fd9c3b, 0x95ff0dfd, 0x93ff0fb1, },
		},
		{
			{0xc100004f, 0xc0000211, 0xbf00d3d3, 0xbd02d595, 0xbc04d758, 0xbb06d91a, 0xba08dadc, 0xb90adc9e, 0xb70cce52, },
			{0x691b707e, 0x671d7240, 0x661f7402, 0x652175c4, 0x64237786, 0x62257948, 0x61277b0a, 0x60297ccc, 0x5f2b6e80, },
			{0x103a10ac, 0x0f3c126e, 0x0e3e1430, 0x0c4015f2, 0x0b4217b4, 0x0a442976, 0x09462b38, 0x07482cfa, 0x064a1eae, },
			{0xb758c0da, 0xb65ac29c, 0xb55cc45e, 0xb45ec620, 0xb260c7e2, 0xb162c9a4, 0xb064cb66, 0xaf66cd28, 0xae68bedc, },
			{0x5f776108, 0x5e7962ca, 0x5c7b648c, 0x5b7d664e, 0x5a7f6810, 0x598169d2, 0x57836b94, 0x56856d56, 0x55875f0a, },
			{0x06960136, 0x059802f8, 0x049a04ba, 0x029c067c, 0x019e083e, 0x00a00a00, 0xffa20bc2, 0xfea40d84, 0xfca5ff38, },
			{0xaeb4a164, 0xacb6a326, 0xabb8a4e8, 0xaabaa6aa, 0xa9bca86c, 0xa7beaa2e, 0xa6c0abf0, 0xa5c2adb2, 0xa4c49f66, },
			{0x55d34192, 0x54d54354, 0x52d74516, 0x51d946d8, 0x50db489a, 0x4fdd4a5c, 0x4edf4c1e, 0x4ce14de0, 0x4be33f94, },
			{0xf7f0f1bf, 0xf6f2f381, 0xf5f4f543, 0xf3f6f705, 0xf2f8f8c7, 0xf1fafa89, 0xf0fcfc4b, 0xeefefe0d, 0xedff0fc1, },
		},
		{
			{0x1b00005f, 0x1a000221, 0x190033e3, 0x170235a5, 0x16043767, 0x15063929, 0x14083aeb, 0x120a3cad, 0x110c2e61, },
			{0xc21ad08d, 0xc11cd24f, 0xc01ed411, 0xbf20d5d3, 0xbd22d795, 0xbc24d958, 0xbb26db1a, 0xba28dcdc, 0xb92ace8f, },
			{0x6a3970bc, 0x693b727e, 0x673d7440, 0x663f7602, 0x654177c4, 0x64437986, 0x62457b48, 0x61477d0a, 0x60496ebe, },
			{0x115810ea, 0x105a12ac, 0x0f5c146e, 0x0e5e1630, 0x0c6017f2, 0x0b6219b4, 0x0a642b76, 0x09662d38, 0x07681eec, },
			{0xb976c118, 0xb778c2da, 0xb67ac49c, 0xb57cc65e, 0xb47ec820, 0xb280c9e2, 0xb182cba4, 0xb084cd66, 0xaf86bf1a, },
			{0x60956146, 0x5f976308, 0x5e9964ca, 0x5c9b668c, 0x5b9d684e, 0x5a9f6a10, 0x59a16bd2, 0x57a36d94, 0x56a55f48, },
			{0x07b40174, 0x06b60336, 0x05b804f8, 0x04ba06ba, 0x02bc087c, 0x01be0a3e, 0x00c00c00, 0xffc20dc2, 0xfec3ff76, },
			{0xafd2a1a2, 0xaed4a364, 0xacd6a526, 0xabd8a6e8, 0xaadaa8aa, 0xa9dcaa6c, 0xa7deac2e, 0xa6e0adf0, 0xa5e29fa4, },
			{0x51f051cf, 0x50f25391, 0x4ef45553, 0x4df65715, 0x4cf858d7, 0x4bfa5a99, 0x4afc5c5b, 0x48fe5e1d, 0x47ff0fd1, },
		},
		{
			{0x7500006f, 0x74000231, 0x720003f3, 0x710195b5, 0x70039777, 0x6f059939, 0x6d079afb, 0x6c099cbd, 0x6b0b8e71, },
			{0x1c1a309d, 0x1b1c325f, 0x1a1e3421, 0x192035e3, 0x172237a5, 0x16243967, 0x15263b29, 0x14283ceb, 0x122a2e9f, },
			{0xc438d0cb, 0xc23ad28d, 0xc13cd44f, 0xc03ed611, 0xbf40d7d3, 0xbd42d995, 0xbc44db58, 0xbb46dd1a, 0xba48cecd, },
			{0x6b5770fa, 0x6a5972bc, 0x695b747e, 0x675d7640, 0x665f7802, 0x656179c4, 0x64637b86, 0x62657d48, 0x61676efc, },
			{0x12761128, 0x117812ea, 0x107a14ac, 0x0f7c166e, 0x0e7e1830, 0x0c8019f2, 0x0b821bb4, 0x0a842d76, 0x09861f2a, },
			{0xba94c156, 0xb996c318, 0xb798c4da, 0xb69ac69c, 0xb59cc85e, 0xb49eca20, 0xb2a0cbe2, 0xb1a2cda4, 0xb0a4bf58, },
			{0x61b36184, 0x60b56346, 0x5fb76508, 0x5eb966ca, 0x5cbb688c, 0x5bbd6a4e, 0x5abf6c10, 0x59c16dd2, 0x57c35f86, },
			{0x09d201b2, 0x07d40374, 0x06d60536, 0x05d806f8, 0x04da08ba, 0x02dc0a7c, 0x01de0c3e, 0x00e00e00, 0xffe1ffb4, },
			{0xabefb1df, 0xaaf1b3a1, 0xa8f3b563, 0xa7f5b725, 0xa6f7b8e7, 0xa5f9baa9, 0xa3fbbc6b, 0xa2fdbe2d, 0xa1ff0fe1, },
		},
		{
			{0xc400007f, 0xc3000241, 0xc1000403, 0xc000f5c5, 0xbf02f787, 0xbe04f949, 0xbc06fb0b, 0xbb08fccd, 0xba0aee81, },
			{0x6b1990ad, 0x6a1b926f, 0x691d9431, 0x681f95f3, 0x662197b5, 0x65239977, 0x64259b39, 0x63279cfb, 0x61298eaf, },
			{0x133830db, 0x113a329d, 0x103c345f, 0x0f3e3621, 0x0e4037e3, 0x0d4239a5, 0x0b443b67, 0x0a463d29, 0x09482edd, },
			{0xba56d109, 0xb958d2cb, 0xb85ad48d, 0xb65cd64f, 0xb55ed811, 0xb460d9d3, 0xb362db95, 0xb164dd57, 0xb066cf0b, },
			{0x61757137, 0x607782f9, 0x5f7984bb, 0x5e7b867d, 0x5d7d883f, 0x5b7f8a01, 0x5a818bc3, 0x59838d85, 0x58857f39, },
			{0x09942165, 0x08962327, 0x069824e9, 0x059a26ab, 0x049c286d, 0x039e2a2f, 0x01a02bf1, 0x00a22db3, 0xffa41f67, },
			{0xb0b2c193, 0xafb4c355, 0xaeb6c517, 0xadb8c6d9, 0xabbac89b, 0xaabcca5d, 0xa9becc1f, 0xa8c0cde1, 0xa6c2bf95, },
			{0x58d161c1, 0x56d36383, 0x55d56545, 0x54d76707, 0x53d968c9, 0x51db6a8b, 0x50dd6c4d, 0x4fdf6e0f, 0x4ee15fc3, },
			{0xf0ef11ee, 0xf0f113b0, 0xf0f31572, 0xf0f51734, 0xf0f718f6, 0xf0f91ab8, 0xf0fb1c7a, 0xf0fd1e3c, 0xf0ff0ff0, },
		},
	};

	static u32 lcp_gmp_lut_table_high4bit[9][9][9] = {
		{
			{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
			{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, },
			{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
			{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
			{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, },
			{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
			{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
			{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
		},
		{
			{0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
			{0x2, 0x2, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, },
			{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, },
			{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
			{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
			{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
		},
		{
			{0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, 0x2, },
			{0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
			{0x4, 0x4, 0x4, 0x3, 0x3, 0x3, 0x3, 0x3, 0x3, },
			{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
			{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
			{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
		},
		{
			{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
			{0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, 0x4, },
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x6, 0x6, 0x6, 0x6, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
			{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
			{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
			{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
		},
		{
			{0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, 0x5, },
			{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
			{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
			{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x7, 0x7, 0x7, 0x7, },
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
			{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
			{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
		},
		{
			{0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, 0x6, },
			{0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, 0x7, },
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
			{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0x9, 0x9, 0x9, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
			{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
			{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
		},
		{
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
			{0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, 0x8, },
			{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
			{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
			{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xb, 0xb, },
			{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
			{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
		},
		{
			{0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, 0x9, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
			{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
			{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
			{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
			{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
			{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xd, },
			{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, },
		},
		{
			{0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, 0xa, },
			{0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, 0xb, },
			{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
			{0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, 0xc, },
			{0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, 0xd, },
			{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xd, },
			{0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, 0xe, },
			{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
			{0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, 0xf, },
		},
	};




/*******************************************************************************
** XCC
*/
static u32 xcc_table[12] = {0x0, 0x8000, 0x0,0x0,0x0,0x0,0x8000,0x0,0x0,0x0,0x0,0x8000,};

static u32 g_samsung_pcd_record=0;


static ssize_t set_color_enhance_mode(struct hisi_fb_data_type *hisifd, int flag);

#ifdef AMOLED_CHECK_INT
static irqreturn_t pcd_irq_isr_func(int irq, void *handle)
{
	if (gpio_get_value(gpio_lcd_pcd) == 1) {
		HISI_FB_INFO("pcd detect!\n");
		g_samsung_pcd_record++;
	} else {
		HISI_FB_DEBUG("no pcd detect!\n");
	}

	return IRQ_HANDLED;
}

static irqreturn_t errflag_irq_isr_func(int irq, void *handle)
{
	if (gpio_get_value(gpio_lcd_err_flag) == 1) {
		HISI_FB_INFO("err_flag detect!\n");
	} else {
		HISI_FB_DEBUG("no err_flag detect!\n");
	}

	return IRQ_HANDLED;
}

static void amoled_irq_enable(void)
{
	enable_irq(gpio_to_irq(gpio_lcd_pcd));
	enable_irq(gpio_to_irq(gpio_lcd_err_flag));
}

static void amoled_irq_disable(void)
{
	disable_irq(gpio_to_irq(gpio_lcd_pcd));
	disable_irq(gpio_to_irq(gpio_lcd_err_flag));
}
#endif

/*******************************************************************************
**
*/
static int mipi_samsung_S6E3HA3X02_panel_set_fastboot(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	/* lcd pinctrl normal */
	pinctrl_cmds_tx(pdev, lcd_pinctrl_normal_cmds,
		ARRAY_SIZE(lcd_pinctrl_normal_cmds));

	/* lcd gpio request */
	gpio_cmds_tx(lcd_gpio_request_cmds,
		ARRAY_SIZE(lcd_gpio_request_cmds));

	/* backlight on */
	hisi_lcd_backlight_on(pdev);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return 0;
}

static int mipi_samsung_S6E3HA3X02_panel_on(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;
	struct hisi_panel_info *pinfo = NULL;
	char __iomem *mipi_dsi0_base = NULL;
	char __iomem *dpp_base = NULL;
	char __iomem *acm_base = NULL;

	int error = 0;
	char acl_mode_sel[] = {0x55,0x00,};
	struct dsi_cmd_desc acl_enable_cmds[] = {
		{DTYPE_DCS_WRITE1, 0, 200, WAIT_TYPE_US,
			sizeof(acl_mode_sel), acl_mode_sel},
	};
#if defined (CONFIG_HUAWEI_DSM)
	static struct lcd_reg_read_t lcd_status_reg[] = {
		{0x0A, 0xB4, 0xFF, "lcd power state"},
	};
#endif

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_INFO("fb%d, +!\n", hisifd->index);

	pinfo = &(hisifd->panel_info);
	mipi_dsi0_base = hisifd->mipi_dsi0_base;
	dpp_base = hisifd->dss_base + DSS_DPP_OFFSET;
	acm_base = hisifd->dss_base + DSS_DPP_ACM_OFFSET;


	if (pinfo->lcd_init_step == LCD_INIT_POWER_ON) {
		HISI_FB_INFO("Init power on.\n");
		/* lcd pinctrl normal */
		pinctrl_cmds_tx(pdev, lcd_pinctrl_normal_cmds,
			ARRAY_SIZE(lcd_pinctrl_normal_cmds));
		/* lcd gpio request */
		gpio_cmds_tx(lcd_gpio_request_cmds, \
			ARRAY_SIZE(lcd_gpio_request_cmds));

		/* lcd gpio normal 1.8v */
		gpio_cmds_tx(lcd_gpio_normal_cmds, \
			ARRAY_SIZE(lcd_gpio_normal_cmds));

		gpio_cmds_tx(lcd_gpio_reset_high_cmds, \
			ARRAY_SIZE(lcd_gpio_reset_high_cmds));

		/* lcd vcc enable 3.3v */
		vcc_cmds_tx(pdev, lcd_vcc_enable_cmds,
			ARRAY_SIZE(lcd_vcc_enable_cmds));

		pinfo->lcd_init_step = LCD_INIT_MIPI_LP_SEND_SEQUENCE;
	} else if (pinfo->lcd_init_step == LCD_INIT_MIPI_LP_SEND_SEQUENCE) {
		HISI_FB_INFO("Init lcd_init_step is lp send mode.\n");

#ifdef CONFIG_HUAWEI_TS
		if (TP_RS_CALL != g_debug_enable_lcd_sleep_in) { //control touch timing
			HISI_FB_INFO("TP resume and after resume\n");
			error = ts_power_control_notify(TS_RESUME_DEVICE, SHORT_SYNC_TIMEOUT);
			error = ts_power_control_notify(TS_AFTER_RESUME, NO_SYNC_TIMEOUT);
		}
#endif
		/* lcd gpio normal */
		mdelay(10);
		gpio_cmds_tx(lcd_gpio_reset_cmds, \
			ARRAY_SIZE(lcd_gpio_reset_cmds));

		mipi_dsi_cmds_tx(display_on_cmds, \
			ARRAY_SIZE(display_on_cmds), mipi_dsi0_base);
		g_acl_ctrl = 2;
		g_hbm_ctrl = 0;
		if(runmode_is_factory()) {
			HISI_FB_INFO("Factory mode, disable acl.\n");
			mipi_dsi_cmds_tx(acl_enable_cmds, \
				ARRAY_SIZE(acl_enable_cmds), mipi_dsi0_base);
			g_acl_ctrl = 0;
		}

#if defined (CONFIG_HUAWEI_DSM)
		panel_check_status_and_report_by_dsm(lcd_status_reg, \
			ARRAY_SIZE(lcd_status_reg), mipi_dsi0_base);
#endif
		g_debug_enable = true;
		pinfo->lcd_init_step = LCD_INIT_MIPI_HS_SEND_SEQUENCE;
	} else if (pinfo->lcd_init_step == LCD_INIT_MIPI_HS_SEND_SEQUENCE) {

		/*this project: 0 means using sRGB, 1 means using color_enhance*/
		/*when panel on , only need open /close*/
		if(!runmode_is_factory()) {
			HISI_FB_INFO("color_enhancement mode g_color_enhancement_mode = %d!\n", g_color_enhancement_mode);
			if (g_color_enhancement_mode == COLOR_EN_DEFAULT)
			{
				/*open acm*/
				set_reg(acm_base + ACM_EN, 0x1, 32, 0); //open acm

				/*close gmp*/
				set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
			}
			else if (g_color_enhancement_mode == COLOR_EN_SRGB)
			{
				/*open acm*/
				set_reg(acm_base + ACM_EN, 0x1, 1, 0); //open acm

				/*open gmp*/
				set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x0, 1, 0);	//enable gmp
			}
			else if (g_color_enhancement_mode == COLOR_EN_CLOSED)
			{
				/*close acm*/
				set_reg(acm_base + ACM_EN, 0x0, 1, 0); //close acm

				/*close gmp*/
				set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
			}
			else
			{
				HISI_FB_INFO(" no this color_enhancement mode!\n");
			}
		}

		HISI_FB_INFO("Init hs send data mode.\n");
#ifdef AMOLED_CHECK_INT
		amoled_irq_enable();
#endif
	} else {
		HISI_FB_ERR("failed to init lcd!\n");
	}

	/* backlight on */
	/* hisi_lcd_backlight_on(pdev); */

	HISI_FB_INFO("fb%d, -!\n", hisifd->index);

	return 0;
}

static int mipi_samsung_S6E3HA3X02_panel_off(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;
	struct hisi_panel_info *pinfo = NULL;
	int error = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_INFO("fb%d, +!\n", hisifd->index);

	pinfo = &(hisifd->panel_info);

#ifdef AMOLED_CHECK_INT
	amoled_irq_disable();
#endif

	if (pinfo->lcd_uninit_step == LCD_UNINIT_MIPI_HS_SEND_SEQUENCE) {
		HISI_FB_INFO("display off(download display off sequence).\n");
		/* backlight off */
		/* hisi_lcd_backlight_off(pdev); */

		/* lcd display off sequence */
		mipi_dsi_cmds_tx(display_off_cmds, \
			ARRAY_SIZE(display_off_cmds), hisifd->mipi_dsi0_base);

		pinfo->lcd_uninit_step = LCD_UNINIT_MIPI_LP_SEND_SEQUENCE;
	} else if (pinfo->lcd_uninit_step == LCD_UNINIT_MIPI_LP_SEND_SEQUENCE) {
		pinfo->lcd_uninit_step = LCD_UNINIT_POWER_OFF;
	} else if (pinfo->lcd_uninit_step == LCD_UNINIT_POWER_OFF) {
		if (!hisifd->fb_shutdown) {
			HISI_FB_INFO("display off(regulator disabling).\n");
			/* lcd gpio lowpower */
			gpio_cmds_tx(lcd_gpio_lowpower_reset_cmds, \
				ARRAY_SIZE(lcd_gpio_lowpower_reset_cmds));
			/* lcd vcc disable */
			vcc_cmds_tx(pdev, lcd_vcc_disable_cmds,
				ARRAY_SIZE(lcd_vcc_disable_cmds));
			/* lcd gpio lowpower */
			gpio_cmds_tx(lcd_gpio_lowpower_1V8_cmds, \
				ARRAY_SIZE(lcd_gpio_lowpower_1V8_cmds));
			/* lcd gpio free */
			gpio_cmds_tx(lcd_gpio_free_cmds, \
				ARRAY_SIZE(lcd_gpio_free_cmds));
			/* lcd pinctrl lowpower */
			pinctrl_cmds_tx(pdev, lcd_pinctrl_lowpower_cmds,
				ARRAY_SIZE(lcd_pinctrl_lowpower_cmds));

		}else {
			HISI_FB_INFO("display shutting down(regulator disabling).\n");
			HISI_FB_INFO("display off(regulator disabling).\n");
			/* lcd gpio lowpower */
			gpio_cmds_tx(lcd_gpio_lowpower_reset_cmds, \
				ARRAY_SIZE(lcd_gpio_lowpower_reset_cmds));
			/* lcd vcc disable */
			vcc_cmds_tx(pdev, lcd_vcc_disable_cmds,
				ARRAY_SIZE(lcd_vcc_disable_cmds));
			/* lcd gpio lowpower */
			gpio_cmds_tx(lcd_gpio_lowpower_1V8_cmds, \
				ARRAY_SIZE(lcd_gpio_lowpower_1V8_cmds));
			/* lcd gpio free */
			gpio_cmds_tx(lcd_gpio_free_cmds, \
				ARRAY_SIZE(lcd_gpio_free_cmds));
			/* lcd pinctrl lowpower */
			pinctrl_cmds_tx(pdev, lcd_pinctrl_lowpower_cmds,
				ARRAY_SIZE(lcd_pinctrl_lowpower_cmds));
		}

#ifdef CONFIG_HUAWEI_TS
			/*if g_debug_enable_lcd_sleep_in == 1, it means don't turn off TP/LCD power
			but only let lcd get into sleep.*/
			if (TP_RS_CALL != g_debug_enable_lcd_sleep_in) {
				HISI_FB_INFO("TP before suspend and suspend\n");
				error = ts_power_control_notify(TS_BEFORE_SUSPEND, SHORT_SYNC_TIMEOUT);
				error = ts_power_control_notify(TS_SUSPEND_DEVICE, SHORT_SYNC_TIMEOUT);
			}
#endif

	} else {
		HISI_FB_ERR("failed to uninit lcd!\n");
	}
	HISI_FB_INFO("fb%d, -!\n", hisifd->index);

	return 0;
}

static int mipi_samsung_S6E3HA3X02_panel_remove(struct platform_device *pdev)
{
	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	/* lcd vcc finit */
	vcc_cmds_tx(pdev, lcd_vcc_finit_cmds,
		ARRAY_SIZE(lcd_vcc_finit_cmds));

	/* lcd pinctrl finit */
	pinctrl_cmds_tx(pdev, lcd_pinctrl_finit_cmds,
		ARRAY_SIZE(lcd_pinctrl_finit_cmds));

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return 0;
}

static int mipi_samsung_S6E3HA3X02_panel_set_backlight(struct platform_device *pdev, uint32_t bl_level)
{
	char __iomem *mipi_dsi0_base = NULL;
	struct hisi_fb_data_type *hisifd = NULL;
	int ret = 0;
	static char last_bl_level=0;
	char bl_level_adjust[2] = {
		0x51,
		0x00,
	};

	struct dsi_cmd_desc lcd_bl_level_adjust[] = {
		{DTYPE_DCS_WRITE1, 0, 100, WAIT_TYPE_US,
			sizeof(bl_level_adjust), bl_level_adjust},
	};

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	if (unlikely(g_debug_enable)) {
		HISI_FB_INFO("Power on, First set brightness to %d\n", bl_level);
		g_debug_enable = false;
	}

	HISI_FB_INFO("Set brightness to %d\n", bl_level);

	if (hisifd->panel_info.bl_set_type & BL_SET_BY_PWM) {
		ret = hisi_pwm_set_backlight(hisifd, bl_level);
	} else if (hisifd->panel_info.bl_set_type & BL_SET_BY_BLPWM) {
		ret = hisi_blpwm_set_backlight(hisifd, bl_level);
	} else if (hisifd->panel_info.bl_set_type & BL_SET_BY_MIPI) {
		mipi_dsi0_base = hisifd->mipi_dsi0_base;

		bl_level_adjust[1] = bl_level * 255 / hisifd->panel_info.bl_max;
		if (last_bl_level != bl_level_adjust[1]){
			last_bl_level = bl_level_adjust[1];
			mipi_dsi_cmds_tx(lcd_bl_level_adjust, \
				ARRAY_SIZE(lcd_bl_level_adjust), mipi_dsi0_base);
		}
	} else {
		HISI_FB_ERR("No such bl_set_type!\n");
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}


/******************************************************************************/
static ssize_t mipi_samsung_S6E3HA3X02_panel_model_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	if(runmode_is_factory()) {
		ret = snprintf(buf, PAGE_SIZE, "samsung_S6E3HA3X02 6.62' CMD TFT\n");
	} else {
		ret = snprintf(buf, PAGE_SIZE, "6.62' CMD TFT\n");
	}

		HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_samsung_panel_info_show(struct platform_device *pdev, char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("pdev NULL pointer\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("hisifd NULL pointer\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);
	if (buf) {
		ret = snprintf(buf, PAGE_SIZE, "blmax:%u,blmin:%u,lcdtype:%s,\n",
				hisifd->panel_info.bl_max, hisifd->panel_info.bl_min, "AMOLED");
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static char lcd_disp_x[] = {
	0x2A,
	0x00, 0x00,0x04,0x37
};

static char lcd_disp_y[] = {
	0x2B,
	0x00, 0x00,0x07,0x7F
};

static struct dsi_cmd_desc set_display_address[] = {
	{DTYPE_DCS_LWRITE, 0, 5, WAIT_TYPE_US,
		sizeof(lcd_disp_x), lcd_disp_x},
	{DTYPE_DCS_LWRITE, 0, 5, WAIT_TYPE_US,
		sizeof(lcd_disp_y), lcd_disp_y},
};

static int mipi_samsung_panel_set_display_region(struct platform_device *pdev,
	struct dss_rect *dirty)
{
	struct hisi_fb_data_type *hisifd = NULL;

	BUG_ON(pdev == NULL || dirty == NULL);
	hisifd = platform_get_drvdata(pdev);
	BUG_ON(hisifd == NULL);

	lcd_disp_x[1] = (dirty->x >> 8) & 0xff;
	lcd_disp_x[2] = dirty->x & 0xff;
	lcd_disp_x[3] = ((dirty->x + dirty->w - 1) >> 8) & 0xff;
	lcd_disp_x[4] = (dirty->x + dirty->w - 1) & 0xff;
	lcd_disp_y[1] = (dirty->y >> 8) & 0xff;
	lcd_disp_y[2] = dirty->y & 0xff;
	lcd_disp_y[3] = ((dirty->y + dirty->h - 1) >> 8) & 0xff;
	lcd_disp_y[4] = (dirty->y + dirty->h - 1) & 0xff;

	HISI_FB_DEBUG("x[1] = 0x%2x, x[2] = 0x%2x, x[3] = 0x%2x, x[4] = 0x%2x.\n",
		lcd_disp_x[1], lcd_disp_x[2], lcd_disp_x[3], lcd_disp_x[4]);
	HISI_FB_DEBUG("y[1] = 0x%2x, y[2] = 0x%2x, y[3] = 0x%2x, y[4] = 0x%2x.\n",
		lcd_disp_y[1], lcd_disp_y[2], lcd_disp_y[3], lcd_disp_y[4]);

	mipi_dsi_cmds_tx(set_display_address, \
		ARRAY_SIZE(set_display_address), hisifd->mipi_dsi0_base);

	return 0;
}

static ssize_t mipi_samsung_S6E3HA3X02_panel_hbm_ctrl_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_hbm_ctrl);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_samsung_S6E3HA3X02_panel_hbm_ctrl_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	struct hisi_fb_data_type *hisifd = NULL;
	char __iomem *mipi_dsi0_base = NULL;
	unsigned int value[100];
	char *token, *cur;
	int i = 0;
	char payload_hbm_para[5] = {0};
	struct dsi_cmd_desc hbm_debug_cmd[] = {
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_enable), test_key_enable},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(payload_hbm_para), payload_hbm_para},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_disable), test_key_disable},
	};
	char payload_hbm_switch[2] = {0};
	struct dsi_cmd_desc hbm_switch_cmd[] = {
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_enable), test_key_enable},
		{DTYPE_DCS_WRITE1, 0, 200, WAIT_TYPE_US,
			sizeof(payload_hbm_switch), payload_hbm_switch},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_disable), test_key_disable},
	};

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	if (NULL == buf) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}
	mipi_dsi0_base = hisifd->mipi_dsi0_base;
	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	cur = buf;
	while (token = strsep(&cur, ",")) {
		value[i++] = simple_strtol(token, NULL, 0);
	}

	down(&hisifd->blank_sem);
	if (!hisifd->panel_power_on) {
		HISI_FB_INFO("panel off, power on first\n");
		goto hbm_set_err;
	}

	hisifb_activate_vsync(hisifd);
	if (HBM_DEBUG == value[0]) { /* debug */
		hbm_debug_cmd[1].payload[0] = 0xb4;
		hbm_debug_cmd[1].payload[1] = value[1];
		hbm_debug_cmd[1].payload[2] = value[2];
		hbm_debug_cmd[1].payload[3] = value[3];
		hbm_debug_cmd[1].payload[4] = value[4];
		mipi_dsi_cmds_tx(hbm_debug_cmd, ARRAY_SIZE(hbm_debug_cmd), mipi_dsi0_base);
	} else if (HBM_SETTING == value[0]) {
		if (HBM_OFF == value[1]) {
			hbm_switch_cmd[1].payload[0] = 0x53;
			hbm_switch_cmd[1].payload[1] = (0x20 & 0xff);
			mipi_dsi_cmds_tx(hbm_switch_cmd, ARRAY_SIZE(hbm_switch_cmd), mipi_dsi0_base);
			g_hbm_ctrl = HBM_OFF;
			HISI_FB_INFO("HBM OFF\n");
		} else if (HBM_ON == value[1]) {
			hbm_switch_cmd[1].payload[0] = 0x53;
			hbm_switch_cmd[1].payload[1] = ((0x20 | 0xc0) & 0xff);
			mipi_dsi_cmds_tx(hbm_switch_cmd, ARRAY_SIZE(hbm_switch_cmd), mipi_dsi0_base);
			g_hbm_ctrl = HBM_ON;
			HISI_FB_INFO("HBM ON\n");
		} else {
			HISI_FB_INFO("invalid parm!\n");
		}
	} else {
		HISI_FB_INFO("invalid parm!\n");
	}
	hisifb_deactivate_vsync(hisifd);

hbm_set_err:
	up(&hisifd->blank_sem);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);
	return count;
}

static ssize_t mipi_samsung_S6E3HA3X02_panel_acl_ctrl_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_acl_ctrl);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_samsung_S6E3HA3X02_panel_acl_ctrl_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	struct hisi_fb_data_type *hisifd = NULL;
	char __iomem *mipi_dsi0_base = NULL;
	unsigned int value[100];
	char *token, *cur;
	int i = 0;
	char payload_acl_para[6] = {0};
	struct dsi_cmd_desc acl_debug_cmd[] = {
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_enable), test_key_enable},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(payload_acl_para), payload_acl_para},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_disable), test_key_disable},
	};
	char payload_acl_switch[2] = {0};
	struct dsi_cmd_desc acl_switch_cmd[] = {
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_enable), test_key_enable},
		{DTYPE_DCS_WRITE1, 0, 200, WAIT_TYPE_US,
			sizeof(payload_acl_switch), payload_acl_switch},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_disable), test_key_disable},
	};

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	if (NULL == buf) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}
	mipi_dsi0_base = hisifd->mipi_dsi0_base;
	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	cur = buf;
	while (token = strsep(&cur, ",")) {
		value[i++] = simple_strtol(token, NULL, 0);
	}

	if (ACL_DEBUG == value[0]) { /* debug */
		acl_debug_cmd[1].payload[0] = 0xb4;
		acl_debug_cmd[1].payload[1] = 0x50;
		acl_debug_cmd[1].payload[2] = value[1];
		acl_debug_cmd[1].payload[3] = value[2];
		acl_debug_cmd[1].payload[4] = value[3];
		acl_debug_cmd[1].payload[5] = value[4];
		mipi_dsi_cmds_tx(acl_debug_cmd, ARRAY_SIZE(acl_debug_cmd), mipi_dsi0_base);
	} else if (ACL_SETTING == value[0]) {
		if (ACL_OFF == value[1]) {
			acl_switch_cmd[1].payload[0] = 0x55;
			acl_switch_cmd[1].payload[1] = ACL_OFF;
			mipi_dsi_cmds_tx(acl_switch_cmd, ARRAY_SIZE(acl_switch_cmd), mipi_dsi0_base);
			g_acl_ctrl = ACL_OFF;
			HISI_FB_INFO("ACL OFF\n");
		} else if (ACL_OFFSET1_ON == value[1]) {
			acl_switch_cmd[1].payload[0] = 0x55;
			acl_switch_cmd[1].payload[1] = ACL_OFFSET1_ON;
			mipi_dsi_cmds_tx(acl_switch_cmd, ARRAY_SIZE(acl_switch_cmd), mipi_dsi0_base);
			g_acl_ctrl = ACL_OFFSET1_ON;
			HISI_FB_INFO("ACL OFFSET 1 ON\n");
		} else if (ACL_OFFSET2_ON == value[1]) {
			acl_switch_cmd[1].payload[0] = 0x55;
			acl_switch_cmd[1].payload[1] = ACL_OFFSET2_ON;
			mipi_dsi_cmds_tx(acl_switch_cmd, ARRAY_SIZE(acl_switch_cmd), mipi_dsi0_base);
			g_acl_ctrl = ACL_OFFSET2_ON;
			HISI_FB_INFO("ACL OFFSET 2 ON\n");
		} else if (ACL_OFFSET3_ON == value[1]) {
			acl_switch_cmd[1].payload[0] = 0x55;
			acl_switch_cmd[1].payload[1] = ACL_OFFSET3_ON;
			mipi_dsi_cmds_tx(acl_switch_cmd, ARRAY_SIZE(acl_switch_cmd), mipi_dsi0_base);
			g_acl_ctrl = ACL_OFFSET3_ON;
			HISI_FB_INFO("ACL OFFSET 3 ON\n");
		} else {
			HISI_FB_INFO("invalid parm!\n");
		}
	} else {
		HISI_FB_INFO("invalid parm!\n");
	}
	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);
	return count;
}

/*for esd check*/
static int mipi_samsung_S6E3HA3X02_panel_check_esd(struct platform_device* pdev)
{
	int ret = 0, errflag_detect = 0, status_reg_detect = 0;
	struct hisi_fb_data_type* hisifd = NULL;

	uint32_t read_value[2] = {0,0};
	uint32_t expected_value[2] = {0xB4,0x80};
	uint32_t read_mask[2] = {0xff,0xff};
	char* reg_name[2] = {"power mode","te mode"};
	char lcd_reg_0a[] = {0x0a};
	char lcd_reg_0e[] = {0x0e};

	struct dsi_cmd_desc lcd_check_reg[] = {
		{DTYPE_DCS_READ, 0, 10, WAIT_TYPE_US,
			sizeof(lcd_reg_0a), lcd_reg_0a},
		{DTYPE_DCS_READ, 0, 10, WAIT_TYPE_US,
			sizeof(lcd_reg_0e), lcd_reg_0e},
	};

	struct mipi_dsi_read_compare_data data = {
		.read_value = read_value,
		.expected_value = expected_value,
		.read_mask = read_mask,
		.reg_name = reg_name,
		.log_on = 0,
		.cmds = lcd_check_reg,
		.cnt = ARRAY_SIZE(lcd_check_reg),
	};

	struct dsi_cmd_desc pkt_size_cmd;

	memset(&pkt_size_cmd, 0, sizeof(struct dsi_cmd_desc));
	pkt_size_cmd.dtype = DTYPE_MAX_PKTSIZE;
	pkt_size_cmd.dlen = 1;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer\n");
		return 0;
	}

	hisifd = (struct hisi_fb_data_type*)platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer\n");
		return 0;
	}

	if (NULL == hisifd->mipi_dsi0_base) {
		HISI_FB_ERR("NULL Pointer\n");
		return 0;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);
	if (gpio_get_value(gpio_lcd_err_flag) == 1) {
		HISI_FB_INFO("esd err_flag detect!\n");
		errflag_detect = 1;
		return errflag_detect;
	} else {
		HISI_FB_DEBUG("no err_flag detect!\n");
		errflag_detect = 0;
	}

	/*we need 20 ms time to ensure that read 0A normal*/
	mdelay(20);
	mipi_dsi_max_return_packet_size(&pkt_size_cmd, hisifd->mipi_dsi0_base);
	ret = mipi_dsi_read_compare(&data, hisifd->mipi_dsi0_base);
	if (!ret) {
		status_reg_detect = 0;
	} else if (read_value[0] || read_value[1]) {
		status_reg_detect = 1;
		HISI_FB_INFO("esd 0A detect abnormal:%02x\n", read_value[0]);
		HISI_FB_INFO("esd 0E detect abnormal:%02x\n", read_value[1]);
		return status_reg_detect;
	} else {
		status_reg_detect = 1;
		HISI_FB_INFO("esd detect mipi err ret = %d\n",ret);
	}

	ret = errflag_detect + status_reg_detect;
	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_samsung_pcd_errflag_check(struct platform_device *pdev,
	char *buf)
{
	ssize_t ret = 0;
	u8 result_value = 0;
	int errflag_gpio = 0;

	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		ret = snprintf(buf, PAGE_SIZE, "%d\n", result_value);
		return ret;
	}

	hisifd = platform_get_drvdata(pdev);
	if (!hisifd) {
		HISI_FB_ERR("hisifd is null\n");
		ret = snprintf(buf, PAGE_SIZE, "%d\n", result_value);
		return ret;
	}

	if (!hisifd->panel_power_on) {
		HISI_FB_INFO("panel is poweroff\n");
		ret = snprintf(buf, PAGE_SIZE, "%d\n", result_value);
		return ret;
	}

	errflag_gpio = gpio_get_value(gpio_lcd_err_flag);
	HISI_FB_INFO("pcd:%u, errflag:%u\n", g_samsung_pcd_record, errflag_gpio);

	if (!g_samsung_pcd_record && !errflag_gpio) {
		result_value = 0; /* PCD_ERR_FLAG_SUCCESS */
	} else if (g_samsung_pcd_record && !errflag_gpio) {
		result_value = 1; /* only  PCD_FAIL */
	} else if (!g_samsung_pcd_record && errflag_gpio) {
		result_value = 2; /* only ERRFLAG FAIL */
	} else if (g_samsung_pcd_record && errflag_gpio) {
		result_value = 3; /* PCD_ERR_FLAG_FAIL */
	} else {
		result_value = 0;
	}

	g_samsung_pcd_record = 0;

	ret = snprintf(buf, PAGE_SIZE, "%d\n", result_value);
	return ret;
}

static int g_support_mode = 0;
static ssize_t mipi_samsung_panel_support_mode_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return ret;
	}

	hisifd = platform_get_drvdata(pdev);
	if (!hisifd) {
		HISI_FB_ERR("hisifd is null\n");
		return ret;
	}

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_support_mode);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_samsung_panel_support_mode_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	unsigned long val = 0;
	int flag = -1;
	struct hisi_fb_data_type *hisifd = NULL;

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return ret;
	}

	hisifd = platform_get_drvdata(pdev);
	if (!hisifd) {
		HISI_FB_ERR("hisifd is null\n");
		return ret;
	}

	ret = strict_strtoul(buf, 0, &val);
	if (ret)
               return ret;

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	flag = (int)val;

	g_support_mode = flag;

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return count;
}


/*because of  architecture limitation,  just use this sys node to control acm and gmp */
static ssize_t mipi_samsung_panel_lcd_ic_color_enhancement_mode_show(struct platform_device *pdev,
	char *buf)
{
	struct hisi_fb_data_type *hisifd = NULL;
	ssize_t ret = 0;

	BUG_ON(pdev == NULL);
	hisifd = platform_get_drvdata(pdev);
	BUG_ON(hisifd == NULL);

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);



	ret = snprintf(buf, PAGE_SIZE, "%d\n", g_color_enhancement_mode);

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return ret;
}

static ssize_t mipi_samsung_panel_lcd_ic_color_enhancement_mode_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	int ret = 0;
	unsigned long val = 0;
	int flag=-1;
	struct hisi_fb_data_type *hisifd = NULL;



	BUG_ON(pdev == NULL);
	hisifd = platform_get_drvdata(pdev);
	BUG_ON(hisifd == NULL);


	ret = strict_strtoul(buf, 0, &val);
	if (ret)
        return ret;

	HISI_FB_DEBUG("fb%d, +.\n", hisifd->index);

	flag=(int)val;

	HISI_FB_INFO("fb%d, set val = %d", hisifd->index, flag);

	ret = set_color_enhance_mode(hisifd, flag);

	if (ret != 0)
	{
		HISI_FB_ERR("fb%d, Set color mode failed.\n", hisifd->index);
	}
	else
	{
		HISI_FB_INFO("fb%d, Set color mode success.\n", hisifd->index);
	}

	HISI_FB_DEBUG("fb%d, -.\n", hisifd->index);

	return snprintf((char *)buf, count, "%d\n", g_color_enhancement_mode);
}

static ssize_t set_color_enhance_mode(struct hisi_fb_data_type *hisifd, int flag)
{
	char __iomem *mipi_dsi0_base = NULL;
	char __iomem *dpp_base = NULL;
	char __iomem *acm_base = NULL;

	mipi_dsi0_base = hisifd->mipi_dsi0_base;
	dpp_base = hisifd->dss_base + DSS_DPP_OFFSET;
	acm_base = hisifd->dss_base + DSS_DPP_ACM_OFFSET;

	HISI_FB_INFO(" set_color_enhance_mode, mode=%d!+\n",flag);

	/*this project: 0 means using sRGB, 1 means using color_enhance*/
	if (flag == COLOR_EN_DEFAULT)
	{

		hisifd->panel_info.acm_lut_hue_table = ce_acm_lut_hue_table;
		hisifd->panel_info.acm_lut_hue_table_len = ARRAY_SIZE(ce_acm_lut_hue_table);
		hisifd->panel_info.acm_lut_sata_table = ce_acm_lut_sata_table;
		hisifd->panel_info.acm_lut_sata_table_len = ARRAY_SIZE(ce_acm_lut_sata_table);
		hisifd->panel_info.acm_lut_satr_table = ce_acm_lut_satr_table;
		hisifd->panel_info.acm_lut_satr_table_len = ARRAY_SIZE(ce_acm_lut_satr_table);

		set_reg(hisifd->dss_base + DSS_DPP_RD_SHADOW_OFFSET, 0x1, 1, 0);

		/*close acm*/
		set_reg(acm_base + ACM_EN, 0x0, 1, 0); //open acm
		mdelay(20);
		if (ce_acm_lut_hue_table != NULL && ARRAY_SIZE(ce_acm_lut_hue_table) > 0) {
			acm_set_lut_hue(dpp_base + ACM_LUT_HUE, ce_acm_lut_hue_table, ARRAY_SIZE(ce_acm_lut_hue_table));
		} else {
			HISI_FB_ERR("fb%d, acm_lut_hue_table is NULL or acm_lut_hue_table_len less than 0!\n", hisifd->index);
			return 1;
		}

		if (ce_acm_lut_sata_table != NULL && ARRAY_SIZE(ce_acm_lut_sata_table) > 0) {
			acm_set_lut(dpp_base + ACM_LUT_SATA, ce_acm_lut_sata_table, ARRAY_SIZE(ce_acm_lut_sata_table));
		} else {
			HISI_FB_ERR("fb%d, acm_lut_sata_table is NULL or acm_lut_sata_table_len less than 0!\n", hisifd->index);
			return 1;
		}

		if (ce_acm_lut_satr_table != NULL && ARRAY_SIZE(ce_acm_lut_satr_table) > 0) {
			acm_set_lut(dpp_base + ACM_LUT_SATR, ce_acm_lut_satr_table, ARRAY_SIZE(ce_acm_lut_satr_table));
		} else {
			HISI_FB_ERR("fb%d, acm_lut_satr_table is NULL or acm_lut_satr_table_len less than 0!\n", hisifd->index);
			return 1;
		}



		/*open acm*/
		set_reg(acm_base + ACM_EN, 0x1, 32, 0); //open acm
		set_reg(hisifd->dss_base + DSS_DPP_RD_SHADOW_OFFSET, 0x0, 1, 0);

		/*close gmp*/
		g_color_enhancement_mode = COLOR_EN_DEFAULT;
		set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
	}
	else if (flag == COLOR_EN_SRGB)
	{
		hisifd->panel_info.acm_lut_hue_table = srgb_acm_lut_hue_table;
		hisifd->panel_info.acm_lut_hue_table_len = ARRAY_SIZE(srgb_acm_lut_hue_table);
		hisifd->panel_info.acm_lut_sata_table = srgb_acm_lut_sata_table;
		hisifd->panel_info.acm_lut_sata_table_len = ARRAY_SIZE(srgb_acm_lut_sata_table);
		hisifd->panel_info.acm_lut_satr_table = srgb_acm_lut_satr_table;
		hisifd->panel_info.acm_lut_satr_table_len = ARRAY_SIZE(srgb_acm_lut_satr_table);


		set_reg(hisifd->dss_base + DSS_DPP_RD_SHADOW_OFFSET, 0x1, 1, 0);

		/*close acm*/
		set_reg(acm_base + ACM_EN, 0x0, 1, 0); //open acm

		mdelay(20);
		if (srgb_acm_lut_hue_table != NULL && ARRAY_SIZE(srgb_acm_lut_hue_table) > 0) {
			acm_set_lut_hue(dpp_base + ACM_LUT_HUE, srgb_acm_lut_hue_table, ARRAY_SIZE(srgb_acm_lut_hue_table));
		} else {
			HISI_FB_ERR("fb%d, acm_lut_hue_table is NULL or acm_lut_hue_table_len less than 0!\n", hisifd->index);
			return 1;
		}

		if (srgb_acm_lut_sata_table != NULL && ARRAY_SIZE(srgb_acm_lut_sata_table) > 0) {
			acm_set_lut(dpp_base + ACM_LUT_SATA, srgb_acm_lut_sata_table, ARRAY_SIZE(srgb_acm_lut_sata_table));
		} else {
			HISI_FB_ERR("fb%d, acm_lut_sata_table is NULL or acm_lut_sata_table_len less than 0!\n", hisifd->index);
			return 1;
		}

		if (srgb_acm_lut_satr_table != NULL && ARRAY_SIZE(srgb_acm_lut_satr_table) > 0) {
			acm_set_lut(dpp_base + ACM_LUT_SATR, srgb_acm_lut_satr_table, ARRAY_SIZE(srgb_acm_lut_satr_table));
		} else {
			HISI_FB_ERR("fb%d, acm_lut_satr_table is NULL or acm_lut_satr_table_len less than 0!\n", hisifd->index);
			return 1;
		}

		/*open acm*/
		set_reg(acm_base + ACM_EN, 0x1, 1, 0); //open acm
		set_reg(hisifd->dss_base + DSS_DPP_RD_SHADOW_OFFSET, 0x0, 1, 0);

		/*open gmp*/
		g_color_enhancement_mode = COLOR_EN_SRGB;
		set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x0, 1, 0);	//enable gmp
	}
	else if (flag == COLOR_EN_CLOSED)
	{
		/*close acm*/
		set_reg(acm_base + ACM_EN, 0x0, 1, 0); //close acm

		/*close gmp*/
		g_color_enhancement_mode = COLOR_EN_CLOSED;
		set_reg(dpp_base + LCP_GMP_BYPASS_EN, 0x1, 1, 0);	//disable gmp
	}
	else
	{
		HISI_FB_INFO(" no this color_enhancement mode!\n");
		return 1;
	};

	HISI_FB_INFO(" set_color_enhance_mode, mode=%d -!\n",flag);
	return 0;
}

#define LCD_CMD_NAME_MAX 100
static char lcd_cmd_now[LCD_CMD_NAME_MAX] = {0};
static ssize_t mipi_samsung_S6E3HA3X02_panel_test_config_show(struct platform_device *pdev,
	char *buf)
{
	HISI_FB_INFO("%s\n", lcd_cmd_now);
	if (!strncmp(lcd_cmd_now, "LCD_INCOME0", strlen("LCD_INCOME0")) || /* incoming sence0 config */
		!strncmp(lcd_cmd_now, "MMI0", strlen("MMI0")) || /* mmi sence0 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST0", strlen("RUNNINGTEST0")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU0", strlen("PROJECT_MENU0"))) {
		return snprintf(buf, PAGE_SIZE, "CURRENT1_0");
	} else if (!strncmp(lcd_cmd_now, "LCD_INCOME1", strlen("LCD_INCOME1")) || /* incoming sence1 config */
		!strncmp(lcd_cmd_now, "MMI1", strlen("MMI1")) || /* mmi sence1 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST1", strlen("RUNNINGTEST1")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU1", strlen("PROJECT_MENU1"))) {
		return snprintf(buf, PAGE_SIZE, "CURRENT1_1");
	} else if (!strncmp(lcd_cmd_now, "LCD_INCOME2", strlen("LCD_INCOME2")) || /* incoming sence2 config */
		!strncmp(lcd_cmd_now, "MMI2", strlen("MMI2")) || /* mmi sence2 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST2", strlen("RUNNINGTEST2")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU2", strlen("PROJECT_MENU2"))) {
		return snprintf(buf, PAGE_SIZE, "CURRENT1_2");
	} else if (!strncmp(lcd_cmd_now, "LCD_INCOME3", strlen("LCD_INCOME3")) || /* incoming sence3 config */
		!strncmp(lcd_cmd_now, "MMI3", strlen("MMI3")) || /* mmi sence3 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST3", strlen("RUNNINGTEST3")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU3", strlen("PROJECT_MENU3"))) {
		return snprintf(buf, PAGE_SIZE, "CURRENT1_3");
	} else if (!strncmp(lcd_cmd_now, "LCD_INCOME4", strlen("LCD_INCOME4")) || /* incoming sence4 config */
		!strncmp(lcd_cmd_now, "MMI4", strlen("MMI4")) || /* mmi sence4 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST4", strlen("RUNNINGTEST4")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU4", strlen("PROJECT_MENU4"))) {
		return snprintf(buf, PAGE_SIZE, "CURRENT1_4");
	} else if (!strncmp(lcd_cmd_now, "LCD_INCOME5", strlen("LCD_INCOME5")) || /* incoming sence5 config */
		!strncmp(lcd_cmd_now, "MMI5", strlen("MMI5")) || /* mmi sence5 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST5", strlen("RUNNINGTEST5")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU5", strlen("PROJECT_MENU5"))) {
		return snprintf(buf, PAGE_SIZE, "CURRENT1_5");
	}else if (!strncmp(lcd_cmd_now, "LCD_INCOME6", strlen("LCD_INCOME6")) || /* incoming sence6 config */
		!strncmp(lcd_cmd_now, "MMI6", strlen("MMI6")) || /* mmi sence6 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST6", strlen("RUNNINGTEST6")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU6", strlen("PROJECT_MENU6"))) {
		return snprintf(buf, PAGE_SIZE, "PCD");
	}else if (!strncmp(lcd_cmd_now, "LCD_INCOME7", strlen("LCD_INCOME7")) || /* incoming sence7 config */
		!strncmp(lcd_cmd_now, "MMI7", strlen("MMI7")) || /* mmi sence7 config */
		!strncmp(lcd_cmd_now, "RUNNINGTEST7", strlen("RUNNINGTEST7")) ||
		!strncmp(lcd_cmd_now, "PROJECT_MENU7", strlen("PROJECT_MENU7"))) {
		return snprintf(buf, PAGE_SIZE, "ERRORFLAG");
	}else if (!strncmp(lcd_cmd_now, "CURRENT1_0", strlen("CURRENT1_0"))) { /* current1 @ Color.smile */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_0/ina231_set,"
										"/sys/class/ina231/ina231_0/ina231_value,"
										"7460000,8250000,0,528000,0,64000");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	}else if (!strncmp(lcd_cmd_now, "CURRENT2_0", strlen("CURRENT2_0"))) { /* current1 @ Color.smile */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_1/ina231_set,"
										"/sys/class/ina231/ina231_1/ina231_value,"
										"0,9999999,0,9999999,-15000,999999");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	}else if (!strncmp(lcd_cmd_now, "CURRENT1_1", strlen("CURRENT1_1"))) { /* current1 @ Color.WHITE */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_0/ina231_set,"
										"/sys/class/ina231/ina231_0/ina231_value,"
										"7460000,8250000,0,528000,0,64000");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	}else if (!strncmp(lcd_cmd_now, "CURRENT2_1", strlen("CURRENT2_1"))) { /* current1 @ Color.WHITE */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_1/ina231_set,"
										"/sys/class/ina231/ina231_1/ina231_value,"
										"0,9999999,0,9999999,-15000,999999");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	} else if (!strncmp(lcd_cmd_now, "CURRENT1_2", strlen("CURRENT1_2"))) { /* current1 @ Color.BLACK */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_0/ina231_set,"
										"/sys/class/ina231/ina231_0/ina231_value,"
										"7460000,8250000,0,528000,0,64000");
	}else if (!strncmp(lcd_cmd_now, "CURRENT2_2", strlen("CURRENT2_2"))) { /* current1 @ Color.BLACK */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_1/ina231_set,"
										"/sys/class/ina231/ina231_1/ina231_value,"
										"0,9999999,0,9999999,-15000,999999");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	} else if (!strncmp(lcd_cmd_now, "CURRENT1_3", strlen("CURRENT1_3"))) { /* current1 @ Color.RED */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_0/ina231_set,"
										"/sys/class/ina231/ina231_0/ina231_value,"
										"7460000,8250000,0,528000,0,64000");
	}else if (!strncmp(lcd_cmd_now, "CURRENT2_3", strlen("CURRENT2_3"))) { /* current1 @ Color.RED */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_1/ina231_set,"
										"/sys/class/ina231/ina231_1/ina231_value,"
										"0,9999999,0,9999999,-15000,999999");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	} else if (!strncmp(lcd_cmd_now, "CURRENT1_4", strlen("CURRENT1_4"))) { /* current1 @ Color.GREEN */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_0/ina231_set,"
										"/sys/class/ina231/ina231_0/ina231_value,"
										"7460000,8250000,0,528000,0,64000");
	}else if (!strncmp(lcd_cmd_now, "CURRENT2_4", strlen("CURRENT2_4"))) { /* current1 @ Color.GREEN */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_1/ina231_set,"
										"/sys/class/ina231/ina231_1/ina231_value,"
										"0,9999999,0,9999999,-15000,999999");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	} else if (!strncmp(lcd_cmd_now, "CURRENT1_5", strlen("CURRENT1_5"))) { /* current1 @ Color.BLUE */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_0/ina231_set,"
										"/sys/class/ina231/ina231_0/ina231_value,"
										"7460000,8250000,0,528000,0,64000");
	}else if (!strncmp(lcd_cmd_now, "CURRENT2_5", strlen("CURRENT2_5"))) { /* current1 @ Color.BLUE */
		return snprintf(buf, PAGE_SIZE, "/sys/class/ina231/ina231_1/ina231_set,"
										"/sys/class/ina231/ina231_1/ina231_value,"
										"0,9999999,0,9999999,-15000,999999");/* vol_min,vol_max,power_min,power_max,curr_min,curr_max */
	} else if (!strncmp(lcd_cmd_now, "PCD", strlen("PCD"))) { /* PCD */
		return snprintf(buf, PAGE_SIZE, "/sys/class/graphics/fb0/amoled_pcd_errflag_check");
	} else if (!strncmp(lcd_cmd_now, "ERRORFLAG", strlen("ERRORFLAG"))) { /* ERRORFLAG */
		return snprintf(buf, PAGE_SIZE, "/sys/class/graphics/fb0/amoled_pcd_errflag_check");
	}else {
		return snprintf(buf, PAGE_SIZE, "INVALID");
	}
}

static ssize_t mipi_samsung_S6E3HA3X02_panel_test_config_store(struct platform_device *pdev,
	const char *buf, size_t count)
{
	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		memcpy(lcd_cmd_now, "INVALID", strlen("INVALID") + 1);
		HISI_FB_INFO("invalid test cmd:%s\n", lcd_cmd_now);
		return count;
	}

	if (strlen(buf) < LCD_CMD_NAME_MAX) {
		memcpy(lcd_cmd_now, buf, strlen(buf) + 1);
		HISI_FB_INFO("current test cmd:%s\n", lcd_cmd_now);
	} else {
		memcpy(lcd_cmd_now, "INVALID", strlen("INVALID") + 1);
		HISI_FB_INFO("invalid test cmd:%s\n", lcd_cmd_now);
	}

	return count;
}

#define SBL_LSENSOR_VALUE_TOP_LIMIT      8000
#define SBL_LSENSOR_VALUE_DOWN_LIMIT   4000
static int mipi_samsung_S6E3HA3X02_panel_sbl_acl_ctrl(struct platform_device *pdev, int enable)
{
	int ret = 0;
	struct hisi_fb_data_type *hisifd = NULL;
	int sbl_lsensor_value = 0;
	char __iomem *mipi_dsi0_base = NULL;
	char payload_acl_switch[2] = {0};
	struct dsi_cmd_desc acl_switch_cmd[] = {
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_enable), test_key_enable},
		{DTYPE_DCS_WRITE1, 0, 200, WAIT_TYPE_US,
			sizeof(payload_acl_switch), payload_acl_switch},
		{DTYPE_GEN_LWRITE, 0, 200, WAIT_TYPE_US,
			sizeof(test_key_disable), test_key_disable},
	};

	if (NULL == pdev) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	hisifd = platform_get_drvdata(pdev);
	if (NULL == hisifd) {
		HISI_FB_ERR("NULL Pointer!\n");
		return 0;
	}

	HISI_FB_INFO("fb%d, +!\n", hisifd->index);

	HISI_FB_DEBUG("sbl sbl_lsensor_value = %d \n", hisifd->sbl_lsensor_value );
	HISI_FB_DEBUG("sbl sbl_level = %d \n", hisifd->sbl_level );
	HISI_FB_DEBUG("sbl sbl_enable = 0x%x \n", hisifd->sbl_enable );

	mipi_dsi0_base = hisifd->mipi_dsi0_base;
	sbl_lsensor_value = hisifd->sbl_lsensor_value;

	if (sbl_lsensor_value > SBL_LSENSOR_VALUE_TOP_LIMIT && g_acl_ctrl > ACL_OFF) {
		payload_acl_switch[0] = 0x55;
		payload_acl_switch[1] = ACL_OFF;
		mipi_dsi_cmds_tx(acl_switch_cmd, ARRAY_SIZE(acl_switch_cmd), mipi_dsi0_base);
		g_acl_ctrl = ACL_OFF;
		HISI_FB_INFO("ACL OFF\n");
	} else if (sbl_lsensor_value < SBL_LSENSOR_VALUE_DOWN_LIMIT && g_acl_ctrl == ACL_OFF) {
		payload_acl_switch[0] = 0x55;
		payload_acl_switch[1] = ACL_OFFSET2_ON;
		mipi_dsi_cmds_tx(acl_switch_cmd, ARRAY_SIZE(acl_switch_cmd), mipi_dsi0_base);
		g_acl_ctrl = ACL_OFFSET2_ON;
		HISI_FB_INFO("ACL OFFSET 2 ON\n");
	}

	HISI_FB_INFO("fb%d, -!\n", hisifd->index);

	return ret;
}

static struct hisi_panel_info g_panel_info = {0};
static struct hisi_fb_panel_data g_panel_data = {
	.panel_info = &g_panel_info,
	.set_fastboot = mipi_samsung_S6E3HA3X02_panel_set_fastboot,
	.on = mipi_samsung_S6E3HA3X02_panel_on,
	.off = mipi_samsung_S6E3HA3X02_panel_off,
	.remove = mipi_samsung_S6E3HA3X02_panel_remove,
	.set_backlight = mipi_samsung_S6E3HA3X02_panel_set_backlight,
	.lcd_model_show = mipi_samsung_S6E3HA3X02_panel_model_show,
	.panel_info_show = mipi_samsung_panel_info_show,
	.lcd_hbm_ctrl_show = mipi_samsung_S6E3HA3X02_panel_hbm_ctrl_show,
	.lcd_hbm_ctrl_store = mipi_samsung_S6E3HA3X02_panel_hbm_ctrl_store,
	.lcd_acl_ctrl_show = mipi_samsung_S6E3HA3X02_panel_acl_ctrl_show,
	.lcd_acl_ctrl_store = mipi_samsung_S6E3HA3X02_panel_acl_ctrl_store,
	.esd_handle = mipi_samsung_S6E3HA3X02_panel_check_esd,
	.amoled_pcd_errflag_check = mipi_samsung_pcd_errflag_check,
	.lcd_test_config_show = mipi_samsung_S6E3HA3X02_panel_test_config_show,
	.lcd_test_config_store = mipi_samsung_S6E3HA3X02_panel_test_config_store,
	.set_display_region = mipi_samsung_panel_set_display_region,
	.lcd_support_mode_show = mipi_samsung_panel_support_mode_show,
	.lcd_support_mode_store = mipi_samsung_panel_support_mode_store,
	.lcd_ic_color_enhancement_mode_store = mipi_samsung_panel_lcd_ic_color_enhancement_mode_store,
	.lcd_ic_color_enhancement_mode_show = mipi_samsung_panel_lcd_ic_color_enhancement_mode_show,
	.sbl_ctrl = mipi_samsung_S6E3HA3X02_panel_sbl_acl_ctrl,
};

/*******************************************************************************
**
*/
static int mipi_samsung_S6E3HA3X02_probe(struct platform_device *pdev)
{
	int ret = 0;
	struct hisi_panel_info *pinfo = NULL;
	struct device_node *np = NULL;
	uint32_t bl_type = 0;
	uint32_t lcd_display_type = 0;
	int support_mode = 0;

#ifdef CONFIG_HUAWEI_TS
	g_lcd_control_tp_power = true;	//not use fb_notify to control touch timing.
#endif

	np = of_find_compatible_node(NULL, NULL, DTS_COMP_SAMSUNG_S6E3HA3X02);
	if (!np) {
		HISI_FB_ERR("NOT FOUND device node %s!\n", DTS_COMP_SAMSUNG_S6E3HA3X02);
		goto err_return;
	}

	ret = of_property_read_u32(np, LCD_DISPLAY_TYPE_NAME, &lcd_display_type);
	if (ret) {
		HISI_FB_ERR("get lcd_display_type failed!\n");
		lcd_display_type = PANEL_DUAL_MIPI_CMD;
	}

	lcd_display_type = PANEL_DUAL_MIPI_CMD;

	ret = of_property_read_u32(np, LCD_BL_TYPE_NAME, &bl_type);
	if (ret) {
		HISI_FB_ERR("get lcd_bl_type failed!\n");
		bl_type = BL_SET_BY_MIPI;
	}
	HISI_FB_INFO("bl_type=0x%x.", bl_type);

	if (hisi_fb_device_probe_defer(lcd_display_type, bl_type)) {
		goto err_probe_defer;
	}

	HISI_FB_INFO("%s\n", DTS_COMP_SAMSUNG_S6E3HA3X02);

	gpio_lcd_1v8_en = of_get_named_gpio(np, "gpios", 0);  /*gpio_012*/
	gpio_lcd_reset = of_get_named_gpio(np, "gpios", 1);  /*gpio_020*/
	gpio_lcd_id0 = of_get_named_gpio(np, "gpios", 2);  /*gpio_010*/
	gpio_lcd_pcd = of_get_named_gpio(np, "gpios", 3);  /*gpio_082*/
	gpio_lcd_err_flag = of_get_named_gpio(np, "gpios", 4);  /*gpio_052*/
	HISI_FB_INFO("gpio_lcd_1v8_en = %d, gpio_lcd_reset = %d, gpio_lcd_id0 = %d, gpio_lcd_pcd = %d, gpio_lcd_err_flag = %d\n", \
		gpio_lcd_1v8_en, gpio_lcd_reset, gpio_lcd_id0, gpio_lcd_pcd, gpio_lcd_err_flag);


	pdev->id = 1;
	/* init panel info */
	pinfo = g_panel_data.panel_info;
	memset(pinfo, 0, sizeof(struct hisi_panel_info));
	pinfo->xres = 1440;
	pinfo->yres = 2560;
	pinfo->width = 82;
	pinfo->height = 146;
	pinfo->orientation = LCD_PORTRAIT;
	pinfo->bpp = LCD_RGB888;
	pinfo->bgr_fmt = LCD_RGB;
	pinfo->bl_set_type = bl_type;

	pinfo->default_gmp_off = 1;

	pinfo->bl_min = 4;
	pinfo->bl_max = 255;
	pinfo->vsync_ctrl_type = VSYNC_CTRL_ISR_OFF | VSYNC_CTRL_MIPI_ULPS | VSYNC_CTRL_CLK_OFF;

	pinfo->type = lcd_display_type;

	pinfo->bl_default = 102;

	pinfo->frc_enable = 0;
	pinfo->esd_enable = 1;
	pinfo->esd_skip_mipi_check = 1;
	pinfo->lcd_uninit_step_support = 1;

	pinfo->dirty_region_updt_support = 1;
	pinfo->dirty_region_info.left_align = -1;
	pinfo->dirty_region_info.right_align = -1;
	pinfo->dirty_region_info.top_align = -1;
	pinfo->dirty_region_info.bottom_align = -1;
	pinfo->dirty_region_info.w_align = -1;
	pinfo->dirty_region_info.h_align = -1;
	pinfo->dirty_region_info.w_min = 1440;
	pinfo->dirty_region_info.h_min = 11;
	pinfo->dirty_region_info.top_start = -1;
	pinfo->dirty_region_info.bottom_start = -1;

	/* The host processor must wait for more than 15us from the end of write data transfer to a command 2Ah/2Bh */
	if (pinfo->dirty_region_updt_support == 1)
		pinfo->mipi.hs_wr_to_time = 17000;        /* measured in nS */

	/* prefix ce & sharpness */
	pinfo->prefix_ce_support = 0;
	pinfo->prefix_sharpness1D_support = 0;
	pinfo->prefix_sharpness2D_support = 0;


	pinfo->color_temperature_support = 1;
	pinfo->comform_mode_support = 1;

	/* sbl */
	pinfo->sbl_support = 1;
	pinfo->smart_bl.strength_limit = 128;
	pinfo->smart_bl.calibration_a = 60;
	pinfo->smart_bl.calibration_b = 95;
	pinfo->smart_bl.calibration_c = 5;
	pinfo->smart_bl.calibration_d = 1;
	pinfo->smart_bl.t_filter_control = 5;
	pinfo->smart_bl.backlight_min = 480;
	pinfo->smart_bl.backlight_max = 4096;
	pinfo->smart_bl.backlight_scale = 0xff;
	pinfo->smart_bl.ambient_light_min = 14;
	pinfo->smart_bl.filter_a = 1738;
	pinfo->smart_bl.filter_b = 6;
	pinfo->smart_bl.logo_left = 0;
	pinfo->smart_bl.logo_top = 0;
	pinfo->smart_bl.variance_intensity_space = 145;
	pinfo->smart_bl.slope_max = 54;
	pinfo->smart_bl.slope_min = 160;

	/* ACM */
	pinfo->acm_support = 1;
	if (pinfo->acm_support == 1) {
		/*default ce*/
		pinfo->acm_lut_hue_table = ce_acm_lut_hue_table;
		pinfo->acm_lut_hue_table_len = ARRAY_SIZE(ce_acm_lut_hue_table);
		pinfo->acm_lut_sata_table = ce_acm_lut_sata_table;
		pinfo->acm_lut_sata_table_len = ARRAY_SIZE(ce_acm_lut_sata_table);
		pinfo->acm_lut_satr_table = ce_acm_lut_satr_table;
		pinfo->acm_lut_satr_table_len = ARRAY_SIZE(ce_acm_lut_satr_table);
		pinfo->acm_valid_num = 7;
		pinfo->r0_hh = 0x7f;
		pinfo->r0_lh = 0x3c0;
		pinfo->r1_hh = 0xff;
		pinfo->r1_lh = 0x80;
		pinfo->r2_hh = 0x17f;
		pinfo->r2_lh = 0x100;
		pinfo->r3_hh = 0x1ff;
		pinfo->r3_lh = 0x180;
		pinfo->r4_hh = 0x27f;
		pinfo->r4_lh = 0x200;
		pinfo->r5_hh = 0x2ff;
		pinfo->r5_lh = 0x280;
		pinfo->r6_hh = 0x37f;
		pinfo->r6_lh = 0x300;

		/*for cinema mode */
		pinfo->cinema_acm_valid_num = 7;
		pinfo->cinema_r0_hh = 0x7f;
		pinfo->cinema_r0_lh = 0x0;
		pinfo->cinema_r1_hh = 0xff;
		pinfo->cinema_r1_lh = 0x80;
		pinfo->cinema_r2_hh = 0x17f;
		pinfo->cinema_r2_lh = 0x100;
		pinfo->cinema_r3_hh = 0x1ff;
		pinfo->cinema_r3_lh = 0x180;
		pinfo->cinema_r4_hh = 0x27f;
		pinfo->cinema_r4_lh = 0x200;
		pinfo->cinema_r5_hh = 0x2ff;
		pinfo->cinema_r5_lh = 0x280;
		pinfo->cinema_r6_hh = 0x37f;
		pinfo->cinema_r6_lh = 0x300;

		/* ACM_CE */
		pinfo->acm_ce_support = 1;
	}

	/* Contrast Algorithm */
	if (pinfo->prefix_ce_support == 1 || pinfo->acm_ce_support == 1) {
		pinfo->ce_alg_param.iDiffMaxTH = 900;
		pinfo->ce_alg_param.iDiffMinTH = 100;
		pinfo->ce_alg_param.iFlatDiffTH = 500;
		pinfo->ce_alg_param.iAlphaMinTH = 16;
		pinfo->ce_alg_param.iBinDiffMaxTH = 40000;

		pinfo->ce_alg_param.iDarkPixelMinTH = 16;
		pinfo->ce_alg_param.iDarkPixelMaxTH = 24;
		pinfo->ce_alg_param.iDarkAvePixelMinTH = 40;
		pinfo->ce_alg_param.iDarkAvePixelMaxTH = 80;
		pinfo->ce_alg_param.iWhitePixelTH = 236;
		pinfo->ce_alg_param.fweight = 42;
		pinfo->ce_alg_param.fDarkRatio = 51;
		pinfo->ce_alg_param.fWhiteRatio = 51;

		pinfo->ce_alg_param.iDarkPixelTH = 64;
		pinfo->ce_alg_param.fDarkSlopeMinTH = 149;
		pinfo->ce_alg_param.fDarkSlopeMaxTH = 161;
		pinfo->ce_alg_param.fDarkRatioMinTH = 18;
		pinfo->ce_alg_param.fDarkRatioMaxTH = 38;

		pinfo->ce_alg_param.iBrightPixelTH = 192;
		pinfo->ce_alg_param.fBrightSlopeMinTH = 149;
		pinfo->ce_alg_param.fBrightSlopeMaxTH = 174;
		pinfo->ce_alg_param.fBrightRatioMinTH = 20;
		pinfo->ce_alg_param.fBrightRatioMaxTH = 36;

		pinfo->ce_alg_param.iZeroPos0MaxTH = 120;
		pinfo->ce_alg_param.iZeroPos1MaxTH = 128;

		pinfo->ce_alg_param.iDarkFMaxTH = 16;
		pinfo->ce_alg_param.iDarkFMinTH = 12;
		pinfo->ce_alg_param.iPos0MaxTH = 120;
		pinfo->ce_alg_param.iPos0MinTH = 96;

		pinfo->ce_alg_param.fKeepRatio = 61;
	}

	/* Gama LCP */
	pinfo->gamma_support = 1;
	if (pinfo->gamma_support == 1) {
		/*only one gmp param group*/
		pinfo->gamma_lut_table_R = gamma_lut_table_R;
		pinfo->gamma_lut_table_G = gamma_lut_table_G;
		pinfo->gamma_lut_table_B = gamma_lut_table_B;
		pinfo->gamma_lut_table_len = ARRAY_SIZE(gamma_lut_table_R);
		pinfo->igm_lut_table_R = igm_lut_table_R;
		pinfo->igm_lut_table_G = igm_lut_table_G;
		pinfo->igm_lut_table_B = igm_lut_table_B;
		pinfo->igm_lut_table_len = ARRAY_SIZE(igm_lut_table_R);

		pinfo->gmp_support = 1;
		pinfo->gmp_lut_table_low32bit = &lcp_gmp_lut_table_low32bit[0][0][0];
		pinfo->gmp_lut_table_high4bit = &lcp_gmp_lut_table_high4bit[0][0][0];
		pinfo->gmp_lut_table_len = ARRAY_SIZE(lcp_gmp_lut_table_low32bit);

		pinfo->xcc_support = 1;
		pinfo->xcc_table = xcc_table;
		pinfo->xcc_table_len = ARRAY_SIZE(xcc_table);
	}

	pinfo->ifbc_type = IFBC_TYPE_NONE;

	pinfo->ldi.h_back_porch = 96;
	pinfo->ldi.h_front_porch = 108;
	pinfo->ldi.h_pulse_width = 48;
	pinfo->ldi.v_back_porch = 12;
	pinfo->ldi.v_front_porch = 14;
	pinfo->ldi.v_pulse_width = 4;

	pinfo->mipi.lane_nums = DSI_4_LANES;
	pinfo->mipi.color_mode = DSI_24BITS_1;
	pinfo->mipi.vc = 0;
	pinfo->mipi.max_tx_esc_clk = 9 * 1000000;
	pinfo->mipi.burst_mode = 0;

	pinfo->mipi.dsi_bit_clk = 480;
	pinfo->mipi.dsi_bit_clk_val1 = 471;
	pinfo->mipi.dsi_bit_clk_val2 = 480;
	pinfo->mipi.dsi_bit_clk_val3 = 490;
	pinfo->mipi.dsi_bit_clk_val4 = 500;
	/* pinfo->mipi.dsi_bit_clk_val5 = ; */
	pinfo->dsi_bit_clk_upt_support = 1;
	pinfo->mipi.dsi_bit_clk_upt = pinfo->mipi.dsi_bit_clk;

	pinfo->pxl_clk_rate = 288*1000000UL;

	/* is dual_mipi or single_mipi */
	if (is_dual_mipi_panel_ext(pinfo))  {
		pinfo->ifbc_type = IFBC_TYPE_NONE;
		pinfo->pxl_clk_rate_div = 2;
		HISI_FB_INFO("PANEL_DUAL_MIPI_CMD: 8 lane \n");
	} else {

	}

	if (pinfo->pxl_clk_rate_div > 1) {
		pinfo->ldi.h_back_porch /= pinfo->pxl_clk_rate_div;
		pinfo->ldi.h_front_porch /= pinfo->pxl_clk_rate_div;
		pinfo->ldi.h_pulse_width /= pinfo->pxl_clk_rate_div;
	}

	if(pinfo->comform_mode_support == 1){
		support_mode = (support_mode | 1);
	}

	/*use  lcd_ic_color_enhancement_mode node, not use lcd_acm_state node*/
	support_mode = (support_mode | 4);
	g_support_mode =   support_mode;

	if(runmode_is_factory()) {
		HISI_FB_INFO("Factory mode, disable features: dirty update etc.\n");
		pinfo->dirty_region_updt_support = 0;
		pinfo->sbl_support = 0;
		pinfo->acm_support = 0;
		pinfo->acm_ce_support = 0;
		pinfo->esd_enable = 0;
		pinfo->blpwm_input_ena = 0;
		pinfo->blpwm_precision_type = BLPWM_PRECISION_DEFAULT_TYPE;
		pinfo->bl_min = 4;
		pinfo->bl_max = 255;
		pinfo->comform_mode_support = 0;
		/*in factory mode , use default*/
		g_support_mode = 0;
		g_acl_ctrl = 0;
	}


	/* lcd vcc init */
	ret = vcc_cmds_tx(pdev, lcd_vcc_init_cmds,
		ARRAY_SIZE(lcd_vcc_init_cmds));
	if (ret != 0) {
		HISI_FB_ERR("LCD vcc init failed!\n");
		goto err_return;
	}

	/* lcd pinctrl init */
	ret = pinctrl_cmds_tx(pdev, lcd_pinctrl_init_cmds,
		ARRAY_SIZE(lcd_pinctrl_init_cmds));
	if (ret != 0) {
		HISI_FB_ERR("Init pinctrl failed, defer\n");
		goto err_return;
	}

	/* lcd vcc enable */
	if (is_fastboot_display_enable()) {
		vcc_cmds_tx(pdev, lcd_vcc_enable_cmds,
			ARRAY_SIZE(lcd_vcc_enable_cmds));
	}

#ifdef AMOLED_CHECK_INT
	ret = request_threaded_irq(gpio_to_irq(gpio_lcd_pcd), NULL, pcd_irq_isr_func,
			IRQF_ONESHOT | IRQF_TRIGGER_RISING,
			"pcd_irq", (void *)pdev);
	if (ret != 0) {
		HISI_FB_ERR("request_irq failed, irq_no=%d error=%d!\n", gpio_to_irq(gpio_lcd_pcd), ret);
	}

	ret = request_threaded_irq(gpio_to_irq(gpio_lcd_err_flag), NULL, errflag_irq_isr_func,
			IRQF_ONESHOT | IRQF_TRIGGER_RISING,
			"errflag_irq", (void *)pdev);
	if (ret != 0) {
		HISI_FB_ERR("request_irq failed, irq_no=%d error=%d!\n", gpio_to_irq(gpio_lcd_err_flag), ret);
	}
#endif

	/* alloc panel device data */
	ret = platform_device_add_data(pdev, &g_panel_data,
		sizeof(struct hisi_fb_panel_data));
	if (ret) {
		HISI_FB_ERR("platform_device_add_data failed!\n");
		goto err_device_put;
	}

	hisi_fb_add_device(pdev);

	HISI_FB_DEBUG("-.\n");

	return 0;

err_device_put:
	platform_device_put(pdev);
err_return:
	return ret;
err_probe_defer:
	return -EPROBE_DEFER;

	return ret;
}

static const struct of_device_id hisi_panel_match_table[] = {
	{
		.compatible = DTS_COMP_SAMSUNG_S6E3HA3X02,
		.data = NULL,
	},
	{},
};
MODULE_DEVICE_TABLE(of, hisi_panel_match_table);

static struct platform_driver this_driver = {
	.probe = mipi_samsung_S6E3HA3X02_probe,
	.remove = NULL,
	.suspend = NULL,
	.resume = NULL,
	.shutdown = NULL,
	.driver = {
		.name = "mipi_samsung_S6E3HA3X02",
		.owner = THIS_MODULE,
		.of_match_table = of_match_ptr(hisi_panel_match_table),
	},
};

static int __init mipi_samsung_S6E3HA3X02_panel_init(void)
{
	int ret = 0;

	ret = platform_driver_register(&this_driver);
	if (ret) {
		HISI_FB_ERR("platform_driver_register failed, error=%d!\n", ret);
		return ret;
	}

	return ret;
}

module_init(mipi_samsung_S6E3HA3X02_panel_init);




